var _a;null===(_a=window.wafer)||void 0===_a||_a.ready((function(){var e,n,o=!1,t="geolocation",i="accepted",a="denied",r="unsupported",d="unknown",c="wafer-nflvideo",u="wafer-video",l="",s=!1,w="not-requested";function v(){var e=document.getElementById("videoVeJs");e&&(l=e.getAttribute("data-vejs-url"),h("VEModule").then((function(){o||m()})).catch((function(){})))}function f(t){if(n){var i={channelId:n.channelId,chyronContainerElem:document.getElementById(n.chyronContainerId)||null,commonParams:n.commonParams,debug:n.debug,enableNFLLocationChyron:n.enableNFLLocationChyron,location:t||null,testVideoGroup:n.testVideoGroup,vemsData:n.vemsData,videoExperiences:n.videoExperiences,videoplayer:window.videoPlayerInstance||null};n.geoConfig&&(e=n.geoConfig),window.veModuleInstance=new window.VEModule(i),o=!0,window.veModuleInstance.on(window.VEModule.events.onAlertAction,I.bind(this)),window.VEModule.events.onWaitForLocationResolved&&window.VEModule.events.onWaitForLocationRejected&&(window.veModuleInstance.on(window.VEModule.events.onWaitForLocationResolved,y.bind(this)),window.veModuleInstance.on(window.VEModule.events.onWaitForLocationRejected,E.bind(this)));var a=!0;n.locationRequestServer&&(a=!1),n.locationRequestVideo&&!t&&(a=!1),n.requireInstantApp&&(a=!1),a&&g(t,"")}}function g(e,n){var o=document.getElementById(c);if(o&&(e||n)){var t=o.getAttribute("data-wf-video-config");if(t)try{var i=JSON.parse(t);i&&(e&&(i.allowGeoRequest=!0,i.geoData={accuracy:e.accuracy,latitude:e.lat||e.latitude,longitude:e.long||e.longitude}),n&&(i.playlist={mediaItems:n}),o.setAttribute("data-wf-video-config",JSON.stringify(i)))}catch(e){}}o&&o.parentNode&&(o.classList.add(u),window.wafer.base.sync(o.parentNode))}function m(){if(!s)try{var e=document.getElementById("videoVeJs"),a=e&&JSON.parse(e.innerText);a&&!o&&((n=a).locationRequestVideo=n.locationRequired,n.locationRequestServer=a.videoExperiences&&a.videoExperiences.state&&a.videoExperiences.state.requestLocation||!1,n.requireInstantApp?f(""):n.locationRequestServer||n.isNFLliveGame&&n.locationRequestVideo&&V(t,"")===i?p():f(""),s=!0)}catch(e){var r="NFL videoVeJs script contents are not valid JSON. Error: "+e.message;window.wafer.utils.fireBeacon("/p.gif?err="+escape(r))}}function I(e){e.actionName===window.VEModule.Alert.ACTION_NAMES.RequestLocation&&e.actionTrigger===window.VEModule.Alert.ACTION_TRIGGERS.TAP&&p()}function y(e){e&&e.location&&g(e.location,e.mediaItems)}function E(e){var n="NFL videoVeJs alert _onWaitForLocationRejected "+JSON.stringify(e||{});window.wafer.utils.fireBeacon("/p.gif?err="+escape(n))}function p(){var n;navigator.geolocation&&navigator.geolocation.getCurrentPosition||(window.veModuleInstance&&window.veModuleInstance.setLocation(!1),V(t,r)),n=e||{enableHighAccuracy:!0,maximumAge:1e4,timeout:15e3},navigator.geolocation.getCurrentPosition(M,(function(e){e&&e.code&&((e&&1===e.code?a:i)===a&&V(t,a));window.veModuleInstance?window.veModuleInstance.setLocation(!1,e):f("")}),n)}function M(e){if(e&&e.coords){var o=e.coords,a={accuracy:String(o.accuracy),lat:String(o.latitude),long:String(o.longitude)};V(t,i),window.veModuleInstance?(window.veModuleInstance.setLocation(a),n.locationRequestServer||g(a,"")):f(a)}}function V(e,n){if(window&&window.localStorage){if(!n)return window.localStorage.getItem(e)||d;try{window.localStorage&&window.localStorage.setItem(e,n)}catch(e){return d}}}function h(e,n){return void 0===n&&(n=1),new Promise((function(o,t){if(window[e])return w="loaded",o(!0);if("not-requested"===w)new Promise((function(e,n){return"loaded"===w||window.VEModule?e(!0):l?(w="requesting",void window.wafer.utils.loadScriptAsync({src:l,text:""},(function(o){return o?n(new Error("error getting VE Module JS")):(w="loaded",e(!0))}))):n(new Error("URL error"))})).then((function(){return o(!0)})).catch((function(e){return t(e)}));else if(n>=20)return t(new Error("namespace not found"));setTimeout((function(){h(e,++n).then((function(){o(!0)})).catch((function(){t(new Error("namespace not found"))}))}),100*n)}))}window.wafer.on("video:rendered",(function(e){if(e.elem.id===c){window.videoPlayerInstance||(window.videoPlayerInstance=e.meta.instance);var n=document.getElementById("videoVeJs");h("VEModule").then((function(){n&&!o?m():window.veModuleInstance&&window.veModuleInstance.setPlayer(window.videoPlayerInstance)}))}})),window.wafer.on("fetch:success",(function(e){e.meta&&e.meta.url&&e.meta.url.indexOf("NflVideo")>-1&&(document.getElementById("videoVeJs")&&(e.meta.data&&"string"==typeof e.meta.data.html&&e.meta.data.html.indexOf("wafer-nflvideo")>-1&&(s=!1,o=!1),v()))})),v()}));
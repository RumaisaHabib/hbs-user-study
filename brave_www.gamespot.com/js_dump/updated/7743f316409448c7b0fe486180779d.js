(()=>{let e;var t,n,i,o,s,r,a,c,l,u,d,h,p,f,g,v,m,y,w,b,C,S,I,E,_,O,k,T,R,A,L,P,D,V,x,N,j,M,U,G,F,W,H,B,$,q,Q,Y,z,K,J,X,Z,ee,et,en,ei,eo,es,er,ea,ec,el,eu,ed,eh,ep,ef,eg,ev,em,ey,ew,eb,eC,eS,eI,eE,e_,eO,ek,eT,eR,eA,eL,eP,eD,eV,ex,eN,ej,eM,eU,eG,eF,eW,eH,eB,e$,eq,eQ,eY,ez,eK,eJ,eX,eZ,e0,e1,e2,e6,e3,e4,e5,e8,e9,e7,te,tt,tn,ti="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function to(e,t,n,i){var o,s=arguments.length,r=s<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(s<3?o(r):s>3?o(t,n,r):o(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r}function ts(e,t){return function(n,i){t(n,i,e)}}function tr(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function ta(e,t,n,i){return new(n||(n=Promise))(function(o,s){function r(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){}function c(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n(function(e){})).then(r,a)}c((i=i.apply(e,t||[])).next())})}var tc={},tl=tc={};function tu(){}function td(){}function th(e){}!function(){try{t="function"==typeof setTimeout?setTimeout:tu}catch(e){t=tu}try{n="function"==typeof clearTimeout?clearTimeout:td}catch(e){n=td}}();var tp=[],tf=!1,tg=-1;function tv(){}function tm(){}function ty(e,t){}function tw(){}tl.nextTick=function(e){},ty.prototype.run=function(){},tl.title="browser",tl.browser=!0,tl.env={},tl.argv=[],tl.version="",tl.versions={},tl.on=tw,tl.addListener=tw,tl.once=tw,tl.off=tw,tl.removeListener=tw,tl.removeAllListeners=tw,tl.emit=tw,tl.prependListener=tw,tl.prependOnceListener=tw,tl.listeners=function(e){},tl.binding=function(e){},tl.cwd=function(){},tl.chdir=function(e){},tl.umask=function(){},function(e){!function(t){var n="object"==typeof ti?ti:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,i){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:i}),t&&t(n,i)}}void 0===n.Reflect?n.Reflect=e:i=o(n.Reflect,i),t(i)}(function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,i=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",o=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",s="function"==typeof Object.create,r=({__proto__:[]})instanceof Array,a=!s&&!r,c={create:s?function(){}:r?function(){}:function(){},has:a?function(e,n){}:function(e,t){},get:a?function(e,n){}:function(e,t){}},l=Object.getPrototypeOf(Function),u="object"==typeof tc&&tc.env&&!1,d=u||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){}():Map,h=u||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){}():Set,p=new(u||"function"!=typeof WeakMap?function(){}():WeakMap);function f(e,t,n){var i=p.get(e);if(b(i)){if(!n)return;i=new d,p.set(e,i)}var o=i.get(t);if(b(o)){if(!n)return;o=new d,i.set(t,o)}return o}function g(e,t,n){var i=f(t,n,!1);return!b(i)&&!!i.has(e)}function v(e,t,n){var i=f(t,n,!1);if(!b(i))return i.get(e)}function m(e,t,n,i){f(n,i,!0).set(e,t)}function y(e,t){}function w(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function b(e){return void 0===e}function C(e){return null===e}function S(e){return"object"==typeof e?null!==e:"function"==typeof e}function I(e){var t=function(e,t){switch(w(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",o=k(e,i);if(void 0!==o){var s=o.call(e,n);if(S(s))throw TypeError();return s}return function(e,t){}(e,"default"===n?"number":n)}(e,3);return"symbol"==typeof t?t:""+t}function E(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function _(e){}function O(e){return"function"==typeof e}function k(e,t){}function T(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l||t!==l)return t;var n=e.prototype,i=n&&Object.getPrototypeOf(n);if(null==i||i===Object.prototype)return t;var o=i.constructor;return"function"!=typeof o||o===e?t:o}function R(e){}e("decorate",function(e,t,n,i){if(b(n)){if(!E(e)||!O(t))throw TypeError();return function(e,t){for(var n=e.length-1;n>=0;--n){var i=(0,e[n])(t);if(!b(i)&&!C(i)){if(!O(i))throw TypeError();t=i}}return t}(e,t)}if(!E(e)||!S(t)||!S(i)&&!b(i)&&!C(i))throw TypeError();return C(i)&&(i=void 0),function(e,t,n,i){for(var o=e.length-1;o>=0;--o){var s=(0,e[o])(t,n,i);if(!b(s)&&!C(s)){if(!S(s))throw TypeError();i=s}}return i}(e,t,n=I(n),i)}),e("metadata",function(e,t){return function(n,i){if(!S(n)||!b(i)&&!function(e){switch(w(e)){case 3:case 4:return!0;default:return!1}}(i))throw TypeError();m(e,t,n,i)}}),e("defineMetadata",function(e,t,n,i){if(!S(n))throw TypeError();return b(i)||(i=I(i)),m(e,t,n,i)}),e("hasMetadata",function(e,t,n){}),e("hasOwnMetadata",function(e,t,n){if(!S(t))throw TypeError();return b(n)||(n=I(n)),g(e,t,n)}),e("getMetadata",function(e,t,n){if(!S(t))throw TypeError();return b(n)||(n=I(n)),function e(t,n,i){if(g(t,n,i))return v(t,n,i);var o=T(n);if(!C(o))return e(t,o,i)}(e,t,n)}),e("getOwnMetadata",function(e,t,n){if(!S(t))throw TypeError();return b(n)||(n=I(n)),v(e,t,n)}),e("getMetadataKeys",function(e,t){}),e("getOwnMetadataKeys",function(e,t){}),e("deleteMetadata",function(e,t,n){})})}(o||(o={})),function(e){e[e.Transient=0]="Transient",e[e.Singleton=1]="Singleton",e[e.ResolutionScoped=2]="ResolutionScoped",e[e.ContainerScoped=3]="ContainerScoped"}(s||(s={}));var tb=s,tC=function(e,t){return(tC=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){}||function(e,t){})(e,t)};function tS(e,t){function n(){this.constructor=e}tC(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function tI(e){}function tE(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,s=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r}function t_(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(tE(arguments[t]));return e}var tO="injectionTokens";function tk(e,t){return function(n,i,o){var s=Reflect.getOwnMetadata(tO,n)||{};s[o]=t?{token:e,transform:t.transformToken,transformArgs:t.args||[]}:e,Reflect.defineMetadata(tO,s,n)}}function tT(e){return!!e.useClass}function tR(e){return!!e.useFactory}var tA=function(){function e(e){}return e.prototype.createProxy=function(e){},e.prototype.createHandler=function(e){},e}();function tL(e){return"string"==typeof e||"symbol"==typeof e}function tP(e){return"object"==typeof e&&"token"in e&&"transform"in e}function tD(e){return!!e.useToken}function tV(e){return void 0!=e.useValue}var tx=function(){function e(){this._registryMap=new Map}return e.prototype.entries=function(){},e.prototype.getAll=function(e){},e.prototype.get=function(e){this.ensure(e);var t=this._registryMap.get(e);return t[t.length-1]||null},e.prototype.set=function(e,t){this.ensure(e),this._registryMap.get(e).push(t)},e.prototype.setAll=function(e,t){},e.prototype.has=function(e){return this.ensure(e),this._registryMap.get(e).length>0},e.prototype.clear=function(){},e.prototype.ensure=function(e){this._registryMap.has(e)||this._registryMap.set(e,[])},e}(),tN=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tS(t,e),t}(tx),tj=function(){this.scopedResolutions=new Map},tM=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tS(t,e),t}(tx),tU=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return tS(t,e),t}(tx),tG=function(){this.preResolution=new tM,this.postResolution=new tU},tF=new Map,tW=new(function(){function e(e){this.parent=e,this._registry=new tN,this.interceptors=new tG,this.disposed=!1,this.disposables=new Set}return e.prototype.register=function(e,t,n){if(void 0===n&&(n={lifecycle:tb.Transient}),this.ensureNotDisposed(),tD(i=tT(t)||tV(t)||tD(t)||tR(t)?t:{useClass:t}))for(var i,o=[e],s=i;null!=s;){var r=s.useToken;if(o.includes(r))throw Error("Token registration cycle detected! "+t_(o,[r]).join(" -> "));o.push(r);var a=this._registry.get(r);s=a&&tD(a.provider)?a.provider:null}if((n.lifecycle===tb.Singleton||n.lifecycle==tb.ContainerScoped||n.lifecycle==tb.ResolutionScoped)&&(tV(i)||tR(i)))throw Error('Cannot use lifecycle "'+tb[n.lifecycle]+'" with ValueProviders or FactoryProviders');return this._registry.set(e,{provider:i,options:n}),this},e.prototype.registerType=function(e,t){},e.prototype.registerInstance=function(e,t){},e.prototype.registerSingleton=function(e,t){if(this.ensureNotDisposed(),tL(e)){if(tL(t))return this.register(e,{useToken:t},{lifecycle:tb.Singleton});if(t)return this.register(e,{useClass:t},{lifecycle:tb.Singleton});throw Error('Cannot register a type name as a singleton without a "to" token')}var n=e;return t&&!tL(t)&&(n=t),this.register(e,{useClass:n},{lifecycle:tb.Singleton})},e.prototype.resolve=function(e,t){void 0===t&&(t=new tj),this.ensureNotDisposed();var n=this.getRegistration(e);if(!n&&tL(e))throw Error('Attempted to resolve unregistered dependency token: "'+e.toString()+'"');if(this.executePreResolutionInterceptor(e,"Single"),n){var i=this.resolveRegistration(n,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}if("function"==typeof e||e instanceof tA){var i=this.construct(e,t);return this.executePostResolutionInterceptor(e,i,"Single"),i}throw Error("Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.")},e.prototype.executePreResolutionInterceptor=function(e,t){var n,i;if(this.interceptors.preResolution.has(e)){var o=[];try{for(var s=tI(this.interceptors.preResolution.getAll(e)),r=s.next();!r.done;r=s.next()){var a=r.value;"Once"!=a.options.frequency&&o.push(a),a.callback(e,t)}}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=s.return)&&i.call(s)}finally{if(n)throw n.error}}this.interceptors.preResolution.setAll(e,o)}},e.prototype.executePostResolutionInterceptor=function(e,t,n){var i,o;if(this.interceptors.postResolution.has(e)){var s=[];try{for(var r=tI(this.interceptors.postResolution.getAll(e)),a=r.next();!a.done;a=r.next()){var c=a.value;"Once"!=c.options.frequency&&s.push(c),c.callback(e,t,n)}}catch(e){i={error:e}}finally{try{a&&!a.done&&(o=r.return)&&o.call(r)}finally{if(i)throw i.error}}this.interceptors.postResolution.setAll(e,s)}},e.prototype.resolveRegistration=function(e,t){if(this.ensureNotDisposed(),e.options.lifecycle===tb.ResolutionScoped&&t.scopedResolutions.has(e))return t.scopedResolutions.get(e);var n,i=e.options.lifecycle===tb.Singleton,o=e.options.lifecycle===tb.ContainerScoped,s=i||o;return n=tV(e.provider)?e.provider.useValue:tD(e.provider)?s?e.instance||(e.instance=this.resolve(e.provider.useToken,t)):this.resolve(e.provider.useToken,t):tT(e.provider)?s?e.instance||(e.instance=this.construct(e.provider.useClass,t)):this.construct(e.provider.useClass,t):tR(e.provider)?e.provider.useFactory(this):this.construct(e.provider,t),e.options.lifecycle===tb.ResolutionScoped&&t.scopedResolutions.set(e,n),n},e.prototype.resolveAll=function(e,t){},e.prototype.isRegistered=function(e,t){return void 0===t&&(t=!1),this.ensureNotDisposed(),this._registry.has(e)||t&&(this.parent||!1)&&this.parent.isRegistered(e,!0)},e.prototype.reset=function(){},e.prototype.clearInstances=function(){},e.prototype.createChildContainer=function(){},e.prototype.beforeResolution=function(e,t,n){},e.prototype.afterResolution=function(e,t,n){},e.prototype.dispose=function(){},e.prototype.getRegistration=function(e){return this.isRegistered(e)?this._registry.get(e):this.parent?this.parent.getRegistration(e):null},e.prototype.getAllRegistrations=function(e){},e.prototype.construct=function(e,t){var n=this;if(e instanceof tA)return e.createProxy(function(e){});var i=function(){var i=tF.get(e);if(!i||0===i.length){if(0===e.length)return new e;throw Error('TypeInfo not known for "'+e.name+'"')}var o=i.map(n.resolveParams(t,e));return new(e.bind.apply(e,t_([void 0],o)))}();return"function"!=typeof i.dispose||i.dispose.length>0||this.disposables.add(i),i},e.prototype.resolveParams=function(e,t){var n=this;return function(i,o){var s,r,a,c,l,u,d;try{if("object"==typeof i&&"token"in i&&"multiple"in i){if(tP(i))return i.multiple?(s=n.resolve(i.transform)).transform.apply(s,t_([n.resolveAll(i.token)],i.transformArgs)):(r=n.resolve(i.transform)).transform.apply(r,t_([n.resolve(i.token,e)],i.transformArgs));return i.multiple?n.resolveAll(i.token):n.resolve(i.token,e)}if(tP(i))return(a=n.resolve(i.transform,e)).transform.apply(a,t_([n.resolve(i.token,e)],i.transformArgs));return n.resolve(i,e)}catch(e){throw Error((l="Cannot inject the dependency "+(null===(c=void 0===(d=tE(t.toString().match(/constructor\(([\w, ]+)\)/)||[],2)[1])?null:d)?"at position #"+o:'"'+c.split(",")[o].trim()+'" at position #'+o)+' of "'+t.name+'" constructor. Reason:',void 0===u&&(u="    "),t_([l],e.message.split("\n").map(function(e){})).join("\n")))}}},e.prototype.ensureNotDisposed=function(){if(this.disposed)throw Error("This container has been disposed, you cannot interact with a disposed container")},e}()),tH=function(e){return tk(e)},tB=function(){return function(e){var t,n;tF.set(e,(t=Reflect.getMetadata("design:paramtypes",e)||[],Object.keys(n=Reflect.getOwnMetadata(tO,e)||{}).forEach(function(e){t[+e]=n[e]}),t))}},t$=function(){return function(e){tB()(e),tW.registerSingleton(e)}},tq=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return tk(e,{transformToken:t,args:n})};if("undefined"==typeof Reflect||!Reflect.getMetadata)throw Error("tsyringe requires a reflect polyfill. Please add 'import \"reflect-metadata\"' to the top of your entry point.");var tQ={};tQ=function(){"use strict";function e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)e[i]=n[i]}return e}return function t(n,i){function o(t,o,s){if("undefined"!=typeof document){"number"==typeof(s=e({},i,s)).expires&&(s.expires=new Date(Date.now()+864e5*s.expires)),s.expires&&(s.expires=s.expires.toUTCString()),t=encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var r="";for(var a in s)s[a]&&(r+="; "+a,!0!==s[a]&&(r+="="+s[a].split(";")[0]));return document.cookie=t+"="+n.write(o,t)+r}}return Object.create({set:o,get:function(e){if("undefined"!=typeof document&&(!arguments.length||e)){for(var t=document.cookie?document.cookie.split("; "):[],i={},o=0;o<t.length;o++){var s=t[o].split("="),r=s.slice(1).join("=");try{var a=decodeURIComponent(s[0]);if(i[a]=n.read(r,a),e===a)break}catch(e){}}return e?i[e]:i}},remove:function(t,n){},withAttributes:function(n){},withConverter:function(n){}},{attributes:{value:Object.freeze(i)},converter:{value:Object.freeze(n)}})}({read:function(e){return'"'===e[0]&&(e=e.slice(1,-1)),e.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(e){return encodeURIComponent(e).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"})}();let tY="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var tz={randomUUID:tY};let tK=new Uint8Array(16);function tJ(){}let tX=[];for(let e=0;e<256;++e)tX.push((e+256).toString(16).slice(1));let tZ=Symbol("COOKIES"),t0=Symbol("WINDOW"),t1=Symbol("UUID"),t2=class{constructor(e){this.window=e}get(){var e;return null===(e=this.window.ads)||void 0===e?void 0:e.context}};t2=to([tB(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(r="undefined"!=typeof Window&&Window)?r:Object])],t2);let t6=class{getBrowser(){let e;let{appName:t,appVersion:n,userAgent:i}=window.navigator,o=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(o[1])?`IE ${(e=/\brv[ :]+(\d+)/g.exec(i)||[""])[1]||""}`:"Chrome"===o[1]&&null!==(e=i.match(/\b(OPR|Edg)\/(\d+)/))?e.slice(1).join(" ").replace("OPR","Opera").replace("Edg","Edge"):(o=o[2]?[o[1],o[2]]:[t,n,"-?"],null!==(e=i.match(/version\/(\d+)/i))&&o.splice(1,1,e[1]),o.join(" "))}};t6=to([t$()],t6);var t3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){}:function(e){},t4=window.device,t5={},t8=[];window.device=t5;var t9=window.document.documentElement,t7=window.navigator.userAgent.toLowerCase(),ne=["googletv","viera","smarttv","internet.tv","netcast","nettv","appletv","boxee","kylo","roku","dlnadoc","pov_tv","hbbtv","ce-html"];function nt(e,t){return -1!==e.indexOf(t)}function nn(e){return nt(t7,e)}function ni(e){return t9.className.match(RegExp(e,"i"))}function no(e){var t=null;ni(e)||(t=t9.className.replace(/^\s+|\s+$/g,""),t9.className=t+" "+e)}function ns(e){ni(e)&&(t9.className=t9.className.replace(" "+e,""))}function nr(){t5.landscape()?(ns("portrait"),no("landscape"),na("landscape")):(ns("landscape"),no("portrait"),na("portrait")),nu()}function na(e){for(var t=0;t<t8.length;t++)t8[t](e)}t5.macos=function(){},t5.ios=function(){return t5.iphone()||t5.ipod()||t5.ipad()},t5.iphone=function(){return!t5.windows()&&nn("iphone")},t5.ipod=function(){},t5.ipad=function(){var e="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1;return nn("ipad")||e},t5.android=function(){return!t5.windows()&&nn("android")},t5.androidPhone=function(){return t5.android()&&nn("mobile")},t5.androidTablet=function(){return t5.android()&&!nn("mobile")},t5.blackberry=function(){return nn("blackberry")||nn("bb10")},t5.blackberryPhone=function(){},t5.blackberryTablet=function(){return t5.blackberry()&&nn("tablet")},t5.windows=function(){return nn("windows")},t5.windowsPhone=function(){},t5.windowsTablet=function(){return t5.windows()&&nn("touch")&&!t5.windowsPhone()},t5.fxos=function(){return(nn("(mobile")||nn("(tablet"))&&nn(" rv:")},t5.fxosPhone=function(){},t5.fxosTablet=function(){return t5.fxos()&&nn("tablet")},t5.meego=function(){},t5.cordova=function(){return window.cordova&&"file:"===location.protocol},t5.nodeWebkit=function(){},t5.mobile=function(){return t5.androidPhone()||t5.iphone()||t5.ipod()||t5.windowsPhone()||t5.blackberryPhone()||t5.fxosPhone()||t5.meego()},t5.tablet=function(){return t5.ipad()||t5.androidTablet()||t5.blackberryTablet()||t5.windowsTablet()||t5.fxosTablet()},t5.desktop=function(){},t5.television=function(){},t5.portrait=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?nt(screen.orientation.type,"portrait"):t5.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90!==Math.abs(window.orientation):window.innerHeight/window.innerWidth>1},t5.landscape=function(){return screen.orientation&&Object.prototype.hasOwnProperty.call(window,"onorientationchange")?nt(screen.orientation.type,"landscape"):t5.ios()&&Object.prototype.hasOwnProperty.call(window,"orientation")?90===Math.abs(window.orientation):window.innerHeight/window.innerWidth<1},t5.noConflict=function(){},t5.ios()?t5.ipad()?no("ios ipad tablet"):t5.iphone()?no("ios iphone mobile"):t5.ipod()&&no("ios ipod mobile"):t5.macos()?no("macos desktop"):t5.android()?t5.androidTablet()?no("android tablet"):no("android mobile"):t5.blackberry()?t5.blackberryTablet()?no("blackberry tablet"):no("blackberry mobile"):t5.windows()?t5.windowsTablet()?no("windows tablet"):t5.windowsPhone()?no("windows mobile"):no("windows desktop"):t5.fxos()?t5.fxosTablet()?no("fxos tablet"):no("fxos mobile"):t5.meego()?no("meego mobile"):t5.nodeWebkit()?no("node-webkit"):t5.television()?no("television"):t5.desktop()&&no("desktop"),t5.cordova()&&no("cordova"),t5.onChangeOrientation=function(e){};var nc="resize";function nl(e){for(var t=0;t<e.length;t++)if(t5[e[t]]())return e[t];return"unknown"}function nu(){t5.orientation=nl(["portrait","landscape"])}Object.prototype.hasOwnProperty.call(window,"onorientationchange")&&(nc="orientationchange"),window.addEventListener?window.addEventListener(nc,nr,!1):window.attachEvent?window.attachEvent(nc,nr):window[nc]=nr,nr(),t5.type=nl(["mobile","tablet","desktop"]),t5.os=nl(["ios","iphone","ipad","ipod","android","blackberry","macos","windows","fxos","meego","television"]),nu();let nd=class{getDeviceType(){return t5.tablet()?"tablet":t5.mobile()?"smartphone":"desktop"}};nd=to([t$()],nd);class nh{static getURLSearchParams(){let e=window.location.search.substring(1);return new URLSearchParams(e)}static get(e){let t=nh.getURLSearchParams();return t.get(e)}static stringify(e){}}class np{transform(e,t){return e.setLoggerGroup(t)}}let nf=class{constructor(e){var t,n;this.logGroup="Global",this.debugGroup=this.getDebugGroup()||"",this.groups=this.debugGroup.split(","),this.initTime=null!==(n=null===(t=null==e?void 0:e.performance)||void 0===t?void 0:t.timeOrigin)&&void 0!==n?n:Date.now()}setLoggerGroup(e){return this.logGroup=e,this}getTimeDelta(){}getDebugGroup(){return nh.get("identity_debug")}getTimeDeltaFixed(){}info(...e){this.loggingEnabled()&&console.info(`${this.getTimeDeltaFixed()}s		 [IE] ${this.logGroup}`,e)}warn(...e){}error(...e){}loggingEnabled(){return""!==this.debugGroup&&("1"===this.debugGroup||-1!==this.groups.indexOf(this.logGroup))}};nf=to([tB(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(a="undefined"!=typeof Window&&Window)?a:Object])],nf);let ng=["ai","aw","ax","at","be","bg","bm","vg","bq","ky","hr","cw","cy","cz","dk","ee","fk","fo","fi","fr","gf","pf","tf","de","gi","gr","gl","gp","hu","is","ie","im","it","re","lv","li","lt","lu","mq","mt","yt","ms","nl","nc","no","pn","pl","pt","ro","bl","sh","mf","pm","bq","sx","sk","si","es","se","ch","tc","gb","uk","wf"],nv=class{constructor(e,t,n){this.cookiesManager=e,this.window=t,this.logger=n}get(){return this.geoData||(this.geoData=this.getGeoData()),this.geoData}set(e){this.geoData=e}getGeoData(){let e=this.getGeoDataFromCookie();return Object.keys(e).length?e:this.getGeoDataFromOneTrust()}getGeoDataFromCookie(){let e=this.cookiesManager.get("Geo");if(!e)return{};let t=decodeURIComponent(e);try{return JSON.parse(t)}catch(e){return this.logger.error("Invalid JSON in the cookie",e),{}}}getGeoDataFromOneTrust(){}getCountryCode(){var e,t;return null===(t=null===(e=this.get())||void 0===e?void 0:e.country)||void 0===t?void 0:t.toLowerCase()}getRegionCode(){}getContinentCode(){}isGdprCountry(){}};nv=to([t$(),ts(0,tH(tZ)),ts(1,tH(t0)),ts(2,tq(nf,np,"Geo")),tr("design:paramtypes",["function"==typeof(c="undefined"!=typeof CookiesManager&&CookiesManager)?c:Object,"function"==typeof(l="undefined"!=typeof Window&&Window)?l:Object,"function"==typeof(u=void 0!==nf&&nf)?u:Object])],nv);let nm=class{get(e){return ta(this,void 0,void 0,function*(){return fetch(e,{method:"GET",mode:"cors"})})}};nm=to([tB()],nm);let ny=class{constructor(e,t,n,i){this.cookiesManager=e,this.httpClient=t,this.logger=n,this.geo=i}setGeoCookieIfNotExist(){return ta(this,void 0,void 0,function*(){if(this.cookiesManager.get("Geo")){this.logger.info("Geo cookie already exists");return}let e=yield this.httpClient.get("https://services.fandom.com/geoip/location"),{country_code:t,region:n,continent_code:i}=yield e.json(),o={country:t,region:n,continent:i},s=JSON.stringify(o);this.cookiesManager.set("Geo",s,{expires:365}),this.geo.set(o),this.logger.info("Geo cookie set")})}};ny=to([t$(),ts(0,tH(tZ)),ts(1,tH(nm)),ts(2,tq(nf,np,"GeoCookie")),ts(3,tH(nv)),tr("design:paramtypes",["function"==typeof(d="undefined"!=typeof CookiesManager&&CookiesManager)?d:Object,"function"==typeof(h=void 0!==nm&&nm)?h:Object,"function"==typeof(p=void 0!==nf&&nf)?p:Object,"function"==typeof(f=void 0!==nv&&nv)?f:Object])],ny);let nw=class{get(){var e,t,n;let i=nh.get("identity_icbm_app");return i||(void 0!==window.mw&&(null===(n=null===(t=null===(e=window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===n?void 0:n.platformName)!==void 0?window.ads.context.opts.platformName:this.checkHostname())}checkHostname(){let{hostname:e,pathname:t}=window.location;switch(!0){case e.includes("fandom"):return e.includes("bingebot")?"bingebot":"f2";case e.includes("futhead"):return"futhead";case e.includes("muthead"):return"muthead";case e.includes("gamespot"):return e.includes("comicvine")?"comicvine":e.includes("gamefaqs")?"gamefaqs":"gamespot";case e.includes("metacritic"):return t.includes("news")?"metacritic-neutron":"metacritic";case e.includes("tvguide"):return"tvguide";case e.includes("giantbomb"):return"giantbomb";default:return"fandomdesktop"}}};nw=to([t$()],nw);let nb=class{get(){return["fandom.com","muthead.com","futhead.com"].find(e=>window.location.hostname.includes(e))?"https://services.fandom.com/":"https://services.fandom-dev."+(location.hostname.match(/(?!\.)(pl|us)$/)||["us"])[0]+"/"}};nb=to([t$()],nb);let nC=class{constructor(e,t){this.platform=e,this.device=t,this.skinMap={muthead:"turf",futhead:"turf",giantbomb:"giantbomb",gamefaqs:"gamefaqs",gamespot:"gamespot",metacritic:"metacritic","metacritic-neutron":"metacritic_neutron",comicvine:"comicvine",f2:"fandom",tvguide:"tvguide",fandomdesktop:"ucp",fandommobile:"ucp"}}get(){let e=this.platform.get(),t="desktop"===this.device.getDeviceType()?"desktop":"mobile";return this.skinMap[e]?this.skinMap[e]+"_"+t:"unknown"}};nC=to([t$(),ts(0,tH(nw)),ts(1,tH(nd)),tr("design:paramtypes",["function"==typeof(g=void 0!==nw&&nw)?g:Object,"function"==typeof(v=void 0!==nd&&nd)?v:Object])],nC);let nS=class{constructor(e){this.window=e}getItem(e){let t=this.window.localStorage.getItem(e);try{return JSON.parse(t)}catch(e){return t}}setItem(e,t){let n=t instanceof Object?JSON.stringify(t):t;this.window.localStorage.setItem(e,n)}removeItem(e){}};nS=to([t$(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(m="undefined"!=typeof Window&&Window)?m:Object])],nS);let nI=class{static extract(e){let t=e.split(".");if(t.length<2)return e;let n=`.${t[t.length-2]}.${t[t.length-1]}`;return[".co.jp",".co.nz",".co.uk"].indexOf(n)>=0&&(n=`.${t[t.length-3]}${n}`),n}};nI=to([tB()],nI);let nE=class{constructor(e){this.window=e}get(e){var t,n,i;return null!==(i=null===(n=null===(t=this.window.mw)||void 0===t?void 0:t.config)||void 0===n?void 0:n.get(e))&&void 0!==i?i:null}};nE=to([t$(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(y="undefined"!=typeof Window&&Window)?y:Object])],nE);let n_=class{createScript(e,t="text/javascript",n=!0,i=null,o={},s={}){}loadScript(e,t="text/javascript",n=!0,i=null,o={},s={}){}};n_=to([tB()],n_);let nO=class{constructor(e,t,n,i){this.cookiesManager=e,this.window=t,this.context=n,this.logger=i,this.ageGateCookie="ag",this.ageGateLegacyCookie="age_gate",this.ageGateExpiryMs=31536e6}init(e){var t,n;return ta(this,void 0,void 0,function*(){let i=!!(null===(n=null===(t=this.context.get())||void 0===t?void 0:t.targeting)||void 0===n?void 0:n.directedAtChildren),o=i&&this.window.mw.config.get("wgAgeGateEnabled",!1);if(!o)return this.logger.info("disabled"),Promise.resolve();let s=this.cookiesManager.get(this.ageGateLegacyCookie);if(s)return this.updateLegacyCookie(s),Promise.resolve();let r=this.cookiesManager.get(this.ageGateCookie);return r||(yield this.waitForAgeGateDataAndSetCookie(e)),Promise.resolve()})}waitForAgeGateDataAndSetCookie(e){}setCookie(e){}updateLegacyCookie(e){}getTopLevelDomain(){}};nO=to([t$(),ts(0,tH(tZ)),ts(1,tH(t0)),ts(2,tH(t2)),ts(3,tq(nf,np,"AgeGate")),tr("design:paramtypes",["function"==typeof(w="undefined"!=typeof CookiesManager&&CookiesManager)?w:Object,"function"==typeof(b="undefined"!=typeof Window&&Window)?b:Object,"function"==typeof(C=void 0!==t2&&t2)?C:Object,"function"==typeof(S=void 0!==nf&&nf)?S:Object])],nO);let nk=class{generate(){let e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_-",t="";for(;t.length<10;)t+=e[Math.random()*e.length|0];return t}};nk=to([tB()],nk);let nT=class{resolve(e,t,n){e.geoRequiresConsent&&e.gdprConsent||e.geoRequiresSignal&&!e.ccpaSignal||!e.geoRequiresSignal&&!e.geoRequiresConsent?(this.consentGiven=!0,t()):(e.geoRequiresSignal&&e.ccpaSignal||e.geoRequiresConsent&&!e.gdprConsent)&&(this.consentGiven=!1,n())}getConsents(){}};nT=to([t$()],nT);let nR={".fanatical.com":"0ab0e172-dc9c-44b9-8a58-c80d9ba4fae0",".futhead.com":"82c642a4-d3a9-4a78-a310-21a7b49ab17b",".gamespot.com":"73588546-b116-4dbc-ab64-9db97e11fc0d",".metacritic.com":"50e16f1d-a929-4cc0-80a7-3c5c303eea6a",".muthead.com":"fb34a16e-696d-4748-af9f-96f3b9e2b4da",".tvguide.com":"ffc22311-f4da-4e03-a1ad-32aecd522c5b",".fandom.com":"dea70a1b-c82d-4fe0-86ff-5e164b0a6022"},nA=[{url:"https://cdn.cookielaw.org/scripttemplates/otSDKStub.js",options:{}},{url:"https://cdn.cookielaw.org/opt-out/otCCPAiab.js",options:{charSet:"UTF-8",type:"text/javascript","ccpa-opt-out-ids":"C0004","ccpa-opt-out-geo":"us","ccpa-opt-out-lspa":"false"}},{url:"https://cdn.cookielaw.org/consent/tcf.stub.js",options:{charSet:"UTF-8"}}],nL=class{constructor(e,t,n,i,o){}replaceDoNotSellLink(){}oneTrustModalClosed(){}subscribe(){}oneTrustCookieExists(){}readTrackingConsents(){}consentsUpdated(){}loadOneTrustScripts(){}getDomainId(){}};nL=to([t$(),ts(0,tH(tZ)),ts(1,tH(t0)),ts(2,tH(n_)),ts(3,tH(nv)),ts(4,tq(nf,np,"OneTrust")),tr("design:paramtypes",["function"==typeof(I="undefined"!=typeof CookiesManager&&CookiesManager)?I:Object,"function"==typeof(E="undefined"!=typeof Window&&Window)?E:Object,"function"==typeof(_=void 0!==n_&&n_)?_:Object,"function"==typeof(O=void 0!==nv&&nv)?O:Object,"function"==typeof(k=void 0!==nf&&nf)?k:Object])],nL),function(e){e.PING="ping",e.GET_TC_DATA="getTCData",e.GET_IN_APP_TC_DATA="getInAppTCData",e.GET_VENDOR_LIST="getVendorList",e.ADD_EVENT_LISTENER="addEventListener",e.REMOVE_EVENT_LISTENER="removeEventListener"}(T||(T={})),function(e){e.STUB="stub",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(R||(R={})),function(e){e.VISIBLE="visible",e.HIDDEN="hidden",e.DISABLED="disabled"}(A||(A={})),function(e){e.TC_LOADED="tcloaded",e.CMP_UI_SHOWN="cmpuishown",e.USER_ACTION_COMPLETE="useractioncomplete"}(L||(L={}));class nP{listenerId;callback;next;param;success=!0;constructor(e,t,n,i){Object.assign(this,{callback:e,listenerId:n,param:t,next:i});try{this.respond()}catch(e){this.invokeCallback(null)}}invokeCallback(e){let t=null!==e;"function"==typeof this.next?this.callback(this.next,e,t):this.callback(e,t)}}class nD extends nP{respond(){this.throwIfParamInvalid(),this.invokeCallback(new nM(this.param,this.listenerId))}throwIfParamInvalid(){if(void 0!==this.param&&(!Array.isArray(this.param)||!this.param.every(Number.isInteger)))throw Error("Invalid Parameter")}}class nV{eventQueue=new Map;queueNumber=0;add(e){return this.eventQueue.set(this.queueNumber,e),this.queueNumber++}remove(e){return this.eventQueue.delete(e)}exec(){this.eventQueue.forEach((e,t)=>{new nD(e.callback,e.param,t,e.next)})}clear(){this.queueNumber=0,this.eventQueue.clear()}get size(){return this.eventQueue.size}}class nx{static apiVersion="2";static tcfPolicyVersion;static eventQueue=new nV;static cmpStatus=R.LOADING;static disabled=!1;static displayStatus=A.HIDDEN;static cmpId;static cmpVersion;static eventStatus;static gdprApplies;static tcModel;static tcString;static reset(){delete this.cmpId,delete this.cmpVersion,delete this.eventStatus,delete this.gdprApplies,delete this.tcModel,delete this.tcString,delete this.tcfPolicyVersion,this.cmpStatus=R.LOADING,this.disabled=!1,this.displayStatus=A.HIDDEN,this.eventQueue.clear()}}class nN{cmpId=nx.cmpId;cmpVersion=nx.cmpVersion;gdprApplies=nx.gdprApplies;tcfPolicyVersion=nx.tcfPolicyVersion}class nj extends nN{cmpStatus=R.ERROR}class nM extends nN{tcString;listenerId;eventStatus;cmpStatus;isServiceSpecific;useNonStandardStacks;publisherCC;purposeOneTreatment;outOfBand;purpose;vendor;specialFeatureOptins;publisher;constructor(e,t){if(super(),this.eventStatus=nx.eventStatus,this.cmpStatus=nx.cmpStatus,this.listenerId=t,nx.gdprApplies){let t=nx.tcModel;this.tcString=nx.tcString,this.isServiceSpecific=t.isServiceSpecific,this.useNonStandardStacks=t.useNonStandardStacks,this.purposeOneTreatment=t.purposeOneTreatment,this.publisherCC=t.publisherCountryCode,this.outOfBand={allowedVendors:this.createVectorField(t.vendorsAllowed,e),disclosedVendors:this.createVectorField(t.vendorsDisclosed,e)},this.purpose={consents:this.createVectorField(t.purposeConsents),legitimateInterests:this.createVectorField(t.purposeLegitimateInterests)},this.vendor={consents:this.createVectorField(t.vendorConsents,e),legitimateInterests:this.createVectorField(t.vendorLegitimateInterests,e)},this.specialFeatureOptins=this.createVectorField(t.specialFeatureOptins),this.publisher={consents:this.createVectorField(t.publisherConsents),legitimateInterests:this.createVectorField(t.publisherLegitimateInterests),customPurpose:{consents:this.createVectorField(t.publisherCustomConsents),legitimateInterests:this.createVectorField(t.publisherCustomLegitimateInterests)},restrictions:this.createRestrictions(t.publisherRestrictions)}}}createRestrictions(e){let t={};if(e.numRestrictions>0){let n=e.getMaxVendorId();for(let i=1;i<=n;i++){let n=i.toString();e.getRestrictions(i).forEach(e=>{let i=e.purposeId.toString();t[i]||(t[i]={}),t[i][n]=e.restrictionType})}}return t}createVectorField(e,t){return t?t.reduce((t,n)=>(t[String(n)]=e.has(Number(n)),t),{}):[...e].reduce((e,t)=>(e[t[0].toString(10)]=t[1],e),{})}}class nU extends nM{constructor(e){super(e),delete this.outOfBand}createVectorField(e){return[...e].reduce((e,t)=>e+=t[1]?"1":"0","")}createRestrictions(e){let t={};if(e.numRestrictions>0){let n=e.getMaxVendorId();e.getRestrictions().forEach(e=>{t[e.purposeId.toString()]="_".repeat(n)});for(let i=0;i<n;i++){let n=i+1;e.getRestrictions(n).forEach(e=>{let n=e.restrictionType.toString(),o=e.purposeId.toString(),s=t[o].substr(0,i),r=t[o].substr(i+1);t[o]=s+n+r})}}return t}}class nG extends nN{cmpLoaded=!0;cmpStatus=nx.cmpStatus;displayStatus=nx.displayStatus;apiVersion=String(nx.apiVersion);gvlVersion;constructor(){super(),nx.tcModel&&nx.tcModel.vendorListVersion&&(this.gvlVersion=+nx.tcModel.vendorListVersion)}}class nF extends nP{respond(){this.invokeCallback(new nG)}}class nW extends nD{respond(){this.throwIfParamInvalid(),this.invokeCallback(new nU(this.param))}}class nH extends Error{constructor(e){super(e),this.name="DecodingError"}}class nB extends Error{constructor(e){super(e),this.name="EncodingError"}}class n$ extends Error{constructor(e){super(e),this.name="GVLError"}}class nq extends Error{constructor(e,t,n=""){super(`invalid value ${t} passed for ${e} ${n}`),this.name="TCModelError"}}class nQ{static DICT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static REVERSE_DICT=new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]]);static BASIS=6;static LCM=24;static encode(e){if(!/^[0-1]+$/.test(e))throw new nB("Invalid bitField");let t=e.length%this.LCM;e+=t?"0".repeat(this.LCM-t):"";let n="";for(let t=0;t<e.length;t+=this.BASIS)n+=this.DICT[parseInt(e.substr(t,this.BASIS),2)];return n}static decode(e){if(!/^[A-Za-z0-9\-_]+$/.test(e))throw new nH("Invalidly encoded Base64URL string");let t="";for(let n=0;n<e.length;n++){let i=this.REVERSE_DICT.get(e[n]).toString(2);t+="0".repeat(this.BASIS-i.length)+i}return t}}class nY{clone(){let e=new this.constructor,t=Object.keys(this);return t.forEach(t=>{let n=this.deepClone(this[t]);void 0!==n&&(e[t]=n)}),e}deepClone(e){let t=typeof e;if("number"===t||"string"===t||"boolean"===t)return e;if(null!==e&&"object"===t){if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(void 0!==e[Symbol.iterator]){let t=[];for(let n of e)t.push(this.deepClone(n));return e instanceof Array?t:new e.constructor(t)}{let t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=this.deepClone(e[n]));return t}}}}class nz extends nY{root=null;getRoot(){return this.root}isEmpty(){return!this.root}add(e){let t;let n={value:e,left:null,right:null};if(this.isEmpty())this.root=n;else for(t=this.root;;)if(e<t.value){if(null===t.left){t.left=n;break}t=t.left}else if(e>t.value){if(null===t.right){t.right=n;break}t=t.right}else break}get(){let e=[],t=this.root;for(;t;)if(t.left){let n=t.left;for(;n.right&&n.right!=t;)n=n.right;n.right==t?(n.right=null,e.push(t.value),t=t.right):(n.right=t,t=t.left)}else e.push(t.value),t=t.right;return e}contains(e){let t=!1,n=this.root;for(;n;){if(n.value===e){t=!0;break}e>n.value?n=n.right:e<n.value&&(n=n.left)}return t}min(e=this.root){let t;for(;e;)e.left?e=e.left:(t=e.value,e=null);return t}max(e=this.root){let t;for(;e;)e.right?e=e.right:(t=e.value,e=null);return t}remove(e,t=this.root){let n=null,i="left";for(;t;)if(e<t.value)n=t,t=t.left,i="left";else if(e>t.value)n=t,t=t.right,i="right";else{if(t.left||t.right){if(t.left){if(t.right){let e=this.min(t.right);this.remove(e,t.right),t.value=e}else n?n[i]=t.left:this.root=t.left}else n?n[i]=t.right:this.root=t.right}else n?n[i]=null:this.root=null;t=null}}static build(e){if(!e||0===e.length)return null;if(1===e.length){let t=new nz;return t.add(e[0]),t}{let t=e.length>>1,n=new nz;n.add(e[t]);let i=n.getRoot();if(i){if(t+1<e.length){let n=nz.build(e.slice(t+1));i.right=n?n.getRoot():null}if(t-1>0){let n=nz.build(e.slice(0,t-1));i.left=n?n.getRoot():null}}return n}}}class nK{static langSet=new Set(["BG","CA","CS","DA","DE","EL","EN","ES","ET","FI","FR","HR","HU","IT","JA","LT","LV","MT","NL","NO","PL","PT","RO","RU","SK","SL","SV","TR","ZH"]);has(e){return nK.langSet.has(e)}forEach(e){nK.langSet.forEach(e)}get size(){return nK.langSet.size}}class nJ{static cmpId="cmpId";static cmpVersion="cmpVersion";static consentLanguage="consentLanguage";static consentScreen="consentScreen";static created="created";static supportOOB="supportOOB";static isServiceSpecific="isServiceSpecific";static lastUpdated="lastUpdated";static numCustomPurposes="numCustomPurposes";static policyVersion="policyVersion";static publisherCountryCode="publisherCountryCode";static publisherCustomConsents="publisherCustomConsents";static publisherCustomLegitimateInterests="publisherCustomLegitimateInterests";static publisherLegitimateInterests="publisherLegitimateInterests";static publisherConsents="publisherConsents";static publisherRestrictions="publisherRestrictions";static purposeConsents="purposeConsents";static purposeLegitimateInterests="purposeLegitimateInterests";static purposeOneTreatment="purposeOneTreatment";static specialFeatureOptins="specialFeatureOptins";static useNonStandardStacks="useNonStandardStacks";static vendorConsents="vendorConsents";static vendorLegitimateInterests="vendorLegitimateInterests";static vendorListVersion="vendorListVersion";static vendorsAllowed="vendorsAllowed";static vendorsDisclosed="vendorsDisclosed";static version="version"}!function(e){e[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",e[e.REQUIRE_LI=2]="REQUIRE_LI"}(P||(P={}));class nX extends nY{static hashSeparator="-";purposeId_;restrictionType;constructor(e,t){super(),void 0!==e&&(this.purposeId=e),void 0!==t&&(this.restrictionType=t)}static unHash(e){let t=e.split(this.hashSeparator),n=new nX;if(2!==t.length)throw new nq("hash",e);return n.purposeId=parseInt(t[0],10),n.restrictionType=parseInt(t[1],10),n}get hash(){if(!this.isValid())throw Error("cannot hash invalid PurposeRestriction");return`${this.purposeId}${nX.hashSeparator}${this.restrictionType}`}get purposeId(){return this.purposeId_}set purposeId(e){this.purposeId_=e}isValid(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===P.NOT_ALLOWED||this.restrictionType===P.REQUIRE_CONSENT||this.restrictionType===P.REQUIRE_LI)}isSameAs(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType}}class nZ extends nY{bitLength=0;map=new Map;gvl_;has(e){return this.map.has(e)}isOkToHave(e,t,n){let i=!0;if(this.gvl?.vendors){let o=this.gvl.vendors[n];if(o){if(e===P.NOT_ALLOWED)i=o.legIntPurposes.includes(t)||o.purposes.includes(t);else if(o.flexiblePurposes.length)switch(e){case P.REQUIRE_CONSENT:i=o.flexiblePurposes.includes(t)&&o.legIntPurposes.includes(t);break;case P.REQUIRE_LI:i=o.flexiblePurposes.includes(t)&&o.purposes.includes(t)}else i=!1}else i=!1}return i}add(e,t){if(this.isOkToHave(t.restrictionType,t.purposeId,e)){let n=t.hash;this.has(n)||(this.map.set(n,new nz),this.bitLength=0),this.map.get(n).add(e)}}restrictPurposeToLegalBasis(e){let t=this.gvl.vendorIds,n=e.hash,i=function(){let e;for(e of t);return e}(),o=[...Array(i).keys()].map(e=>e+1);for(let e=1;e<=i;e++)this.has(n)||(this.map.set(n,nz.build(o)),this.bitLength=0),this.map.get(n).add(e)}getVendors(e){let t=[];if(e){let n=e.hash;this.has(n)&&(t=this.map.get(n).get())}else{let e=new Set;this.map.forEach(t=>{t.get().forEach(t=>{e.add(t)})}),t=Array.from(e)}return t}getRestrictionType(e,t){let n;return this.getRestrictions(e).forEach(e=>{e.purposeId===t&&(void 0===n||n>e.restrictionType)&&(n=e.restrictionType)}),n}vendorHasRestriction(e,t){let n=!1,i=this.getRestrictions(e);for(let e=0;e<i.length&&!n;e++)n=t.isSameAs(i[e]);return n}getMaxVendorId(){let e=0;return this.map.forEach(t=>{e=Math.max(t.max(),e)}),e}getRestrictions(e){let t=[];return this.map.forEach((n,i)=>{e?n.contains(e)&&t.push(nX.unHash(i)):t.push(nX.unHash(i))}),t}getPurposes(){let e=new Set;return this.map.forEach((t,n)=>{e.add(nX.unHash(n).purposeId)}),Array.from(e)}remove(e,t){let n=t.hash,i=this.map.get(n);i&&(i.remove(e),i.isEmpty()&&(this.map.delete(n),this.bitLength=0))}set gvl(e){this.gvl_||(this.gvl_=e,this.map.forEach((e,t)=>{let n=nX.unHash(t),i=e.get();i.forEach(t=>{this.isOkToHave(n.restrictionType,n.purposeId,t)||e.remove(t)})}))}get gvl(){return this.gvl_}isEmpty(){return 0===this.map.size}get numRestrictions(){return this.map.size}}!function(e){e.COOKIE="cookie",e.WEB="web",e.APP="app"}(D||(D={})),function(e){e.CORE="core",e.VENDORS_DISCLOSED="vendorsDisclosed",e.VENDORS_ALLOWED="vendorsAllowed",e.PUBLISHER_TC="publisherTC"}(V||(V={}));class n0{static ID_TO_KEY=[V.CORE,V.VENDORS_DISCLOSED,V.VENDORS_ALLOWED,V.PUBLISHER_TC];static KEY_TO_ID={[V.CORE]:0,[V.VENDORS_DISCLOSED]:1,[V.VENDORS_ALLOWED]:2,[V.PUBLISHER_TC]:3}}class n1 extends nY{bitLength=0;maxId_=0;set_=new Set;*[Symbol.iterator](){for(let e=1;e<=this.maxId;e++)yield[e,this.has(e)]}values(){return this.set_.values()}get maxId(){return this.maxId_}has(e){return this.set_.has(e)}unset(e){Array.isArray(e)?e.forEach(e=>this.unset(e)):"object"==typeof e?this.unset(Object.keys(e).map(e=>Number(e))):(this.set_.delete(Number(e)),this.bitLength=0,e===this.maxId&&(this.maxId_=0,this.set_.forEach(e=>{this.maxId_=Math.max(this.maxId,e)})))}isIntMap(e){return"object"==typeof e&&Object.keys(e).every(t=>{let n=Number.isInteger(parseInt(t,10));return(n=n&&this.isValidNumber(e[t].id))&&void 0!==e[t].name})}isValidNumber(e){return parseInt(e,10)>0}isSet(e){let t=!1;return e instanceof Set&&(t=Array.from(e).every(this.isValidNumber)),t}set(e){if(Array.isArray(e))e.forEach(e=>this.set(e));else if(this.isSet(e))this.set(Array.from(e));else if(this.isIntMap(e))this.set(Object.keys(e).map(e=>Number(e)));else if(this.isValidNumber(e))this.set_.add(e),this.maxId_=Math.max(this.maxId,e),this.bitLength=0;else throw new nq("set()",e,"must be positive integer array, positive integer, Set<number>, or IntMap")}empty(){this.set_=new Set}forEach(e){for(let t=1;t<=this.maxId;t++)e(this.has(t),t)}get size(){return this.set_.size}setAll(e){this.set(e)}}class n2{static [nJ.cmpId]=12;static [nJ.cmpVersion]=12;static [nJ.consentLanguage]=12;static [nJ.consentScreen]=6;static [nJ.created]=36;static [nJ.isServiceSpecific]=1;static [nJ.lastUpdated]=36;static [nJ.policyVersion]=6;static [nJ.publisherCountryCode]=12;static [nJ.publisherLegitimateInterests]=24;static [nJ.publisherConsents]=24;static [nJ.purposeConsents]=24;static [nJ.purposeLegitimateInterests]=24;static [nJ.purposeOneTreatment]=1;static [nJ.specialFeatureOptins]=12;static [nJ.useNonStandardStacks]=1;static [nJ.vendorListVersion]=12;static [nJ.version]=6;static anyBoolean=1;static encodingType=1;static maxId=16;static numCustomPurposes=6;static numEntries=12;static numRestrictions=12;static purposeId=6;static restrictionType=2;static segmentType=3;static singleOrRange=1;static vendorId=16}class n6{static encode(e){return String(Number(e))}static decode(e){return"1"===e}}class n3{static encode(e,t){let n;if("string"==typeof e&&(e=parseInt(e,10)),(n=e.toString(2)).length>t||e<0)throw new nB(`${e} too large to encode into ${t}`);return n.length<t&&(n="0".repeat(t-n.length)+n),n}static decode(e,t){if(t!==e.length)throw new nH("invalid bit length");return parseInt(e,2)}}class n4{static encode(e,t){return n3.encode(Math.round(e.getTime()/100),t)}static decode(e,t){if(t!==e.length)throw new nH("invalid bit length");let n=new Date;return n.setTime(100*n3.decode(e,t)),n}}class n5{static encode(e,t){let n="";for(let i=1;i<=t;i++)n+=n6.encode(e.has(i));return n}static decode(e,t){if(e.length!==t)throw new nH("bitfield encoding length mismatch");let n=new n1;for(let i=1;i<=t;i++)n6.decode(e[i-1])&&n.set(i);return n.bitLength=e.length,n}}class n8{static encode(e,t){e=e.toUpperCase();let n=e.charCodeAt(0)-65,i=e.charCodeAt(1)-65;if(n<0||n>25||i<0||i>25)throw new nB(`invalid language code: ${e}`);if(t%2==1)throw new nB(`numBits must be even, ${t} is not valid`);t/=2;let o=n3.encode(n,t),s=n3.encode(i,t);return o+s}static decode(e,t){let n;if(t!==e.length||e.length%2)throw new nH("invalid bit length for language");{let t=e.length/2,i=n3.decode(e.slice(0,t),t)+65,o=n3.decode(e.slice(t),t)+65;n=String.fromCharCode(i)+String.fromCharCode(o)}return n}}class n9{static encode(e){let t=n3.encode(e.numRestrictions,n2.numRestrictions);return e.isEmpty()||e.getRestrictions().forEach(n=>{t+=n3.encode(n.purposeId,n2.purposeId)+n3.encode(n.restrictionType,n2.restrictionType);let i=e.getVendors(n),o=i.length,s=0,r=0,a="";for(let t=0;t<o;t++){let n=i[t];0===r&&(s++,r=n);let c=i[o-1],l=e.gvl.vendorIds,u=e=>{for(;++e<=c&&!l.has(e););return e};if(t===o-1||i[t+1]>u(n)){let e=n!==r;a+=n6.encode(e)+n3.encode(r,n2.vendorId),e&&(a+=n3.encode(n,n2.vendorId)),r=0}}t+=n3.encode(s,n2.numEntries)+a}),t}static decode(e){let t=0,n=new nZ,i=n3.decode(e.substr(t,n2.numRestrictions),n2.numRestrictions);t+=n2.numRestrictions;for(let o=0;o<i;o++){let i=n3.decode(e.substr(t,n2.purposeId),n2.purposeId);t+=n2.purposeId;let o=n3.decode(e.substr(t,n2.restrictionType),n2.restrictionType);t+=n2.restrictionType;let s=new nX(i,o),r=n3.decode(e.substr(t,n2.numEntries),n2.numEntries);t+=n2.numEntries;for(let i=0;i<r;i++){let i=n6.decode(e.substr(t,n2.anyBoolean));t+=n2.anyBoolean;let o=n3.decode(e.substr(t,n2.vendorId),n2.vendorId);if(t+=n2.vendorId,i){let i=n3.decode(e.substr(t,n2.vendorId),n2.vendorId);if(t+=n2.vendorId,i<o)throw new nH(`Invalid RangeEntry: endVendorId ${i} is less than ${o}`);for(let e=o;e<=i;e++)n.add(e,s)}else n.add(o,s)}}return n.bitLength=t,n}}!function(e){e[e.FIELD=0]="FIELD",e[e.RANGE=1]="RANGE"}(x||(x={}));class n7{static encode(e){let t;let n=[],i=[],o=n3.encode(e.maxId,n2.maxId),s="",r=n2.maxId+n2.encodingType,a=r+e.maxId,c=2*n2.vendorId+n2.singleOrRange+n2.numEntries,l=r+n2.numEntries;return e.forEach((o,r)=>{if(s+=n6.encode(o),(t=e.maxId>c&&l<a)&&o){let t=e.has(r+1);t?0===i.length&&(i.push(r),l+=n2.singleOrRange+n2.vendorId):(i.push(r),l+=n2.vendorId,n.push(i),i=[])}}),t?o+=String(x.RANGE)+this.buildRangeEncoding(n):o+=String(x.FIELD)+s,o}static decode(e,t){let n;let i=0,o=n3.decode(e.substr(i,n2.maxId),n2.maxId);i+=n2.maxId;let s=n3.decode(e.charAt(i),n2.encodingType);if(i+=n2.encodingType,s===x.RANGE){if(n=new n1,1===t){if("1"===e.substr(i,1))throw new nH("Unable to decode default consent=1");i++}let o=n3.decode(e.substr(i,n2.numEntries),n2.numEntries);i+=n2.numEntries;for(let t=0;t<o;t++){let t=n6.decode(e.charAt(i));i+=n2.singleOrRange;let o=n3.decode(e.substr(i,n2.vendorId),n2.vendorId);if(i+=n2.vendorId,t){let t=n3.decode(e.substr(i,n2.vendorId),n2.vendorId);i+=n2.vendorId;for(let e=o;e<=t;e++)n.set(e)}else n.set(o)}}else{let t=e.substr(i,o);i+=o,n=n5.decode(t,o)}return n.bitLength=i,n}static buildRangeEncoding(e){let t=e.length,n=n3.encode(t,n2.numEntries);return e.forEach(e=>{let t=1===e.length;n+=n6.encode(!t)+n3.encode(e[0],n2.vendorId),t||(n+=n3.encode(e[1],n2.vendorId))}),n}}function ie(){return{[nJ.version]:n3,[nJ.created]:n4,[nJ.lastUpdated]:n4,[nJ.cmpId]:n3,[nJ.cmpVersion]:n3,[nJ.consentScreen]:n3,[nJ.consentLanguage]:n8,[nJ.vendorListVersion]:n3,[nJ.policyVersion]:n3,[nJ.isServiceSpecific]:n6,[nJ.useNonStandardStacks]:n6,[nJ.specialFeatureOptins]:n5,[nJ.purposeConsents]:n5,[nJ.purposeLegitimateInterests]:n5,[nJ.purposeOneTreatment]:n6,[nJ.publisherCountryCode]:n8,[nJ.vendorConsents]:n7,[nJ.vendorLegitimateInterests]:n7,[nJ.publisherRestrictions]:n9,segmentType:n3,[nJ.vendorsDisclosed]:n7,[nJ.vendorsAllowed]:n7,[nJ.publisherConsents]:n5,[nJ.publisherLegitimateInterests]:n5,[nJ.numCustomPurposes]:n3,[nJ.publisherCustomConsents]:n5,[nJ.publisherCustomLegitimateInterests]:n5}}class it{1={[V.CORE]:[nJ.version,nJ.created,nJ.lastUpdated,nJ.cmpId,nJ.cmpVersion,nJ.consentScreen,nJ.consentLanguage,nJ.vendorListVersion,nJ.purposeConsents,nJ.vendorConsents]};2={[V.CORE]:[nJ.version,nJ.created,nJ.lastUpdated,nJ.cmpId,nJ.cmpVersion,nJ.consentScreen,nJ.consentLanguage,nJ.vendorListVersion,nJ.policyVersion,nJ.isServiceSpecific,nJ.useNonStandardStacks,nJ.specialFeatureOptins,nJ.purposeConsents,nJ.purposeLegitimateInterests,nJ.purposeOneTreatment,nJ.publisherCountryCode,nJ.vendorConsents,nJ.vendorLegitimateInterests,nJ.publisherRestrictions],[V.PUBLISHER_TC]:[nJ.publisherConsents,nJ.publisherLegitimateInterests,nJ.numCustomPurposes,nJ.publisherCustomConsents,nJ.publisherCustomLegitimateInterests],[V.VENDORS_ALLOWED]:[nJ.vendorsAllowed],[V.VENDORS_DISCLOSED]:[nJ.vendorsDisclosed]}}class ii{1=[V.CORE];2=[V.CORE];constructor(e,t){if(2===e.version){if(e.isServiceSpecific)this["2"].push(V.PUBLISHER_TC);else{let n=!!(t&&t.isForVendors);n&&!0!==e[nJ.supportOOB]||this["2"].push(V.VENDORS_DISCLOSED),n&&(e[nJ.supportOOB]&&e[nJ.vendorsAllowed].size>0&&this["2"].push(V.VENDORS_ALLOWED),this["2"].push(V.PUBLISHER_TC))}}}}class io{static fieldSequence=new it;static encode(e,t){let n;try{n=this.fieldSequence[String(e.version)][t]}catch(n){throw new nB(`Unable to encode version: ${e.version}, segment: ${t}`)}let i="";t!==V.CORE&&(i=n3.encode(n0.KEY_TO_ID[t],n2.segmentType));let o=ie();return n.forEach(n=>{let s=e[n],r=o[n],a=n2[n];void 0===a&&this.isPublisherCustom(n)&&(a=Number(e[nJ.numCustomPurposes]));try{i+=r.encode(s,a)}catch(e){throw new nB(`Error encoding ${t}->${n}: ${e.message}`)}}),nQ.encode(i)}static decode(e,t,n){let i=nQ.decode(e),o=0;n===V.CORE&&(t.version=n3.decode(i.substr(o,n2[nJ.version]),n2[nJ.version])),n!==V.CORE&&(o+=n2.segmentType);let s=this.fieldSequence[String(t.version)][n],r=ie();return s.forEach(e=>{let n=r[e],s=n2[e];if(void 0===s&&this.isPublisherCustom(e)&&(s=Number(t[nJ.numCustomPurposes])),0!==s){let r=i.substr(o,s);if(n===n7?t[e]=n.decode(r,t.version):t[e]=n.decode(r,s),Number.isInteger(s))o+=s;else if(Number.isInteger(t[e].bitLength))o+=t[e].bitLength;else throw new nH(e)}}),t}static isPublisherCustom(e){return 0===e.indexOf("publisherCustom")}}class is{static processor=[e=>e,(e,t)=>{e.publisherRestrictions.gvl=t,e.purposeLegitimateInterests.unset(1);let n=new Map;return n.set("legIntPurposes",e.vendorLegitimateInterests),n.set("purposes",e.vendorConsents),n.forEach((n,i)=>{n.forEach((o,s)=>{if(o){let o=t.vendors[s];if(!o||o.deletedDate)n.unset(s);else if(0===o[i].length){if("legIntPurposes"===i&&0===o.purposes.length&&0===o.legIntPurposes.length&&o.specialPurposes.length>0);else if(e.isServiceSpecific){if(0===o.flexiblePurposes.length)n.unset(s);else{let t=e.publisherRestrictions.getRestrictions(s),o=!1;for(let e=0,n=t.length;e<n&&!o;e++)o=t[e].restrictionType===P.REQUIRE_CONSENT&&"purposes"===i||t[e].restrictionType===P.REQUIRE_LI&&"legIntPurposes"===i;o||n.unset(s)}}else n.unset(s)}}})}),e.vendorsDisclosed.set(t.vendors),e}];static process(e,t){let n=e.gvl;if(!n)throw new nB("Unable to encode TCModel without a GVL");if(!n.isReady)throw new nB("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");(e=e.clone()).consentLanguage=n.language.toUpperCase(),t?.version>0&&t?.version<=this.processor.length?e.version=t.version:e.version=this.processor.length;let i=e.version-1;if(!this.processor[i])throw new nB(`Invalid version: ${e.version}`);return this.processor[i](e,n)}}class ir{static absCall(e,t,n,i){return new Promise((o,s)=>{let r=new XMLHttpRequest;r.withCredentials=n,r.addEventListener("load",()=>{if(r.readyState==XMLHttpRequest.DONE){if(r.status>=200&&r.status<300){let e=r.response;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}o(e)}else s(Error(`HTTP Status: ${r.status} response type: ${r.responseType}`))}}),r.addEventListener("error",()=>{s(Error("error"))}),r.addEventListener("abort",()=>{s(Error("aborted"))}),null===t?r.open("GET",e,!0):r.open("POST",e,!0),r.responseType="json",r.timeout=i,r.ontimeout=()=>{s(Error("Timeout "+i+"ms "+e))},r.send(t)})}static post(e,t,n=!1,i=0){return this.absCall(e,JSON.stringify(t),n,i)}static fetch(e,t=!1,n=0){return this.absCall(e,null,t,n)}}class ia extends nY{static LANGUAGE_CACHE=new Map;static CACHE=new Map;static LATEST_CACHE_KEY=0;static DEFAULT_LANGUAGE="EN";static consentLanguages=new nK;static baseUrl_;static set baseUrl(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new n$("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this.baseUrl_=e}static get baseUrl(){return this.baseUrl_}static latestFilename="vendor-list.json";static versionedFilename="archives/vendor-list-v[VERSION].json";static languageFilename="purposes-[LANG].json";readyPromise;gvlSpecificationVersion;vendorListVersion;tcfPolicyVersion;lastUpdated;purposes;specialPurposes;features;specialFeatures;isReady_=!1;vendors_;vendorIds;fullVendorList;byPurposeVendorMap;bySpecialPurposeVendorMap;byFeatureVendorMap;bySpecialFeatureVendorMap;stacks;lang_;isLatest=!1;constructor(e){super();let t=ia.baseUrl;if(this.lang_=ia.DEFAULT_LANGUAGE,this.isVendorList(e))this.populate(e),this.readyPromise=Promise.resolve();else{if(!t)throw new n$("must specify GVL.baseUrl before loading GVL json");e>0?ia.CACHE.has(e)?(this.populate(ia.CACHE.get(e)),this.readyPromise=Promise.resolve()):(t+=ia.versionedFilename.replace("[VERSION]",String(e)),this.readyPromise=this.fetchJson(t)):ia.CACHE.has(ia.LATEST_CACHE_KEY)?(this.populate(ia.CACHE.get(ia.LATEST_CACHE_KEY)),this.readyPromise=Promise.resolve()):(this.isLatest=!0,this.readyPromise=this.fetchJson(t+ia.latestFilename))}}static emptyLanguageCache(e){let t=!1;return void 0===e&&ia.LANGUAGE_CACHE.size>0?(ia.LANGUAGE_CACHE=new Map,t=!0):"string"==typeof e&&this.consentLanguages.has(e.toUpperCase())&&(ia.LANGUAGE_CACHE.delete(e.toUpperCase()),t=!0),t}static emptyCache(e){let t=!1;return Number.isInteger(e)&&e>=0?(ia.CACHE.delete(e),t=!0):void 0===e&&(ia.CACHE=new Map,t=!0),t}cacheLanguage(){ia.LANGUAGE_CACHE.has(this.lang_)||ia.LANGUAGE_CACHE.set(this.lang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks})}async fetchJson(e){try{this.populate(await ir.fetch(e))}catch(e){throw new n$(e.message)}}getJson(){return JSON.parse(JSON.stringify({gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,vendors:this.fullVendorList}))}async changeLanguage(e){let t=e.toUpperCase();if(ia.consentLanguages.has(t)){if(t!==this.lang_){if(this.lang_=t,ia.LANGUAGE_CACHE.has(t)){let e=ia.LANGUAGE_CACHE.get(t);for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}else{let t=ia.baseUrl+ia.languageFilename.replace("[LANG]",e);try{await this.fetchJson(t),this.cacheLanguage()}catch(e){throw new n$("unable to load language: "+e.message)}}}}else throw new n$(`unsupported language ${e}`)}get language(){return this.lang_}isVendorList(e){return void 0!==e&&void 0!==e.vendors}populate(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,"string"==typeof this.lastUpdated&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&ia.CACHE.set(ia.LATEST_CACHE_KEY,this.getJson()),ia.CACHE.has(this.vendorListVersion)||ia.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()}mapVendors(e){this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach(e=>{this.byPurposeVendorMap[e]={legInt:new Set,consent:new Set,flexible:new Set}}),Object.keys(this.specialPurposes).forEach(e=>{this.bySpecialPurposeVendorMap[e]=new Set}),Object.keys(this.features).forEach(e=>{this.byFeatureVendorMap[e]=new Set}),Object.keys(this.specialFeatures).forEach(e=>{this.bySpecialFeatureVendorMap[e]=new Set}),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map(e=>+e)),this.vendorIds=new Set(e),this.vendors_=e.reduce((e,t)=>{let n=this.vendors_[String(t)];return n&&void 0===n.deletedDate&&(n.purposes.forEach(e=>{let n=this.byPurposeVendorMap[String(e)];n.consent.add(t)}),n.specialPurposes.forEach(e=>{this.bySpecialPurposeVendorMap[String(e)].add(t)}),n.legIntPurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].legInt.add(t)}),n.flexiblePurposes&&n.flexiblePurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].flexible.add(t)}),n.features.forEach(e=>{this.byFeatureVendorMap[String(e)].add(t)}),n.specialFeatures.forEach(e=>{this.bySpecialFeatureVendorMap[String(e)].add(t)}),e[t]=n),e},{})}getFilteredVendors(e,t,n,i){let o=e.charAt(0).toUpperCase()+e.slice(1),s={};return("purpose"===e&&n?this["by"+o+"VendorMap"][String(t)][n]:this["by"+(i?"Special":"")+o+"VendorMap"][String(t)]).forEach(e=>{s[String(e)]=this.vendors[String(e)]}),s}getVendorsWithConsentPurpose(e){return this.getFilteredVendors("purpose",e,"consent")}getVendorsWithLegIntPurpose(e){return this.getFilteredVendors("purpose",e,"legInt")}getVendorsWithFlexiblePurpose(e){return this.getFilteredVendors("purpose",e,"flexible")}getVendorsWithSpecialPurpose(e){return this.getFilteredVendors("purpose",e,void 0,!0)}getVendorsWithFeature(e){return this.getFilteredVendors("feature",e)}getVendorsWithSpecialFeature(e){return this.getFilteredVendors("feature",e,void 0,!0)}get vendors(){return this.vendors_}narrowVendorsTo(e){this.mapVendors(e)}get isReady(){return this.isReady_}clone(){let e=new ia(this.getJson());return this.lang_!==ia.DEFAULT_LANGUAGE&&e.changeLanguage(this.lang_),e}static isInstanceOf(e){return"object"==typeof e&&"function"==typeof e.narrowVendorsTo}}class ic extends nY{static consentLanguages=ia.consentLanguages;isServiceSpecific_=!1;supportOOB_=!0;useNonStandardStacks_=!1;purposeOneTreatment_=!1;publisherCountryCode_="AA";version_=2;consentScreen_=0;policyVersion_=2;consentLanguage_="EN";cmpId_=0;cmpVersion_=0;vendorListVersion_=0;numCustomPurposes_=0;gvl_;created;lastUpdated;specialFeatureOptins=new n1;purposeConsents=new n1;purposeLegitimateInterests=new n1;publisherConsents=new n1;publisherLegitimateInterests=new n1;publisherCustomConsents=new n1;publisherCustomLegitimateInterests=new n1;customPurposes;vendorConsents=new n1;vendorLegitimateInterests=new n1;vendorsDisclosed=new n1;vendorsAllowed=new n1;publisherRestrictions=new nZ;constructor(e){super(),e&&(this.gvl=e),this.updated()}set gvl(e){ia.isInstanceOf(e)||(e=new ia(e)),this.gvl_=e,this.publisherRestrictions.gvl=e}get gvl(){return this.gvl_}set cmpId(e){if(Number.isInteger(e=Number(e))&&e>1)this.cmpId_=e;else throw new nq("cmpId",e)}get cmpId(){return this.cmpId_}set cmpVersion(e){if(Number.isInteger(e=Number(e))&&e>-1)this.cmpVersion_=e;else throw new nq("cmpVersion",e)}get cmpVersion(){return this.cmpVersion_}set consentScreen(e){if(Number.isInteger(e=Number(e))&&e>-1)this.consentScreen_=e;else throw new nq("consentScreen",e)}get consentScreen(){return this.consentScreen_}set consentLanguage(e){this.consentLanguage_=e}get consentLanguage(){return this.consentLanguage_}set publisherCountryCode(e){if(/^([A-z]){2}$/.test(e))this.publisherCountryCode_=e.toUpperCase();else throw new nq("publisherCountryCode",e)}get publisherCountryCode(){return this.publisherCountryCode_}set vendorListVersion(e){if((e=Number(e)>>0)<0)throw new nq("vendorListVersion",e);this.vendorListVersion_=e}get vendorListVersion(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_}set policyVersion(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new nq("policyVersion",e)}get policyVersion(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_}set version(e){this.version_=parseInt(e,10)}get version(){return this.version_}set isServiceSpecific(e){this.isServiceSpecific_=e}get isServiceSpecific(){return this.isServiceSpecific_}set useNonStandardStacks(e){this.useNonStandardStacks_=e}get useNonStandardStacks(){return this.useNonStandardStacks_}set supportOOB(e){this.supportOOB_=e}get supportOOB(){return this.supportOOB_}set purposeOneTreatment(e){this.purposeOneTreatment_=e}get purposeOneTreatment(){return this.purposeOneTreatment_}setAllVendorConsents(){this.vendorConsents.set(this.gvl.vendors)}unsetAllVendorConsents(){this.vendorConsents.empty()}setAllVendorsDisclosed(){this.vendorsDisclosed.set(this.gvl.vendors)}unsetAllVendorsDisclosed(){this.vendorsDisclosed.empty()}setAllVendorsAllowed(){this.vendorsAllowed.set(this.gvl.vendors)}unsetAllVendorsAllowed(){this.vendorsAllowed.empty()}setAllVendorLegitimateInterests(){this.vendorLegitimateInterests.set(this.gvl.vendors)}unsetAllVendorLegitimateInterests(){this.vendorLegitimateInterests.empty()}setAllPurposeConsents(){this.purposeConsents.set(this.gvl.purposes)}unsetAllPurposeConsents(){this.purposeConsents.empty()}setAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.set(this.gvl.purposes)}unsetAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.empty()}setAllSpecialFeatureOptins(){this.specialFeatureOptins.set(this.gvl.specialFeatures)}unsetAllSpecialFeatureOptins(){this.specialFeatureOptins.empty()}setAll(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()}unsetAll(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()}get numCustomPurposes(){let e=this.numCustomPurposes_;if("object"==typeof this.customPurposes){let t=Object.keys(this.customPurposes).sort((e,t)=>Number(e)-Number(t));e=parseInt(t.pop(),10)}return e}set numCustomPurposes(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new nq("numCustomPurposes",e)}updated(){let e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));this.created=t,this.lastUpdated=t}}class il{static encode(e,t){let n,i="";return e=is.process(e,t),(n=Array.isArray(t?.segments)?t.segments:new ii(e,t)[""+e.version]).forEach((t,o)=>{let s="";o<n.length-1&&(s="."),i+=io.encode(e,t)+s}),i}static decode(e,t){let n=e.split("."),i=n.length;t||(t=new ic);for(let e=0;e<i;e++){let i=n[e],o=nQ.decode(i.charAt(0)),s=o.substr(0,n2.segmentType),r=n0.ID_TO_KEY[n3.decode(s,n2.segmentType).toString()];io.decode(i,t,r)}return t}}class iu extends nP{respond(){let e;let t=nx.tcModel,n=t.vendorListVersion;void 0===this.param&&(this.param=n),(e=this.param===n&&t.gvl?t.gvl:new ia(this.param)).readyPromise.then(()=>{this.invokeCallback(e.getJson())})}}class id extends nD{respond(){this.listenerId=nx.eventQueue.add({callback:this.callback,param:this.param,next:this.next}),super.respond()}}class ih extends nP{respond(){this.invokeCallback(nx.eventQueue.remove(this.param))}}class ip{static [T.PING]=nF;static [T.GET_TC_DATA]=nD;static [T.GET_IN_APP_TC_DATA]=nW;static [T.GET_VENDOR_LIST]=iu;static [T.ADD_EVENT_LISTENER]=id;static [T.REMOVE_EVENT_LISTENER]=ih}class ig{static set_=new Set([0,2,void 0,null]);static has(e){return"string"==typeof e&&(e=Number(e)),this.set_.has(e)}}let iv="__tcfapi";class im{callQueue;customCommands;constructor(e){if(e){let t=T.ADD_EVENT_LISTENER;if(e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed: Use ${T.GET_TC_DATA} instead`);if(t=T.REMOVE_EVENT_LISTENER,e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed`);e?.[T.GET_TC_DATA]&&(e[T.ADD_EVENT_LISTENER]=e[T.GET_TC_DATA],e[T.REMOVE_EVENT_LISTENER]=e[T.GET_TC_DATA]),this.customCommands=e}try{this.callQueue=window[iv]()||[]}catch(e){this.callQueue=[]}finally{window[iv]=this.apiCall.bind(this),this.purgeQueuedCalls()}}apiCall(e,t,n,...i){if("string"!=typeof e)n(null,!1);else if(ig.has(t)){if("function"!=typeof n)throw Error("invalid callback function");nx.disabled?n(new nj,!1):this.isCustomCommand(e)||this.isBuiltInCommand(e)?this.isCustomCommand(e)&&!this.isBuiltInCommand(e)?this.customCommands[e](n,...i):e===T.PING?this.isCustomCommand(e)?new ip[e](this.customCommands[e],i[0],null,n):new ip[e](n,i[0]):void 0===nx.tcModel?this.callQueue.push([e,t,n,...i]):this.isCustomCommand(e)&&this.isBuiltInCommand(e)?new ip[e](this.customCommands[e],i[0],null,n):new ip[e](n,i[0]):n(null,!1)}else n(null,!1)}purgeQueuedCalls(){let e=this.callQueue;this.callQueue=[],e.forEach(e=>{window[iv](...e)})}isCustomCommand(e){return this.customCommands&&"function"==typeof this.customCommands[e]}isBuiltInCommand(e){return void 0!==ip[e]}}class iy{callResponder;isServiceSpecific;numUpdates=0;constructor(e,t,n=!1,i){this.throwIfInvalidInt(e,"cmpId",2),this.throwIfInvalidInt(t,"cmpVersion",0),nx.cmpId=e,nx.cmpVersion=t,nx.tcfPolicyVersion=2,this.isServiceSpecific=!!n,this.callResponder=new im(i)}throwIfInvalidInt(e,t,n){if(!("number"==typeof e&&Number.isInteger(e)&&e>=n))throw Error(`Invalid ${t}: ${e}`)}update(e,t=!1){if(nx.disabled)throw Error("CmpApi Disabled");nx.cmpStatus=R.LOADED,t?(nx.displayStatus=A.VISIBLE,nx.eventStatus=L.CMP_UI_SHOWN):void 0===nx.tcModel?(nx.displayStatus=A.DISABLED,nx.eventStatus=L.TC_LOADED):(nx.displayStatus=A.HIDDEN,nx.eventStatus=L.USER_ACTION_COMPLETE),nx.gdprApplies=null!==e,nx.gdprApplies?(""===e?(nx.tcModel=new ic,nx.tcModel.cmpId=nx.cmpId,nx.tcModel.cmpVersion=nx.cmpVersion):nx.tcModel=il.decode(e),nx.tcModel.isServiceSpecific=this.isServiceSpecific,nx.tcfPolicyVersion=Number(nx.tcModel.policyVersion),nx.tcString=e):nx.tcModel=null,0===this.numUpdates?this.callResponder.purgeQueuedCalls():nx.eventQueue.exec(),this.numUpdates++}disable(){nx.disabled=!0,nx.cmpStatus=R.ERROR}}let iw=class{constructor(e,t){this.window=e,this.logger=t,this.IAB_PURPOSES_COUNT=10,this.TCF_API_VERSION=2,this.CMP_VERSION=5,this.CMP_ID=141,this.initializeTcfApi(),this.consentGiven=new Promise(e=>this.resolveConsent=e),this.readTrackingConsents(),this.subscribe()}initializeTcfApi(){void 0===this.window.__uspapi&&void 0===this.window.__tcfapi&&new iy(this.CMP_ID,this.CMP_VERSION,!0)}subscribe(){this.window.__tcfapi&&this.window.__tcfapi("addEventListener",this.TCF_API_VERSION,this.handleTcfSubscriptionResponse.bind(this))}handleTcfSubscriptionResponse(e){if((null==e?void 0:e.eventStatus)==="useractioncomplete"||(null==e?void 0:e.eventStatus)==="tcloaded"){let t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t),this.window.__tcfapi("removeEventListener",this.TCF_API_VERSION,null,e.listenerId)}}readTrackingConsents(){this.window.__tcfapi&&this.window.__tcfapi("getTCData",this.TCF_API_VERSION,this.handleReadConsentsResponse.bind(this))}handleReadConsentsResponse(e){if((null==e?void 0:e.eventStatus)==="useractioncomplete"||(null==e?void 0:e.eventStatus)==="tcloaded"){let t=this.detectTcfTrackingConsent(e);this.consentsUpdated(t)}}detectTcfTrackingConsent(e){return null!=e&&!!e.purpose&&Object.keys(e.purpose.consents).map(t=>e.purpose.consents[t]).reduce((e,t)=>t+e,0)===this.IAB_PURPOSES_COUNT}consentsUpdated(e){this.logger.info("Consents ready"),this.resolveConsent({gdprConsent:e,geoRequiresConsent:!0,geoRequiresSignal:!1,ccpaSignal:!1})}getTCData(e){return new Promise(t=>{this.window.__tcfapi?this.window.__tcfapi("getTCData",e||this.TCF_API_VERSION,e=>t(e)):t({gdprApplies:!1})})}};iw=to([t$(),ts(0,tH(t0)),ts(1,tq(nf,np,"TCF")),tr("design:paramtypes",["function"==typeof(N="undefined"!=typeof Window&&Window)?N:Object,"function"==typeof(j=void 0!==nf&&nf)?j:Object])],iw);let ib=class{constructor(e){this.window=e,this.USP_API_VERSION=1,this.CCPA_TRACKING_ALLOWED="1YN",this.queue=[],this.consentGiven=new Promise(e=>this.resolveConsent=e)}installUspApi(){this.window.__uspapi=this.uspApiMessage.bind(this),this.addLocatorFrame(),this.addUspMessageListener()}consentsUpdated(e){this.resolveConsent({gdprConsent:!0,geoRequiresConsent:!1,geoRequiresSignal:!0,ccpaSignal:!e.startsWith(this.CCPA_TRACKING_ALLOWED)})}uspApiMessage(e,t,n){"ping"===e?n({uspapiLoaded:!1},!0):"getQueue"===e?n(this.queue,!0):this.queue.push([e,t,n])}addLocatorFrame(){let e="__uspapi";if(this.window.frames[e])return;if("loading"===document.readyState){document.addEventListener("DOMContentLoaded",()=>this.addLocatorFrame());return}let t=document.createElement("iframe");t.name=e,t.style.display="none",document.body.appendChild(t)}addUspMessageListener(){this.window.addEventListener("message",e=>{let t=this.convertUspMessageData(e);t&&this.uspMessageHandler(t,e)},!1)}convertUspMessageData(e){try{let t="string"==typeof e.data?JSON.parse(e.data):e.data;return t.__uspapiCall}catch(e){}}uspMessageHandler(e,t){this.window.__uspapi(e.command,e.version,(n,i)=>{let o={__uspapiReturn:{returnValue:n,success:i,callId:e.callId}};t.source.postMessage(o,"*")})}subscribe(){this.window.__uspapi&&this.window.__uspapi("addEventListener",this.USP_API_VERSION,this.consentsUpdated.bind(this))}readTrackingConsents(){this.window.__uspapi&&this.window.__uspapi("getUSPData",this.USP_API_VERSION,this.consentsUpdated.bind(this))}};ib=to([t$(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(M="undefined"!=typeof Window&&Window)?M:Object])],ib);let iC=class{constructor(e,t){this.logger=e,this.geo=t}get(e=!1){let t=this.geo.getCountryCode();if(this.logger.info("Location: ",t),t){if("us"===t)this.logger.info("CCPA location"),this.consentProvider=tW.resolve(ib);else{if(!ng.includes(t))return this.logger.info("Privacy policy is not required"),Promise.resolve({gdprConsent:!0,geoRequiresSignal:!1,geoRequiresConsent:!1,ccpaSignal:!1});this.consentProvider=tW.resolve(iw),this.logger.info("__tcfapi installed")}}if(!e)return;let n=tW.resolve(nL);this.logger.info("OneTrust installed");let i=[n.consentGiven];return this.consentProvider&&i.push(this.consentProvider.consentGiven),Promise.race(i)}};iC=to([t$(),ts(0,tq(nf,np,"OptInService")),ts(1,tH(nv)),tr("design:paramtypes",["function"==typeof(U=void 0!==nf&&nf)?U:Object,"function"==typeof(G=void 0!==nv&&nv)?G:Object])],iC);class iS{constructor(e,t){this.__global=!0,this.timestamp=Date.now(),this.name=e.name,this.category=e.category||"[Identity]",this.type=`${this.category} ${e.name}`,Object.assign(this,t)}}var iI=function(){return(iI=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},iE={channelId:"default",host:window,coordinatorHost:window.top},i_={connect:"connect",connected:"connected"},iO="@wikia/post-quecast";function ik(e){var t;return e.channelId&&e.libId===iO&&e.action&&"string"==typeof(t=e.action).type&&"number"==typeof t.timestamp}function iT(e){return!e.data.private}function iR(e,t){return e.data.channelId===t}function iA(e){return e.data.action}var iL=function(){function e(){}return e.make=function(e){var t;return e.host===e.coordinatorHost&&(null===(t=e.coordinatorHost[iO])||void 0===t?void 0:t.callbackConnector)?e.coordinatorHost[iO].callbackConnector:new iD({senderHost:e.coordinatorHost,listenerHost:e.host})},e}(),iP=function(){function e(e){this.coordinatorHost=e,this.callbacks=[]}return e.prototype.dispatch=function(e){var t=this;if(!ik(e))throw Error("Incorrect object type. Expected PostMessageData, but got "+e);this.callbacks.forEach(function(n){return n({data:e,source:t.coordinatorHost})})},e.prototype.addListener=function(e){this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter(function(t){return t!==e})},e}(),iD=function(){function e(e){this.options=e,this.map=new Map}return e.prototype.dispatch=function(e){if(!ik(e))throw Error("Incorrect object type. Expected PostMessageData, but got "+e);this.options.senderHost.postMessage(e,"*")},e.prototype.addListener=function(e){var t=function(t){t&&t.source&&t.data&&ik(t.data)&&e(t)};this.map.set(e,t),this.options.listenerHost.addEventListener("message",t)},e.prototype.removeListener=function(e){var t=this.map.get(e);this.options.listenerHost.removeEventListener("message",t),this.map.delete(e)},e}(),iV=function(){function e(e){this.callbacks=[],this.history=[],this.channelId=e.channelId,this.connector=iL.make(e),this.setupActions(),this.setupConnection()}return e.prototype.setupActions=function(){this.getHistory(),this.listenEvent()},e.prototype.getHistory=function(){var e=this,t=function(n){if(iR(n,e.channelId)&&n.data.private){var i=iA(n);(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.some(function(t){return e.type===t})})(i,i_.connected)&&(e.connector.removeListener(t),e.handleActions.apply(e,i.history))}};this.connector.addListener(t)},e.prototype.listenEvent=function(){var e=this;this.connector.addListener(function(t){if(iR(t,e.channelId)&&iT(t)){var n=iA(t);e.handleActions(n)}})},e.prototype.handleActions=function(){for(var e,t=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];(e=this.history).push.apply(e,n),n.forEach(function(e){return t.callbacks.forEach(function(t){return t(e)})})},e.prototype.setupConnection=function(){this.connector.dispatch({action:{type:i_.connect,timestamp:Date.now()},channelId:this.channelId,private:!0,libId:iO})},e.prototype.addListener=function(e){this.history.forEach(function(t){return e(t)}),this.callbacks.push(e)},e.prototype.removeListener=function(e){this.callbacks=this.callbacks.filter(function(t){return t!==e})},e}(),ix=function(){function e(e){void 0===e&&(e={});var t=iI(iI({},iE),e);this.channelId=t.channelId,this.connector=iL.make(t)}return e.prototype.dispatch=function(e){this.connector.dispatch({action:iI(iI({},e),{timestamp:Date.now()}),channelId:this.channelId,private:!0,libId:iO})},e}(),iN=function(){function e(e){void 0===e&&(e={});var t=iI(iI({},iE),e);this.transmitter=new ix(t),this.receiver=new iV(t)}return e.prototype.dispatch=function(e){this.transmitter.dispatch(e)},e.prototype.addListener=function(e){this.receiver.addListener(e)},e.prototype.removeListener=function(e){this.receiver.removeListener(e)},e}(),ij=function(){function e(e,t){this.channelId=e,this.connectors=new Map,this.history=[],this.connectors.set(t,t[iO].callbackConnector)}return e.prototype.addConnection=function(e){this.ensureConnector(e).dispatch({action:this.createConnectedAction(),private:!0,channelId:this.channelId,libId:iO})},e.prototype.createConnectedAction=function(){return{type:i_.connected,history:this.history,timestamp:Date.now()}},e.prototype.broadcast=function(e){var t=this;this.history.push(e),this.connectors.forEach(function(n){n.dispatch({action:e,channelId:t.channelId,libId:iO})})},e.prototype.ensureConnector=function(e){return this.connectors.has(e)||this.connectors.set(e,new iD({senderHost:e,listenerHost:e})),this.connectors.get(e)},e}(),iM=function(){function e(e){this.coordinatorHost=e,this.channels=new Map,this.callbackConnector=new iP(e),this.postMessageConnector=new iD({senderHost:e,listenerHost:e})}return e.prototype.init=function(){var e=this,t=function(t){iT(t)||(e.handleConnect(t),e.handleBroadcast(t))};this.callbackConnector.addListener(t),this.postMessageConnector.addListener(t)},e.prototype.handleConnect=function(e){(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.some(function(t){return e.data.action.type===t})})(e,i_.connect)&&this.ensureChannel(e.data.channelId).addConnection(e.source)},e.prototype.handleBroadcast=function(e){Object.values(i_).some(function(t){return e.data.action.type===t})||this.ensureChannel(e.data.channelId).broadcast(e.data.action)},e.prototype.ensureChannel=function(e){return this.channels.has(e)||this.channels.set(e,new ij(e,this.coordinatorHost)),this.channels.get(e)},e}();let iU=class{constructor(e){this.window=e,this.history=new Map;let{channelId:t,coordinatorName:n}=this.getSettings();(function(e){if(void 0===e&&(e=window),!e[iO]){var t=new iM(e);t.init(),e[iO]=t}})(),this.communicator=new iN({channelId:t||"default",coordinatorHost:e[n]||top})}emit(e){this.communicator.dispatch(e)}on(e,t){this.communicator.addListener(n=>this.run(n,e,t))}once(e,t){this.communicator.addListener(n=>this.runOnce(n,e,t))}getSettings(){return this.window["@wikia/post-quecast-settings"]||{}}run(e,t,n){this.ofType(e,t)&&n(e)}runOnce(e,t,n){let i=t.category+" "+t.name;this.ofType(e,t)&&(this.history.has(i)||(this.history.set(i,!0),n(e)))}ofType(e,t){return e.category===t.category&&e.name===t.name||e.type===t.category+" "+t.name}};iU=to([t$(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(F="undefined"!=typeof Window&&Window)?F:Object])],iU);let iG={CONSENT_READY:{category:"[AdEngine OptIn]",name:"set opt in"},IDENTITY_READY:{category:"[IdentityEngine]",name:"Identity ready"},IDENTITY_PARTNER_DATA_OBTAINED:{category:"[AdEngine]",name:"Identity partner data obtained"},AGE_GATE_DATA:{name:"Age gate result",category:"[Identity]"},AUDIGENT_SEGMENT_LIBRARY_LOADED:{name:"Audigent segment library loaded"},AUDIGENT_MATCHES_LIBRARY_LOADED:{name:"Audigent matches library loaded"},AUDIGENT_SEGMENTS_READY:{name:"Audigent segments ready"},EYEOTA_STARTED:{name:"Eyeota started"},EYEOTA_FAILED:{name:"Eyeota loading failed"},LIVE_CONNECT_STARTED:{name:"LiveConnect started"},LIVE_CONNECT_CACHED:{name:"LiveConnect data cached"},LIVE_CONNECT_RESPONDED_UUID:{name:"LiveConnect responded with UUID"}};var iF={};function iW(e,t){return Object.keys(t).forEach(function(n){"default"===n||"__esModule"===n||e.hasOwnProperty(n)||Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}})}),e}function iH(e,t,n,i){Object.defineProperty(e,t,{get:n,set:i,enumerable:!0,configurable:!0})}iH(iF,"utils",()=>iB);var iB={},i$={};function iq(e){return new Promise(t=>setTimeout(()=>t(),e))}iH(i$,"delay",()=>iq);var iQ={};function iY(){let e=new URLSearchParams(window.location.search.substring(1));return e.get("adengine_debug")?e.get("adengine_debug"):e.get("identity_debug")}iH(iQ,"getDebugGroup",()=>iY);var iz={};iH(iz,"localStorageHelper",()=>iK);class iK{constructor(e,t=6e4){this.key=e,this.ttlInMilliseconds=t}expired(e){return!e||e<Date.now()}getObjectToStore(e){return{data:e,ttl:Date.now()+this.ttlInMilliseconds}}parseStoredValue(e){let t=JSON.parse(e);return this.expired(t?.ttl)?null:t.data}get(){let e=localStorage.getItem(this.key);return e?this.parseStoredValue(e):null}set(e){let t=this.getObjectToStore(e);localStorage.setItem(this.key,JSON.stringify(t))}}var iJ={};iH(iJ,"lock",()=>iZ),iH(iJ,"release",()=>i0);let iX=new iK("instant-config-lock",1e3);function iZ(){return"lock"===iX.get()||(iX.set("lock"),!1)}function i0(){iX.set(null)}var i1={};iH(i1,"getTimeDelta",()=>i4),iH(i1,"logger",()=>i5),iH(i1,"warner",()=>i8);let i2=iY()||"",i6=i2.split(","),i3=Date.now();function i4(){let e=Date.now(),t=window.performance?.timeOrigin??i3;return((e-t)/1e3).toFixed(4)}function i5(e,...t){""!==i2&&("1"===i2||-1!==i6.indexOf(e))&&window.console.info(`${i4()}s		 ${e}`,t)}function i8(e,...t){""!==i2&&("1"===i2||-1!==i6.indexOf(e))&&window.console.warn(e,t)}iW(iB,i$),iW(iB,iQ),iW(iB,iz),iW(iB,iJ),iW(iB,i1);var i9={},i7={};iH(i7,"EmptyInstantConfigCacheStorage",()=>oe);class oe{get(e){}set(e){}}var ot={};iH(ot,"InstantConfigInterpreter",()=>oS);var on={},oi={};iH(oi,"BrowserMatcher",()=>op);var oo={};iH(oo,"extractNegation",()=>oh);var os={},or={};iH(or,"negativePrefix",()=>oa),iH(or,"cacheSuffix",()=>oc),iH(or,"samplingSeparator",()=>ol),iH(or,"worldWide",()=>ou),iH(or,"precision",()=>od);let oa="non-",oc="-cached",ol="/",ou="XX",od=1e6;function oh(e){return e.startsWith(oa)?{value:e.replace(oa,""),negated:!0}:{value:e,negated:!1}}iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,{}),iW(os,or);class op{constructor(e){this.currentBrowser=e?.toLowerCase()}isValid(e=[]){let t=e.map(e=>e.toLowerCase()).map(e=>oh(e));return 0===e.length||!this.currentBrowser||!this.isCurrentNegated(this.currentBrowser,t)&&t.some(e=>this.currentBrowser.includes(e.value)!==e.negated)}isCurrentNegated(e,t){return t.some(t=>e.includes(t.value)&&t.negated)}}var of={};iH(of,"DeviceMatcher",()=>og);class og{constructor(e){this.currentDevice=e}isValid(e=[]){let t=e.map(e=>e.toLowerCase()).map(e=>oh(e));return 0===t.length||!this.currentDevice||!this.isCurrentNegated(this.currentDevice,t)&&t.some(e=>e.value===this.currentDevice!==e.negated)}isCurrentNegated(e,t){return t.some(t=>e.includes(t.value)&&t.negated)}}var ov={};iH(ov,"DomainMatcher",()=>om);class om{isValid(e=[]){return 0===e.length||e.some(e=>window.location.hostname.includes(e))}}var oy={};iH(oy,"RegionMatcher",()=>ow);class ow{constructor(e){this.geo=e}isValid(e=[],t){let n=this.filterOutInvalidRegions(e);return t?t(n):this.isProperGeo(n)}getCountryCode(){return this.geo?.country}getRegionCode(){return this.geo?.region}getContinentCode(){return this.geo?.continent}isProperGeo(e=[]){return!!(e&&e.indexOf&&!this.isGeoExcluded(e)&&(this.isProperContinent(e)||this.isProperCountry(e)||this.isProperRegion(e)))}filterOutInvalidRegions(e){return e.filter(e=>!e.includes(ol)).filter(e=>!e.includes(oc))}isProperCountry(e){return!!(e&&e.indexOf&&(e.indexOf(this.getCountryCode())>-1||this.isSampledForGeo(e,this.getCountryCode())))}isProperRegion(e){let t=`${this.getCountryCode()}-${this.getRegionCode()}`;return!!(e&&e.indexOf&&(e.indexOf(t)>-1||this.isSampledForGeo(e,t)))}containsContinent(e){let t=`${ou}-${this.getContinentCode()}`;return e.indexOf(t)>-1||this.isSampledForGeo(e,t)}containsWorldWide(e){return e.indexOf(ou)>-1||this.isSampledForGeo(e,ou)}isProperContinent(e){return!!(e&&e.indexOf&&(this.containsWorldWide(e)||this.containsContinent(e)))}isGeoExcluded(e){return!!(e.indexOf(`${oa}${this.getCountryCode()}`)>-1||e.indexOf(`${oa}${this.getCountryCode()}-${this.getRegionCode()}`)>-1||e.indexOf(`${oa}${ou}-${this.getContinentCode()}`)>-1)}hasSampling(e){return t=>0!==t.indexOf(oa)&&t.indexOf(e+ol)>-1}getSamplingLimits(e){let[,t]=e.split(ol);return Math.round(parseFloat(t=t.replace(oc,""))*od)||0}isSampledForGeo(e,t){let n=e.filter(this.hasSampling(t));if(0===n.length)return!1;let i=Math.round(Math.random()*(100*od))||0;return n.map(e=>this.getSamplingLimits(e)).some(e=>i<e)}}var ob={};iH(ob,"SamplingCacheManager",()=>oC);class oC{constructor(e){this.cacheStorage=e,this.precision=1e6}apply(e,t,n){let i=this.cacheStorage.get(e);if(void 0!==i)return i.result;let o=n();if("number"!=typeof t.sampling||!1===o)return o;let s=this.getSamplingResult(t.sampling),r={name:e,result:s,withCookie:!!t.samplingCache,group:s?"B":"A",limit:+(s?t.sampling:100-t.sampling).toFixed(6)};return this.cacheStorage.set(r),s}getSamplingResult(e){let t=Math.round(100*Math.random()*this.precision),n=Math.round(e*this.precision);return n>t}}iW(on,oi),iW(on,of),iW(on,ov),iW(on,oo),iW(on,oy),iW(on,ob);class oS{constructor(e=new op,t=new og,n=new om,i=new ow,o=new oe){this.browserMatcher=e,this.deviceMatcher=t,this.domainMatcher=n,this.regionMatcher=i,this.instantConfigCacheService=o,this.logGroup="instant-config-interpreter",this.configResponse={},this.samplingCache=new oC(o)}init(e,t={},n){return this.configResponse={...t,...e},this.regionValidationPredicate=n,this}getValues(){return iB.logger(this.logGroup,"get values called with",this.configResponse),Object.keys(this.configResponse).map(e=>({key:e,value:this.configResponse[e]})).map(({key:e,value:t})=>Array.isArray(t)?{key:e,value:this.getValue(e,t)}:{key:e,value:t}).reduce((e,t)=>({...e,[t.key]:t.value}),{})}getValue(e,t){let n=t.find((t,n)=>this.samplingCache.apply(`${e}-${n}`,t,this.getPredicate(t)));if(void 0!==n)return n.value}getPredicate(e){return()=>this.browserMatcher.isValid(e.browsers)&&this.deviceMatcher.isValid(e.devices)&&this.domainMatcher.isValid(e.domains)&&this.regionMatcher.isValid(e.regions,this.regionValidationPredicate)}}var oI={};async function oE(e,t=2e3){let n=new AbortController,i=setTimeout(()=>n.abort(),t),o=await fetch(e,{signal:n.signal});return clearTimeout(i),o}iH(oI,"InstantConfigLoader",()=>oT);let o_="instant-config-loader",oO="instantConfig",ok={b:"browsers",d:"devices",s:"sampling",c:"samplingCache",r:"regions",v:"value"};class oT{constructor(e,t=window){this.params=e,this.configPromise=null,this.storage=new iB.localStorageHelper(`instant-config-${e.appName}`,6e4),this.instantConfig=this.fromContainer(t)}async getConfig(){return this.instantConfig?this.instantConfig:(this.configPromise||(this.configPromise=this.fetchInstantConfig().then(e=>e??this.fetchFallbackConfig())),this.configPromise.then(e=>e))}async fetchInstantConfig(e=!1){let t=iB.lock();if(t&&!e)return await iq(500),this.fetchInstantConfig(!0);let n=this.params.instantConfigEndpoint??"https://services.fandom.com",i=this.params.instantConfigVariant??"icbm",o=this.params.appName,s=`${n}/${i}/api/config?app=${o}`;try{let e=this.storage.get();if(e)return iB.logger(o_,"instant config pulled from local storage",e),JSON.parse(e);let t=await oE(s,this.params.requestTimeout);if(!t.ok)return;let n=await t.json();return this.storage.set(JSON.stringify(n)),iB.release(),iB.logger(o_,"instant config fetched",n),n}catch(e){iB.warner(o_,"could not fetch instant config",e),iB.release();return}}async fetchFallbackConfig(){iB.logger(o_,"Fetching fallback config");let e=this.params.instantConfigFallbackEndpoint;if(void 0===e)return{};try{iB.logger(o_,e);let t=await oE(e,this.params.requestTimeout);if(!t.ok)return{};let n=await t.json();return iB.logger(o_,"fallback config fetched",n),n}catch(e){return iB.warner(o_,"could not fetch fallback config",e),{}}}fromContainer(e){let t=e[oO];return"object"!=typeof t||t._ready||(Object.keys(t).forEach(e=>{let n=t[e];Array.isArray(n)&&(t[e]=n.map(e=>Object.fromEntries(Object.entries(e).map(([e,t])=>[ok[e]?ok[e]:e,t]))))}),t._ready=!0,e[oO]=t),t}}var oR={};iH(oR,"InstantConfigOverrider",()=>oL);let oA=["InstantGlobals","icbm"];class oL{override(e,t){return[...e.keys()].filter(e=>oA.some(t=>e.startsWith(`${t}.`)||e.startsWith(`${t}__`))).map(e=>{let[,t]=e.split(".").map(e=>e.split("__")).flat();return{paramKey:e,key:t}}).map(({paramKey:t,key:n})=>({key:n,value:this.parseValue(e.get(t))})).map(({key:e,value:t})=>({key:e,value:e.startsWith("wg")?t:this.wrapValueInXXRegions(t)})).reduce((e,{key:t,value:n})=>({...e,[t]:n}),t)}parseValue(e){if("true"===e||"false"===e)return"true"===e;let t=parseInt(e,10);if(e===`${t}`)return t;try{return JSON.parse(e)}catch(t){return e||null}}wrapValueInXXRegions(e){return[{value:e,regions:["XX"]}]}}iW(i9,i7),iW(i9,ot),iW(i9,oI),iW(i9,oR),iW(i9,on),iW(iF,i9),iW(iF,os);let oP=class{constructor(e,t,n,i,o){this.device=e,this.browser=t,this.platform=n,this.geo=i,this.logger=o}init(e={}){return ta(this,void 0,void 0,function*(){let t=this.platform.get(),n=this.geo.get(),i=new iF.InstantConfigLoader({appName:t}),o=new iF.InstantConfigInterpreter(new iF.BrowserMatcher(this.browser.getBrowser()),new iF.DeviceMatcher(this.device.getDeviceType()),new iF.DomainMatcher,new iF.RegionMatcher(n)),s=yield i.getConfig();s=new(0,iF.InstantConfigOverrider)().override(nh.getURLSearchParams(),s);let r=o.init(s,e);return this.repository=r.getValues(),this.logger.info("instantiated with",this.repository),this})}get(e,t){return e in this.repository&&void 0!==this.repository[e]?this.repository[e]:t}};oP=to([t$(),ts(0,tH(nd)),ts(1,tH(t6)),ts(2,tH(nw)),ts(3,tH(nv)),ts(4,tq(nf,np,"InstantConfig")),tr("design:paramtypes",["function"==typeof(W=void 0!==nd&&nd)?W:Object,"function"==typeof(H=void 0!==t6&&t6)?H:Object,"function"==typeof(B=void 0!==nw&&nw)?B:Object,"function"==typeof($=void 0!==nv&&nv)?$:Object,"function"==typeof(q=void 0!==nf&&nf)?q:Object])],oP);let oD=class{get trackingAllowed(){return this._trackingAllowed}set trackingAllowed(e){this._trackingAllowed=e}constructor(e,t,n,i){this.communicationService=e,this.consentProviderFactory=t,this.logger=n,this.instantConfigService=i,this._trackingAllowed=!1}init(){var e;let t=this.instantConfigService.get("icFandom1TEnabled",!1);this.consentProvider=this.consentProviderFactory.get(t),null===(e=this.consentProvider)||void 0===e||e.then(e=>{this.logger.info("Sending consents: ",e),this.sendConsentsToAdEngine(e)})}sendConsentsToAdEngine(e){this.communicationService.emit(new iS(iG.CONSENT_READY,e))}};oD=to([t$(),ts(0,tH(iU)),ts(1,tH(iC)),ts(2,tq(nf,np,"OptInService")),ts(3,tH(oP)),tr("design:paramtypes",["function"==typeof(Q=void 0!==iU&&iU)?Q:Object,"function"==typeof(Y=void 0!==iC&&iC)?Y:Object,"function"==typeof(z=void 0!==nf&&nf)?z:Object,"function"==typeof(K=void 0!==oP&&oP)?K:Object])],oD);let oV=class{constructor(e,t,n,i,o,s){this.logger=e,this.httpClient=t,this.skin=n,this.optInService=i,this.window=o,this.wikiConfig=s,this.dataWarehouseUrl="https://beacon.wikia-services.com/__track/special/identityinfo"}send(e){this.sendEvent(e,this.dataWarehouseUrl)}sendEvent(e,t){let n=Object.assign(Object.assign(Object.assign({},e),this.getTimeBasedParams()),this.getTrackingParams()),i=this.buildDataWarehouseUrl(n,t);i&&this.httpClient.get(i)}getTrackingParams(){var e,t,n,i,o,s,r,a,c,l,u,d,h;return{session_id:null===(t=null===(e=this.window.fandomContext)||void 0===e?void 0:e.tracking)||void 0===t?void 0:t.sessionId,pv_number:null===(i=null===(n=this.window.fandomContext)||void 0===n?void 0:n.tracking)||void 0===i?void 0:i.pvNumber,pv_number_global:null===(s=null===(o=this.window.fandomContext)||void 0===o?void 0:o.tracking)||void 0===s?void 0:s.pvNumberGlobal,pv_unique_id:null===(a=null===(r=this.window.fandomContext)||void 0===r?void 0:r.tracking)||void 0===a?void 0:a.pvUID,beacon:null===(l=null===(c=this.window.fandomContext)||void 0===c?void 0:c.tracking)||void 0===l?void 0:l.beaconId,ua:null===(u=this.window.navigator)||void 0===u?void 0:u.userAgent,c:this.wikiConfig.get("wgCityId")||"unknown",ck:this.wikiConfig.get("dsSiteKey")||"unknown",lc:this.wikiConfig.get("wgUserLanguage")||"unknown",s:this.skin.get(),u:this.optInService.trackingAllowed?this.wikiConfig.get("wgUserId")||0:-1,a:(null===(h=null===(d=this.window.fandomContext)||void 0===d?void 0:d.page)||void 0===h?void 0:h.articleId)||-1,x:this.wikiConfig.get("wgDBname")||"unknown",n:this.wikiConfig.get("wgNamespaceNumber")||-1}}getTimeBasedParams(){return{cb:Math.floor(99999*Math.random()),url:document.URL}}buildDataWarehouseUrl(e,t){if(!t){this.logger.error("Error building DWH tracking URL");return}let n=new URLSearchParams(e);return n.sort(),`${t}?${n.toString()}`}};oV=to([tB(),ts(0,tq(nf,np,"DataWarehouseService")),ts(1,tH(nm)),ts(2,tH(nC)),ts(3,tH(oD)),ts(4,tH(t0)),ts(5,tH(nE)),tr("design:paramtypes",["function"==typeof(J=void 0!==nf&&nf)?J:Object,"function"==typeof(X=void 0!==nm&&nm)?X:Object,"function"==typeof(Z=void 0!==nC&&nC)?Z:Object,"function"==typeof(ee=void 0!==oD&&oD)?ee:Object,"function"==typeof(et="undefined"!=typeof Window&&Window)?et:Object,"function"==typeof(en=void 0!==nE&&nE)?en:Object])],oV),function(e){e[e.identity=0]="identity"}(ei||(ei={}));let ox=class{constructor(e,t){this.logger=e,this.identityEventSender=t}track(e,t){e===ei.identity?this.identityEventSender.send(t):this.logger.info("Invalid event type to track")}};ox=to([tB(),ts(0,tq(nf,np,"DataWarehouseService")),ts(1,tH(oV)),tr("design:paramtypes",["function"==typeof(eo=void 0!==nf&&nf)?eo:Object,"function"==typeof(es=void 0!==oV&&oV)?es:Object])],ox);let oN=class{constructor(e){this.cookiesManager=e}get(e){return this.cookiesManager.get(e)}set(e,t){let{value:n,domain:i,expiresMS:o}=t,s=new Date(new Date().getTime()+o);this.cookiesManager.set(e,n.toString(),{domain:i,expires:s})}remove(e){this.cookiesManager.remove(e)}};oN=to([tB(),ts(0,tH(tZ)),tr("design:paramtypes",["function"==typeof(er="undefined"!=typeof CookiesManager&&CookiesManager)?er:Object])],oN);let oj=class{constructor(e){this.window=e}get(e){return this.window.fandomContext.tracking[e]}set(e,t){this.window.fandomContext&&this.window.fandomContext.tracking||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{tracking:{}})),this.window.fandomContext.tracking[e]=t.value}remove(e){try{delete this.window.fandomContext.tracking[e]}catch(e){}}};oj=to([tB(),ts(0,tH(t0)),tr("design:paramtypes",["function"==typeof(ea="undefined"!=typeof Window&&Window)?ea:Object])],oj);let oM=class{constructor(e){this.cookiesManager=e}getNextNumberFromCookie(e){let t=parseInt(this.cookiesManager.get(e));return Number.isNaN(t)?1:t+1}};oM=to([tB(),ts(0,tH(tZ)),tr("design:paramtypes",["function"==typeof(ec="undefined"!=typeof CookiesManager&&CookiesManager)?ec:Object])],oM);let oU=class{constructor(e,t,n,i,o,s,r){this.windowRepository=e,this.cookieRepository=t,this.uuid=n,this.beaconGenerator=i,this.pageViewNumberGenerator=o,this.window=s,this.wikiConfig=r}set(e,t){this.windowRepository.set(e,t),this.cookieRepository.set(e,t)}remove(e){this.windowRepository.remove(e),this.cookieRepository.remove(e)}setup(e){let t=nI.extract(e);this.windowRepository.set("pvUID",{domain:e,expiresMS:18e5,value:this.wikiConfig.get("pvUID")||this.window.pvUID||this.uuid()});let n=this.cookieRepository.get("wikia_beacon_id")||this.cookieRepository.get("beaconId"),i={domain:t,expiresMS:15552e6,value:n||this.beaconGenerator.generate()};this.windowRepository.set("beaconId",i),this.cookieRepository.set("wikia_beacon_id",i);let o=this.cookieRepository.get("sessionId"),s={domain:t,expiresMS:18e5,value:o||this.uuid()};this.set("sessionId",s),this.set("pvNumber",{domain:e,expiresMS:18e5,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumber")}),this.set("pvNumberGlobal",{domain:t,expiresMS:18e5,value:this.pageViewNumberGenerator.getNextNumberFromCookie("pvNumberGlobal")})}clear(){this.remove("beaconId"),this.remove("sessionId"),this.remove("pvNumber"),this.remove("pvNumberGlobal")}};oU=to([t$(),ts(0,tH(oj)),ts(1,tH(oN)),ts(2,tH(t1)),ts(3,tH(nk)),ts(4,tH(oM)),ts(5,tH(t0)),ts(6,tH(nE)),tr("design:paramtypes",["function"==typeof(el=void 0!==oj&&oj)?el:Object,"function"==typeof(eu=void 0!==oN&&oN)?eu:Object,Function,"function"==typeof(ed=void 0!==nk&&nk)?ed:Object,"function"==typeof(eh=void 0!==oM&&oM)?eh:Object,"function"==typeof(ep="undefined"!=typeof Window&&Window)?ep:Object,"function"==typeof(ef=void 0!==nE&&nE)?ef:Object])],oU);let oG=class{constructor(e,t,n,i){this.window=e,this.logger=t,this.context=n,this.cookieRepository=i,this.createPartnersContext()}createPartnersContext(){this.window.fandomContext&&this.window.fandomContext.partners||(this.window.fandomContext=Object.assign(Object.assign({},this.window.fandomContext),{partners:{}}))}setIsCoppaSubjectInContext(e){this.coppaSubject=e,this.window.fandomContext.partners.directedAtChildren=e,this.window.fandomContext.partners.blockthrough={directedAtChildren:e}}isCoppaSubject(){return void 0===this.coppaSubject?this.resolveCoppaStatus():this.coppaSubject}resolveCoppaStatus(){var e,t;let n=!!(null===(t=null===(e=this.context.get())||void 0===e?void 0:e.targeting)||void 0===t?void 0:t.directedAtChildren);if(!n)return this.setIsCoppaSubjectInContext(!1),!1;try{let e=this.cookieRepository.get("ag"),t="1"!==e;return this.setIsCoppaSubjectInContext(t),t}catch(e){this.logger.error("Error while reading age gate cookie")}}};oG=to([t$(),ts(0,tH(t0)),ts(1,tq(nf,np,"CoppaSubject")),ts(2,tH(t2)),ts(3,tH(oN)),tr("design:paramtypes",["function"==typeof(eg="undefined"!=typeof Window&&Window)?eg:Object,"function"==typeof(ev=void 0!==nf&&nf)?ev:Object,"function"==typeof(em=void 0!==t2&&t2)?em:Object,"function"==typeof(ey=void 0!==oN&&oN)?ey:Object])],oG);let oF=class{constructor(e,t,n){this.dataWarehouse=e,this.window=t,this.logger=n}activateTracking(){if(!this.isEnabled()){this.logger.info("Hem Tracking is disabled");return}let e=this.extractHEMs();Object.keys(e).forEach(t=>{e[t]&&this.dataWarehouse.track(ei.identity,{partner_name:"MediaWiki-"+t,partner_identity_id:e[t]})})}isEnabled(){var e,t,n;return(null===(n=null===(t=null===(e=this.window.ads)||void 0===e?void 0:e.context)||void 0===t?void 0:t.opts)||void 0===n?void 0:n.userEmailHashes)&&this.window.ads.context.opts.userEmailHashes.length>0}extractHEMs(){let[e,t,n]=this.window.ads.context.opts.userEmailHashes;return{md5:e,sha1:t,sha256:n}}};oF=to([tB(),ts(0,tH(ox)),ts(1,tH(t0)),ts(2,tq(nf,np,"HemTracking")),tr("design:paramtypes",["function"==typeof(ew=void 0!==ox&&ox)?ew:Object,"function"==typeof(eb="undefined"!=typeof Window&&Window)?eb:Object,"function"==typeof(eC=void 0!==nf&&nf)?eC:Object])],oF);let oW=class{constructor(e,t,n,i){this.platform=t,this.window=n,this.logger=i,this.enabled=!1,this.endpoint=`${e.get()}adeng/api/identity/metrics`}init(e){var t;let n=e.get("icMonitorTrafficThreshold",{identity:0});this.enabled=!!("object"==typeof n&&!Array.isArray(n)&&null!==n)&&(null==n?void 0:n.identity)>0&&n.identity>=100*Math.random(),this.logger.info(`Metric reporter enabled: ${this.enabled}, threshold:`,n),this.enabled&&("complete"===this.window.document.readyState?this.sendPerformanceMetrics():null===(t=this.window)||void 0===t||t.addEventListener("load",()=>this.sendPerformanceMetrics()))}send(e,t=0){if(!this.enabled)return;let n=new URL(this.endpoint);n.searchParams.set("app",this.platform.get()),n.searchParams.set("action",e);let i=t>0?t:this.logger.getTimeDelta();n.searchParams.set("duration",Math.round(i).toString()),fetch(n,{mode:"no-cors"})}sendPerformanceMetrics(){let e=this.window.performance.getEntriesByType("navigation");e.length>0&&(this.send("document_content_loaded",e[0].domContentLoadedEventEnd),this.send("document_load_time",e[0].loadEventEnd))}};oW=to([t$(),ts(0,tH(nb)),ts(1,tH(nw)),ts(2,tH(t0)),ts(3,tq(nf,np,"MetricReporterService")),tr("design:paramtypes",["function"==typeof(eS=void 0!==nb&&nb)?eS:Object,"function"==typeof(eI=void 0!==nw&&nw)?eI:Object,"function"==typeof(eE="undefined"!=typeof Window&&Window)?eE:Object,"function"==typeof(e_=void 0!==nf&&nf)?e_:Object])],oW),function(e){e.LOCAL="local",e.IDENTITY_STORAGE="identity_storage"}(eO||(eO={})),(ek||(ek={})).IDENTITY="identity";let oH=class{constructor(e,t,n,i){this.logger=e,this.uuid=t,this.storage=n,this.serviceBaseUrl=i,this.logGroup="identity-storage",this.IdentityStorageKey="identity",this.ISUrl=this.serviceBaseUrl.get()+"identity-storage/"}fetchData(){return ta(this,void 0,void 0,function*(){let e=new AbortController,t=setTimeout(()=>e.abort(),1e3);return fetch(this.ISUrl,{mode:"cors",credentials:"include",signal:e.signal}).then(e=>(clearTimeout(t),200===e.status||202===e.status)?e.json():this.createFallbackResponse()).catch(e=>(this.logger.info(this.logGroup,"Loading Identity LocalStorage data failed",e),this.createFallbackResponse()))})}postData(e){return ta(this,void 0,void 0,function*(){return fetch(this.ISUrl+"identity",{credentials:"include",mode:"cors",headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify({ppid:e.ppid})}).then(e=>e.json())})}getLocalData(){return this.storage.getItem(this.IdentityStorageKey)}setLocalData(e){this.storage.setItem(this.IdentityStorageKey,e)}createFallbackResponse(){return{timestamp:Date.now(),over18:!1,synced:!1,ppid:this.uuid()}}};oH=to([t$(),ts(0,tq(nf,np,"UserIdentity")),ts(1,tH(t1)),ts(2,tH(nS)),ts(3,tH(nb)),tr("design:paramtypes",["function"==typeof(eT=void 0!==nf&&nf)?eT:Object,Function,"function"==typeof(eR=void 0!==nS&&nS)?eR:Object,"function"==typeof(eA=void 0!==nb&&nb)?eA:Object])],oH);let oB=class{constructor(e,t,n,i,o){this.storage=e,this.logger=t,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageClient=o}get(){return ta(this,void 0,void 0,function*(){let e=yield this.getLocalData();return(e&&!e.synced&&this.setRemote(e),!e||this.isDeprecated(e))?this.getRemote():(this.setIdentityContextVariables(e),e)})}setRemote(e){return ta(this,void 0,void 0,function*(){try{yield this.identityStorageClient.postData(e);let t=Object.assign(Object.assign({},this.identityStorageClient.getLocalData()),{synced:!0});return this.setIdentityContextVariables(t),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},t),{timestamp:Date.now()})),t}catch(e){this.logger.error("Updating Identity LocalStorage data failed")}})}isDeprecated(e){let t=this.instantConfigService.get("icIdentityTtl",6048e5),n=Date.now()-t;return!e.timestamp||e.timestamp-n<0}getLocalData(){return ta(this,void 0,void 0,function*(){let e=yield this.identityStorageClient.getLocalData();if(!e){let t=this.getLocalPPID()||this.getAdmsPPID();t&&(e=yield this.migrateDeprecatedIdentity(t))}return e})}migrateDeprecatedIdentity(e){return ta(this,void 0,void 0,function*(){let t=yield this.setRemote({ppid:e,synced:!1});return this.clearDeprecatedLocalPpid(),t})}getAdmsPPID(){var e,t;let n=this.storage.getItem("silver-surfer-active-data-v2");return null===(t=null===(e=null==n?void 0:n.IDENTITY)||void 0===e?void 0:e[0].payload)||void 0===t?void 0:t.identityToken}getLocalPPID(){return this.storage.getItem("ppid")}clearDeprecatedLocalPpid(){this.storage.removeItem("ppid")}getRemote(){return ta(this,void 0,void 0,function*(){let e=yield this.identityStorageClient.fetchData();return this.setIdentityContextVariables(e),this.identityStorageClient.setLocalData(Object.assign(Object.assign({},e),{timestamp:Date.now()})),e})}setIdentityContextVariables(e){e.over18&&this.windowContextRepository.set("over_18",{value:"1"})}};oB=to([t$(),ts(0,tH(nS)),ts(1,tq(nf,np,"UserIdentity")),ts(2,tH(oj)),ts(3,tH(oP)),ts(4,tH(oH)),tr("design:paramtypes",["function"==typeof(eL=void 0!==nS&&nS)?eL:Object,"function"==typeof(eP=void 0!==nf&&nf)?eP:Object,"function"==typeof(eD=void 0!==oj&&oj)?eD:Object,"function"==typeof(eV=void 0!==oP&&oP)?eV:Object,"function"==typeof(ex=void 0!==oH&&oH)?ex:Object])],oB);let o$=class{constructor(e,t){this.logger=e,this.identityStorageService=t}get(){return ta(this,void 0,void 0,function*(){let e=yield this.identityStorageService.get();return this.logger.info(e),e.ppid})}};o$=to([t$(),ts(0,tq(nf,np,"UserIdentity")),ts(1,tH(oB)),tr("design:paramtypes",["function"==typeof(eN=void 0!==nf&&nf)?eN:Object,"function"==typeof(ej=void 0!==oB&&oB)?ej:Object])],o$);let oq=class{constructor(e,t,n){this.logger=e,this.uuid=t,this.storage=n}get(){return Promise.resolve(this.storage.getItem("ppid")||this.generatePPID())}generatePPID(){this.logger.info("did not found a PPID in LocalStorage");let e=this.uuid();return this.storage.setItem("ppid",e),e}};oq=to([t$(),ts(0,tq(nf,np,"UserIdentity")),ts(1,tH(t1)),ts(2,tH(nS)),tr("design:paramtypes",["function"==typeof(eM=void 0!==nf&&nf)?eM:Object,Function,"function"==typeof(eU=void 0!==nS&&nS)?eU:Object])],oq);let oQ=class{constructor(e,t,n,i,o,s,r){this.dataWarehouse=e,this.logger=t,this.windowContextRepository=n,this.instantConfigService=i,this.identityStorageRepository=o,this.localStorageRepository=s,this.communicationService=r}getPPID(e){switch(this.logger.info("active strategy: ",e),e){case eO.IDENTITY_STORAGE:return this.identityStorageRepository;case eO.LOCAL:default:return this.localStorageRepository}}generatePPID(){return ta(this,void 0,void 0,function*(){try{let e=this.instantConfigService.get("icPpidRepository",eO.LOCAL),t=yield this.getPPID(e).get();this.dataWarehouse.track(ei.identity,{partner_name:"Google",partner_identity_id:t}),this.communicationService.emit(new iS(iG.IDENTITY_PARTNER_DATA_OBTAINED,{payload:{partnerName:"Google",partnerIdentityId:t}})),this.windowContextRepository.set("ppid",{value:t}),this.logger.info("Passed PPID to page-level targeting")}catch(e){this.logger.error("Setting up PPID has failed!",e)}})}setPpid(){return ta(this,void 0,void 0,function*(){this.instantConfigService.get("icPpid",!1)?(this.logger.info("enabled - awaiting setup"),yield this.generatePPID()):this.logger.info("disabled")})}};oQ=to([t$(),ts(0,tH(ox)),ts(1,tq(nf,np,"UserIdentity")),ts(2,tH(oj)),ts(3,tH(oP)),ts(4,tH(o$)),ts(5,tH(oq)),ts(6,tH(iU)),tr("design:paramtypes",["function"==typeof(eG=void 0!==ox&&ox)?eG:Object,"function"==typeof(eF=void 0!==nf&&nf)?eF:Object,"function"==typeof(eW=void 0!==oj&&oj)?eW:Object,"function"==typeof(eH=void 0!==oP&&oP)?eH:Object,"function"==typeof(eB=void 0!==o$&&o$)?eB:Object,"function"==typeof(e$=void 0!==oq&&oq)?e$:Object,"function"==typeof(eq=void 0!==iU&&iU)?eq:Object])],oQ);let oY={C0001:"necessary",C0002:"performance",C0003:"functional",C0004:"targeting",C0005:"social"};class oz{constructor(e,t){this.container=e;let n=e.OptanonWrapper;e.OptanonWrapper=()=>{t.resolve(),null==n||n()}}available(){return void 0!==this.container.OneTrust}ready(){var e,t;let n=this.container.OneTrust;return void 0!==this.container.OnetrustActiveGroups&&((null===(t=null===(e=n.GetDomainData())||void 0===e?void 0:e.ConsentModel)||void 0===t?void 0:t.Name)!=="opt-in"||n.IsAlertBoxClosed())}resolve(){var e;return null===(e=this.container.OnetrustActiveGroups)||void 0===e?void 0:e.split(",").map(e=>oY[e]).filter(e=>e).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:!0}),{})}}class oK{constructor(e,t){this.optIn=e,this.cookiesManager=t}available(){return void 0!==this.cookiesManager.get("OptanonConsent")}ready(){return!this.optIn||void 0!==this.cookiesManager.get("OptanonAlertBoxClosed")}resolve(){var e;let t=null===(e=decodeURIComponent(this.cookiesManager.get("OptanonConsent")))||void 0===e?void 0:e.match(/groups=([^&]+)/);return t&&t[1]?t[1].toUpperCase().split(",").map(e=>{let t=e.split(":");return"1"===t[1]?oY[t[0]]:void 0}).filter(e=>e).reduce((e,t)=>Object.assign(Object.assign({},e),{[t]:!0}),{}):{}}}let oJ={necessary:!0},oX={necessary:!0,performance:!0,functional:!0,targeting:!0,social:!0},oZ=class{constructor(e,t,n){var i,o;this.container=e,this.logger=t,this.cookiesManager=n;let s=this.cookiesManager.get("Geo");this.queue=e.consentCallbackQueue,this.optIn=!!s&&ng.includes(null===(o=null===(i=JSON.parse(decodeURIComponent(s)))||void 0===i?void 0:i.country)||void 0===o?void 0:o.toLowerCase()),void 0!==this.queue&&this.init()}resolve(){return!!this.wasResolved()||(this.ifAvailableThenResolveIfReady(this.apiConsentResolver)?(this.logger.info("API available, resolved?:",this.categories),this.wasResolved()):!!this.ifAvailableThenResolveIfReady(this.cookieConsentResolver)&&(this.logger.info("Cookies available, resolved?:",this.categories),this.wasResolved()))}wasResolved(){return void 0!==this.categories}init(){this.logger.info("Setting up with opt-in status:",this.optIn),this.apiConsentResolver=new oz(this.container,this),this.cookieConsentResolver=new oK(this.optIn,this.cookiesManager),this.resolve()||setTimeout(()=>this.resolveWithFallback(),5e3)}resolveWithFallback(){this.resolve()||(this.apiConsentResolver.available()||this.cookieConsentResolver.available()?(this.logger.info("Still waiting for consent resolve with available api:",this.apiConsentResolver.available(),"or cookie:",this.cookieConsentResolver.available()),setTimeout(()=>this.resolveWithFallback,5e3)):(this.categories=this.fallback(),this.logger.info("Unable to resolve consent, fallback to:",this.categories),this.resolveQueue()))}ifAvailableThenResolveIfReady(e){let t=e.available();return t&&e.ready()&&(this.categories=e.resolve(),this.resolveQueue()),t}checkAndRun(e,t,n){return this.logger.info("About to callback:",e,"for:",n,"with:",this.categories),(void 0===n||!!this.categories[n])&&(t(this.categories),!0)}resolveQueue(){this.flushQueue(),this.queue.push=(e,t,n)=>this.checkAndRun(e,t,n),this.container.consentCallback=(e,t,n)=>this.checkAndRun(e,t,n)}flushQueue(){let e=this.queue.queue;this.logger.info("Consent resolved, flushing queue of size:",e.length);for(let t=e.length-1;t>=0;t--){let n=e[t];this.checkAndRun(n.name,n.callback,n.category)&&e.splice(t,1)}}fallback(){return this.optIn?oJ:oX}};oZ=to([t$(),ts(0,tH(t0)),ts(1,tq(nf,np,"ConsentCallbackQueueHandler")),ts(2,tH(tZ)),tr("design:paramtypes",["function"==typeof(eQ="undefined"!=typeof Window&&Window)?eQ:Object,"function"==typeof(eY=void 0!==nf&&nf)?eY:Object,"function"==typeof(ez="undefined"!=typeof CookiesManager&&CookiesManager)?ez:Object])],oZ);let o0=class{constructor(e,t){this.window=e,this.logger=t,this.queue=[]}install(){this.logger.info("installing consent queue");let e=this;return this.window.consentCallbackQueue=this,this.window.consentCallback=(t,n,i)=>e.push(t,n,i),this}push(e,t,n){this.logger.warn("dialog not resolved, enqueued:",e),this.queue.push({name:e,callback:t,category:n})}};o0=to([t$(),ts(0,tH(t0)),ts(1,tq(nf,np,"ConsentCallbackQueue")),tr("design:paramtypes",["function"==typeof(eK="undefined"!=typeof Window&&Window)?eK:Object,"function"==typeof(eJ=void 0!==nf&&nf)?eJ:Object])],o0),tW.register(tZ,{useValue:function(e){return e&&e.__esModule?e.default:e}(tQ)}),tW.register(t1,{useValue:function(e,t,n){if(tz.randomUUID&&!t&&!e)return tz.randomUUID();e=e||{};let i=e.random||(e.rng||tJ)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=i[e];return t}return function(e,t=0){return(tX[e[t+0]]+tX[e[t+1]]+tX[e[t+2]]+tX[e[t+3]]+"-"+tX[e[t+4]]+tX[e[t+5]]+"-"+tX[e[t+6]]+tX[e[t+7]]+"-"+tX[e[t+8]]+tX[e[t+9]]+"-"+tX[e[t+10]]+tX[e[t+11]]+tX[e[t+12]]+tX[e[t+13]]+tX[e[t+14]]+tX[e[t+15]]).toLowerCase()}(i)}}),tW.register(t0,{useValue:window});let o1=class{constructor(e,t,n,i,o,s,r,a,c,l,u,d,h,p,f){this.geoCookie=e,this.ageGateHandler=t,this.communicationService=n,this.optInService=i,this.hemTrackingService=o,this.trackingContextSetupService=s,this.consentResolver=r,this.instantConfigService=a,this.window=c,this.logger=l,this.ppidProvider=u,this.consentCallbackQueue=d,this.consentCallbackQueueResolver=h,this.coppaSubject=p,this.metricReporterService=f}initializeAgeGateHandler(){return ta(this,void 0,void 0,function*(){return this.ageGateHandler.init(this.communicationService)})}updateGTMConsent(e){void 0===this.window.dataLayer&&(this.window.dataLayer=[]),this.window.dataLayer.push({event:"user-consent",consent:e.toString()})}initializeTracking(){return ta(this,void 0,void 0,function*(){this.logger.info("Setting up tracking"),this.optInService.trackingAllowed=!0,this.hemTrackingService.activateTracking(),yield this.ppidProvider.setPpid(),this.communicationService.emit(new iS(iG.IDENTITY_READY)),this.metricReporterService.send("ready")})}init(){return ta(this,void 0,void 0,function*(){yield this.geoCookie.setGeoCookieIfNotExist(),yield this.instantConfigService.init(),this.optInService.init(),this.metricReporterService.init(this.instantConfigService),this.metricReporterService.send("init")})}run(){this.logger.info("Starting identity engine v2.6.1");let e=this.window.location.hostname;this.communicationService.once(iG.CONSENT_READY,t=>{this.trackingContextSetupService.setup(e),this.consentResolver.resolve(t,()=>ta(this,void 0,void 0,function*(){this.updateGTMConsent(!0),yield this.initializeAgeGateHandler(),this.coppaSubject.resolveCoppaStatus(),yield this.initializeTracking()}),()=>{this.updateGTMConsent(!1),this.coppaSubject.resolveCoppaStatus(),this.optInService.trackingAllowed=!1,this.communicationService.emit(new iS(iG.IDENTITY_READY)),this.metricReporterService.send("ready"),this.logger.info("Tracking rejected")})})}};o1=to([t$(),ts(0,tH(ny)),ts(1,tH(nO)),ts(2,tH(iU)),ts(3,tH(oD)),ts(4,tH(oF)),ts(5,tH(oU)),ts(6,tH(nT)),ts(7,tH(oP)),ts(8,tH(t0)),ts(9,tq(nf,np,"IdentityEngine")),ts(10,tH(oQ)),ts(11,tH(o0)),ts(12,tH(oZ)),ts(13,tH(oG)),ts(14,tH(oW)),tr("design:paramtypes",["function"==typeof(eX=void 0!==ny&&ny)?eX:Object,"function"==typeof(eZ=void 0!==nO&&nO)?eZ:Object,"function"==typeof(e0=void 0!==iU&&iU)?e0:Object,"function"==typeof(e1=void 0!==oD&&oD)?e1:Object,"function"==typeof(e2=void 0!==oF&&oF)?e2:Object,"function"==typeof(e6=void 0!==oU&&oU)?e6:Object,"function"==typeof(e3=void 0!==nT&&nT)?e3:Object,"function"==typeof(e4=void 0!==oP&&oP)?e4:Object,"function"==typeof(e5="undefined"!=typeof Window&&Window)?e5:Object,"function"==typeof(e8=void 0!==nf&&nf)?e8:Object,"function"==typeof(e9=void 0!==oQ&&oQ)?e9:Object,"function"==typeof(e7=void 0!==o0&&o0)?e7:Object,"function"==typeof(te=void 0!==oZ&&oZ)?te:Object,"function"==typeof(tt=void 0!==oG&&oG)?tt:Object,"function"==typeof(tn=void 0!==oW&&oW)?tn:Object])],o1),function(){let e=tW.resolve(o1);e.init().then(()=>{e.run()})}()})();
//# sourceMappingURL=index.js.map

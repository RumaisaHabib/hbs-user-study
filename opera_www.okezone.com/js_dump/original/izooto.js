!function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}o.m=n,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=18)}([function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Helper=void 0;var c=n(1),l=n(2),p=n(3),r=n(5),d=n(4),o=n(8),u=n(10),n=(f.checkBrowser=function(){navigator.appVersion;var e,t=navigator.userAgent.toLowerCase(),n=navigator.appName,i=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10),r=0,r=-1!=(e=t.indexOf("opr/"))?(n=l.KeyMapper.BROWSER_OPERA,i=t.substring(e+4),4):-1!=(e=t.indexOf("opera"))?(n=l.KeyMapper.BROWSER_OPERA,i=t.substring(e+6),-1!=(e=t.indexOf("version"))&&(i=t.substring(e+8)),4):-1!=(e=t.indexOf("edge/"))||-1!=(e=t.indexOf("edga/"))?(n=l.KeyMapper.BROWSER_EDGE,i=t.substring(e+5),7):-1!=(e=t.indexOf("edgios/"))?(n="Edge",i=t.substring(e+7),7):-1!=(e=t.indexOf("edg/"))?(n="Edge",i=t.substring(e+4),7):-1!=(e=t.indexOf("ucbrowser"))?(n=l.KeyMapper.BROWSER_UCB,i=t.substring(e+10),6):-1!=(e=t.indexOf("msie"))?(n=l.KeyMapper.BROWSER_IE,i=t.substring(e+5),5):-1!=(e=t.indexOf("crios"))?(n=l.KeyMapper.BROWSER_CHROME,i=t.substring(e+6),1):-1!=(e=t.indexOf("chrome"))?(n=l.KeyMapper.BROWSER_CHROME,i=t.substring(e+7),1):-1!=(e=t.indexOf("firefox"))?(n=l.KeyMapper.BROWSER_FIREFOX,i=t.substring(e+8),3):-1!=(e=t.indexOf("fxios"))?(n=l.KeyMapper.BROWSER_FIREFOX,i=t.substring(e+6,e+11),3):-1!=(e=t.indexOf("safari"))&&(/mac/.test(t)||/ipad|iphone|ipod/.test(t))?(n=l.KeyMapper.BROWSER_SAFARI,i=t.substring(e+7),-1!=(e=t.indexOf("version"))&&(i=t.substring(e+8)),2):(n=l.KeyMapper.BROWSER_OTHER,i="1",5);return-1!=(e=(i=-1!=(e=i.indexOf(";"))?i.substring(0,e):i).indexOf(" "))&&(i=i.substring(0,e)),o=parseInt(""+i,10),isNaN(o)&&(i=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),[n,o,i,r]},f.getBrowserName=function(){return this.checkBrowser()[0]},f.getBrowserVersion=function(){return this.checkBrowser()[2]},f.getBrowserMajorVersion=function(){return this.checkBrowser()[1]},f.getBrowserType=function(){return this.checkBrowser()[3]},f.isTablet=function(e){if(/android/.test(e)){if(!1===/mobile/.test(e))return!0}else if(!0===/ipad/.test(e))return!0;return!1},f.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))},f.isIos=function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},f.getDeviceType=function(){var e=(e=navigator.userAgent).toLowerCase();return this.isTablet(e)?l.KeyMapper.DEVICE_TYPE_TABLET:this.isMobile()?l.KeyMapper.DEVICE_TYPE_MOBILE:l.KeyMapper.DEVICE_TYPE_DESKTOP},f.getOS=function(){var e=navigator.userAgent.toLowerCase();return/windows phone/i.test(e)?6:/android/i.test(e)?4:/ipad|iphone|ipod/.test(e)&&!window.MSStream?5:/linux/i.test(e)?2:/macintosh|mac os x/i.test(e)?3:/windows|win32/i.test(e)?1:7},f.getOSName=function(){return[l.KeyMapper.OS_WINDOWS,l.KeyMapper.OS_LINUX,l.KeyMapper.OS_MAC,l.KeyMapper.OS_ANDROID,l.KeyMapper.OS_IOS,l.KeyMapper.OS_WP,l.KeyMapper.OS_OTHER][f.getOS()-1]},f.detectPlatform=function(){var e="";return 1==window.is_wp?e="wordpress":1==c.Config.notification.isShopify?e="shopify":null!=window._izootoModule&&1==window._izootoModule.isMagento?e="magento":null!=window._izootoModule&&1==window._izootoModule.isOpencart&&(e="opencart"),e},f.getMetaValue=function(e){try{for(var t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)if(t[n].getAttribute("name")===e||t[n].getAttribute("property")===e)return t[n].getAttribute("content")}catch(e){}return""},f.endPointParamExtract=function(e){var t="";try{t=JSON.parse(e).endpoint}catch(e){}return{ep:t=c.Config.global.browserName==l.KeyMapper.BROWSER_EDGE?encodeURIComponent(t):t}},f.getEndpoint=function(e){var t={SoftUnsubscribe:["usub","sunsub"],SoftSubscribe:["usub","sunsub"],NotImplemented:["ni","nimp"],SegmentEvents:["et","evt"],SegmentProperties:["prp","prp"],TriggerEvent:["trg","trg"],PersonalProperties:["pp","pprp"],CustomerIDSynch:["pp","idsyn"],CustomerIDLogout:["pp","clout"],last_visit:["lvi","lvi"],Visitor:["viz","viz"],ShopifyMapper:["oth","spm"],GDPRConsent:["prv","gdp"],FCMMigration:["enu","enu"],syncAdNetwork:["cs","cs"],syncNotificationView:["imp","wimp"],syncAllSubscribersVisit:["viz","viz"],syncMessenger:["msngenr","msngenr"],getUUIDFromEp:["uuid","uuid"],gdprLocationUrl:["rapi",""],gdprStatusUrl:["prv","gdp"],shopifyAPI:["events","shopifywh1.php"],subscriptionValidator:["ss","ss.php"],supUrl:["evt","sup.php"],notificationClick:["clk","clk"],messengerPrompted:["msngp","msngp"],notificationSent:["snt","snt"],syncOnsiteClick:["osclk","osclk"],syncOnsiteView:["osimp","osimp"],syncOnsiteDismissed:["osdis","osdis"],syncNewshubView:["nhwimp","nhwimp"],syncNewshubOpen:["nhwopn","nhwopn"],syncClientSideChurn:["csc","csc"]};return t[l.KeyMapper.PROMPT_ALLOWED]=["enp","enp"],t[l.KeyMapper.ALREADY_GRANTED]=["enp","enp"],t[l.KeyMapper.PROMPT_CLOSED]=["sbp","ncls"],t[l.KeyMapper.OPTIN_ALLOWED]=["sbp","salw"],t[l.KeyMapper.PROMPT_DENIED]=["sbp","nblk"],t[l.KeyMapper.ALREADY_DENIED]=["sbp","nblk"],t[l.KeyMapper.OPTIN_CLOSED]=["sbp","sblk"],t[l.KeyMapper.POPUP_CLOSED]=["sbp","swc"],t[l.KeyMapper.PROMPTED]=["sbpd","npd"],t[l.KeyMapper.OPTIN_SHOWN]=["sbpd","spd"],t[l.KeyMapper.BROWSER_UNSUPPORTED]=["na","nsp"],t.hasOwnProperty(e)?"https://"+t[e][0]+".izooto.com/"+t[e][1]:"https://err.izooto.com/err"},f.getTimeDiff=function(e,t){if(!e)return 0;e=(e-(new Date).getTime())/1e3;return null!=t&&0!=t||(e/=60),Math.abs(Math.round(e))},f.urlB64ToUint8Array=function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(e),n=new Uint8Array(t.length),i=0;i<t.length;++i)n[i]=t.charCodeAt(i);return n},f.getLanguage=function(){var e=document.documentElement.lang;if(""==e)try{for(var t=document.getElementsByTagName("meta"),n=0;n<t.length;n++)"content-language"==t[n].getAttribute("http-equiv")&&(e=t[n].getAttribute("content"))}catch(e){}return e},f.displayLog=function(e,t){e=window.top!=window.self?c.Config.brandingPartner+" Iframe: => "+e:c.Config.brandingPartner+" => "+e,1===c.Config.debug&&(void 0!==t?console.warn(e,t):console.warn(e))},f.throwError=function(e){throw new Error(e)},f.getParamFromUrl=function(e,t){return new URL(e).searchParams.get(t)},f.izParseQuery=function(e){for(var t={},n=("?"===e[0]?e.substr(1):e).split("&"),i=0;i<n.length;i++){var o=n[i].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1]||"")}return t},f.replaceQueryParam=function(e,t,n){var i=new RegExp("([?|&])"+t+"=.*?(&|$)","i"),o=-1!==e.indexOf("?")?"&":"?";return e.match(i)?e.replace(i,"$1"+t+"="+n+"$2"):e+o+t+"="+n},f.getUTMParamsOfUrl=function(e){try{var t=(e=void 0===e?window.location.href:e).indexOf("?");if(0<t){var n=e.substring(t+1),i=f.izParseQuery(n),o={};return 2<c.Config.notification.utmKeys.map(function(e,t){var n=i.hasOwnProperty(e);return n&&(""==e&&null==e||(o[c.Config.notification.shortutmKeys[t]]=i[e])),n}).reduce(function(e,t,n){return t?e+1:e})?o:{}}return{}}catch(e){return{}}},f.getQuerySting=function(e){try{var t,n=[];for(t in e)e.hasOwnProperty(t)&&n.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n.join("&")}catch(e){}},f.objToParam=function(t){var e="";try{e=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")}catch(e){}return e},f.addMsgReciever=function(t,e){if(void 0===e&&(e=!1),1!=c.Config.global.msgReceiverExist||e){e||(c.Config.global.msgReceiverExist=1);try{window.addEventListener("message",function(e){(-1<e.origin.indexOf(window.location.host)||"https://cdn.izooto.com"==e.origin||-1<e.origin.indexOf(c.Config.notification.sourceOrigin)||-1<e.origin.indexOf(c.Config.notification.sourceOriginAlt)||-1<e.origin.indexOf(c.Config.notification.siteUrl)||-1<c.Config.notification.masterDomain.indexOf(e.origin)||3==c.Config.notification.windowType)&&e.data&&t(e)})}catch(e){}}},f.postMessage=function(e,t,n,i){try{var o,r;null!=typeof e&&null!=t&&((o={})[t]=void 0!==n?n:1,o.serviceWorkerVersion=i,!d.NotificationHelper.subscriptionSyncedFromSW||t!=l.KeyMapper.ALREADY_GRANTED&&t!=l.KeyMapper.PROMPT_ALLOWED||(o.httpSuccess=!0),(r={})[l.KeyMapper.MESSAGE]=o,f.postToTargetedWindow(e,r),f.postToTargetedWindow(e,{izootoMsg:{k:t,v:void 0!==n?n:1}}))}catch(e){}},f.postToTargetedWindow=function(e,t){try{"parent"===e?window.parent.postMessage(JSON.stringify(t),"*"):"opener"===e?window.opener&&window.opener.postMessage(JSON.stringify(t),"*"):e.contentWindow.postMessage(JSON.stringify(t),"*")}catch(e){}},f.addHTML=function(e,t,n){try{var i=document.body,o=document.createElement(e);return o.setAttribute("id",n||""),o.innerHTML=t,i.appendChild(o),!0}catch(e){f.displayLog("Could't add HTML : ",e)}},f.removeHTML=function(e){try{e.remove()}catch(e){f.displayLog("Error while removing HTML",e)}},f.addExternalJS=function(i,o,r,e){return new Promise(function(e,t){var n=document.createElement("script");n.onload=e,n.onerror=t,n.async=r||!1,n.id=o||"",n.src=i,(document.body||document.head).appendChild(n)})},f.checkForFcm=function(){var e=f.getBrowserMajorVersion(),t=f.getBrowserName();return t==l.KeyMapper.BROWSER_UCB&&12<=e||t==l.KeyMapper.BROWSER_OPERA&&42<=e||t==l.KeyMapper.BROWSER_EDGE&&17<=e?1:0},f.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},f.parseToJSON=function(e){try{return JSON.parse(e)}catch(e){return!1}},f.removeHtmlTagsFromString=function(e){var t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},f.stringToRegex=function(e,t){var n="";return n="object"==typeof e&&0<Object.keys(e).length?1<Object.keys(e).length?new RegExp(e[0],e[1]):new RegExp(e[0]):n},f.getParsedMethod=function(e){try{return new Function("return "+atob(e))()}catch(e){f.displayLog("Error while parsing custom module")}},f.getDateDiffrenceFromPresent=function(e){try{var t=new Date(e),n=new Date,i=Math.abs(t-n)/1e3;return Math.floor(i/86400)}catch(e){}},f.sleep=function(t){return new Promise(function(e){return setTimeout(e,t)})},f.getUUID=function(){return i(this,void 0,void 0,function(){var t,n;return s(this,function(e){switch(e.label){case 0:return[4,f.getUUIDFromStorage()];case 1:return""==(t=e.sent())&&(n=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})),[2,t]}})})},f.getUUIDFromStorage=function(){return i(this,void 0,void 0,function(){return s(this,function(e){return[2,new Promise(function(t,e){var n=p.Storage.getStorage(l.KeyMapper.UUID)||"";u.IndexedDB.getValueFromiDbOptions("uid").then(function(e){t(e||n),f.syncUUIDMigration(n,e)})})]})})},f.syncUUIDMigration=function(e,t){e!=t&&(e&&t&&(f.UUIDMapper(e,t),p.Storage.setStorage(l.KeyMapper.UUID,t)),e||p.Storage.setStorage(l.KeyMapper.UUID,t),t||f.setUUIDiDb(e))},f.isUUID=function(){return i(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,f.getUUIDFromStorage()];case 1:return""!=e.sent()?[2,!0]:[2,!1]}})})},f.setUUID=function(){return i(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return t=c.Config.UUID,[4,f.isUUID()];case 1:return e.sent()||(p.Storage.setStorage(l.KeyMapper.UUID,t),f.setUUIDiDb(t),o.CookieStorage.setWpCookie("izooto_uid",t)),[2]}})})},f.setUUIDiDb=function(e){u.IndexedDB.addUpdate("uid",e).then(function(e){}).catch(function(e){f.displayLog(e)})},f.UUIDMapper=function(t,n){var i=f.getEndpoint("FCMMigration");t&&n&&f.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0}).then(function(e){e=a(a({},e),{oBkey:t,bKey:n});r.HttpRequest.postForm(i,e).then(function(){}).catch(function(e){})})},f.getUUIDFromEndpoint=function(o){return new Promise(function(t,e){var n=f.getEndpoint("getUUIDFromEp"),i=d.NotificationHelper.subcriptionToObject(o);2==c.Config.notification.subscriptionType&&(i=i.endpoint),n=n+"?pid="+c.Config.client+"&ep="+i+"&btype="+c.Config.global.browserType,r.HttpRequest.get(n).then(function(e){e=f.parseToJSON(e);e.hasOwnProperty("id")&&"NULL"!=e.id&&"string"==typeof e.id&&t(e.id),t("")}).catch(function(){t("")})})},f.isScreenScrollable=function(){try{var e=document.body,t=e.parentNode,n=e.scrollHeight-e.clientHeight;if(2<=(n="CSS1Compat"==document.compatMode?t.scrollHeight-t.clientHeight:n)/window.screen.availHeight)return!0}catch(e){}return f.displayLog("This page is not scrollable!"),!1},f.izootoBrandingHandler=function(e){if(0==c.Config.branding)try{var t,n=e?e.document.querySelectorAll(".izbranding"):document.getElementsByClassName("izbranding");for(t in n)n[t].style.display="none",f.displayLog("Branding Disabled")}catch(e){}},f.addIFrame=function(i,o,e){return new Promise(function(e,t){try{var n=document.createElement("IFRAME");return n.setAttribute("src",i),n.setAttribute("id",o),n.style.width="0px",n.style.height="0px",n.style.border="0px",n.setAttribute("visibility","hidden"),n.style.display="none",n.onload=function(){return e(!0)},(null!=document.body?document.body:document.head).appendChild(n),n}catch(e){f.displayLog("Unable to subFrame : ",e)}})},f.setHref=function(e,t){document.querySelector(e).href=t},f.getTimeAgoStringByTimestamp=function(e){var t,n=new Date,e=new Date(e),e=n.getTime()-e.getTime(),e=parseInt(e/1e3);if(!isNaN(e)){if(e<=60)return"1 min ago ";if(60<e&&e<3600){var i=Math.round(e/60);return 1<i?i+" mins ago":i+" min ago"}if(3600<=e&&e<86400){i=Math.round(e/3600);return 1<i?i+" hrs ago":i+" hr ago"}return 86400<=e&&e<2592e3?1<(t=Math.round(e/86400))?t+" days ago":"yesterday":2592e3<=e?1<(t=Math.round(e/2592e3))?t+" months ago":t+" month ago":void 0}},f.hideElement=function(e,t){void 0===t&&(t=window.document);try{var n=t.querySelector(e);n&&(n.style.display="none")}catch(e){f.displayLog("Error : While hide element",e)}},f.showElement=function(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=window.document);try{var i=n.querySelector(e);i&&(i.style.display=t?"block":"flex")}catch(e){f.displayLog("Error : While show element",e)}},f.setCssPropperty=function(e,t,n,i){void 0===i&&(i=window.document);try{var o=i.querySelector(e);o&&(o.style[t]=n)}catch(e){f.displayLog("Error : While set css property",e)}},f.getFlagBasedParameter=function(o,r){return i(this,void 0,void 0,function(){return s(this,function(e){return[2,new Promise(function(t){var e,n,i={};i={pid:c.Config.client,btype:c.Config.global.browserType,dtype:c.Config.global.deviceType,bver:c.Config.global.browserVer,os:c.Config.global.os};try{null!=o&&o.subscriptionMeta&&(e={izcid:p.Storage.getConfigLocal(l.KeyMapper.IZCID),ht:"https:"==c.Config.global.locationProtocol?1:0,sw:c.Config.notification.serviceWorkerVersion,pt:c.Config.notification.promptType,pte:c.Config.notification.subscriptionType,ge:c.Config.notification.gdprPromptStatus,tz:(new Date).getTimezoneOffset()+330,optin:d.NotificationHelper.getOptinDesignType(),ndc:p.Storage.getConfigLocal(l.KeyMapper.PROMPT_COUNT,l.KeyMapper.STATS),sdc:p.Storage.getConfigLocal(l.KeyMapper.OPTIN_SHOWN_COUNT,l.KeyMapper.STATS)},i=a(a({},i),e)),void 0===r&&(r=p.Storage.getStorage(l.KeyMapper.PUSH_TOKEN)),null!=o&&o.subcription&&r&&(n=d.NotificationHelper.getSubscriptionParameters(r),i=a(a({},i),n)),t(i)}catch(e){t(i)}})]})})},f.removeUndefinedValuesFromObj=function(t){var n={};return Object.keys(t).forEach(function(e){void 0!==t[e]&&"undefined"!==t[e]&&""!==t[e]&&(n[e]=t[e])}),n},f.getDomElement=function(e,t){return(t=void 0===t?window.document:t).querySelector(e)},f);function f(){}t.Helper=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Config=void 0;var a=n(0),r=n(4),s=n(2),c=n(8),n=(l.setupPath=function(){1!=l.global.deviceType&&""!=l.notification.serviceWorkerNameMob&&(l.notification.serviceWorkerName=l.notification.serviceWorkerNameMob),l.notification.serviceWorkerPath=l.notification.domainRoot+l.notification.serviceWorkerName,l.notification.manifest=l.notification.domainRoot+l.notification.manifestName,1==l.notification.isSdkHttps&&("http:"==l.global.locationProtocol?l.notification.sourceOrigin=l.notification.sourceOrigin+l.notification.domainRoot+l.notification.htmlName:(1==l.notification.httpsNoRoot&&""!=l.notification.domainRoot||0==l.notification.httpsNoRoot)&&(l.notification.sourceOrigin=l.notification.domainRoot+l.notification.htmlName));try{var e;null==window._izootoModule&&1!=window.is_wp||(l.notification.pluginStatus=void 0!==izConfig.pluginStatus?izConfig.pluginStatus:1,1==l.notification.pluginStatus&&(c.CookieStorage.setWpCookie("b_type",l.global.browserType),c.CookieStorage.setWpCookie("d_type",l.global.deviceType),null!=window._izootoModule&&1==window._izootoModule.isMagento?null!=(e=window._izootoModule).isSdkHttps&&1==e.isSdkHttps&&(l.notification.serviceWorkerPath="/izooto/assets/sw",l.notification.manifest="/izooto/assets/manifest",l.notification.serviceWorkerScope="/",c.CookieStorage.setWpCookie("evt_trk",l.notification.evtTracking)):null!=window._izootoModule&&1==window._izootoModule.isPrestashop||null!=window._izootoModule&&1==window._izootoModule.isOpencart||1==window.is_wp&&(c.CookieStorage.setWpCookie("evt_trk",l.notification.evtTracking),null!=window._izootoModule&&null!=window._izootoModule.swPath?(l.notification.serviceWorkerPath=window._izootoModule.swPath,l.notification.serviceWorkerScope=l.notification.serviceWorkerScope||"/"):l.notification.serviceWorkerPath=l.notification.domainRoot+"/?izooto=sw",l.notification.manifest=l.notification.domainRoot+"/?izooto=manifest")))}catch(e){}},l.exitIntentMultiRSSFeedConfigHandler=function(){var e=izConfig.exitIntent;if(e&&e.rfiId&&0<Object.keys(e.rfiId).length){var t,n=e.rfiId,i=l.exitIntent.status=0;for(t in n){var o=n[t],r=a.Helper.stringToRegex(o.regex),o=document.location.pathname;if((0==i&&""==r||r.test(o)&&0==i)&&(l.exitIntent.feedHash=t.toString(),l.exitIntent.status=e.status,""!=r))return void(i=1)}}},l.multiMessengerConfigHandler=function(){if(izConfig.messenger&&0<Object.keys(izConfig.messenger).length){var e,t=0;for(e in izConfig.messenger){var n=izConfig.messenger[e],i=a.Helper.stringToRegex(n.regex),o=document.location.pathname;if((0==t&&""==i||i.test(o)&&0==t)&&(l.messenger.status=null!=n.status?n.status:0,l.messenger.pageId=e.toString(),l.messenger.prompt=null!=n.promptDesign?n.promptDesign:{},l.messenger.repeatDelay=null!=n.repeatDelay?n.repeatDelay:0,l.messenger.color=null!=n.color?n.color:"blue",l.messenger.size=null!=n.size?n.size:"large",l.messenger.buttonTextType=null!=n.btnTextType?n.btnTextType:0,""!=i))return void(t=1)}}},l.gaMigration=function(){var e=void 0!==izConfig.gaId?izConfig.gaId:"",t=void 0!==izConfig.ga&&""!==izConfig.ga?izConfig.ga:{},n=void 0!==t.id?t.id:"",i=void 0!==t.syncWebPush?t.syncWebPush:0,o=void 0!==t.syncNewsHub?t.syncNewsHub:0;l.ga.id=""!==e?e:n,l.ga.syncWebPush=""!==e?1:i,l.ga.syncNewsHub=""!==l.newsHub.gaId?1:o,l.ga.syncMessenger=void 0!==t.syncMessenger?t.syncMessenger:0,l.ga.newsHubEvents=void 0!==t.newsHubEvents?t.newsHubEvents:[]},l.init=function(){return i(this,void 0,void 0,function(){var t;return o(this,function(e){switch(e.label){case 0:return l.brandingPartner=void 0!==izConfig.brandingPartner&&""!=izConfig.brandingPartner?izConfig.brandingPartner:l.defaultBrandingPartner,l.client=void 0!==izConfig.client?izConfig.client:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (client)"),l.notification.sourceOrigin=void 0!==izConfig.sourceOrigin?izConfig.sourceOrigin:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (sourceOrigin)"),l.notification.domainRoot=void 0!==izConfig.domainRoot?izConfig.domainRoot:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (domainRoot)"),l.notification.isSdkHttps=void 0!==izConfig.isSdkHttps?izConfig.isSdkHttps:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (isSdkHttps)"),l.notification.serviceWorkerName=void 0!==izConfig.serviceWorkerName?izConfig.serviceWorkerName:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (serviceWorkerName)"),l.notification.manifestName=void 0!==izConfig.manifestName?izConfig.manifestName:a.Helper.throwError(l.brandingPartner+":: Configuration parameter not found (manifestName)"),l.notification.vapidKey||(console.warn(l.brandingPartner+":: vapid public key not found"),l.izootoStatus=0),l.global.browserName=a.Helper.getBrowserName(),l.global.browserType=a.Helper.getBrowserType(),l.global.deviceType=a.Helper.getDeviceType(),l.global.browserVer=a.Helper.getBrowserVersion(),l.global.browserMajorVersion=a.Helper.getBrowserMajorVersion(),l.global.os=a.Helper.getOS(),l.global.platform=a.Helper.detectPlatform(),l.notification.windowType=r.NotificationHelper.getWindowType(),l.notification.serviceWorkerPath=""+l.notification.domainRoot+l.notification.serviceWorkerName,l.notification.isAddFcm=a.Helper.checkForFcm(),!l.notification.fcmEnable&&1!=l.notification.isAddFcm||(l.notification.subscriptionType=1),void 0!==l.notification.vapidKey&&""!==l.notification.vapidKey&&(l.notification.fcmEnable=0,l.notification.subscriptionType=2),l.global.browserName==s.KeyMapper.BROWSER_SAFARI&&l.global.browserVer<"16"&&(l.notification.subscriptionType=3),l.ga.syncCid=void 0!==izConfig.syncGACid?izConfig.syncGACid:0,l.ga.swEvents=void 0!==izConfig.gaSwEvents?izConfig.gaSwEvents:0,1!=l.global.deviceType&&(l.notification.promptDesign=void 0!==izConfig.mobPromptDesign&&izConfig.mobPromptDesign?izConfig.mobPromptDesign:l.notification.promptDesign,l.notification.promptType=void 0!==izConfig.mobPromptFlow?izConfig.mobPromptFlow:l.notification.promptType,l.notification.optInDesignType=void 0!==izConfig.mobOptInDesignType?izConfig.mobOptInDesignType:l.notification.optInDesignType,l.notification.promptDelay=void 0!==izConfig.mobPromptDelay?izConfig.mobPromptDelay:l.notification.promptDelay,l.notification.repeatPromptDelay=void 0!==izConfig.mobRepeatPromptDelay?izConfig.mobRepeatPromptDelay:l.notification.repeatPromptDelay,l.notification.optInCloseDelay=void 0!==izConfig.mobOptInCloseDelay?izConfig.mobOptInCloseDelay:l.notification.optInCloseDelay,l.notification.promptOnScroll=void 0!==izConfig.mobPromptOnScroll?izConfig.mobPromptOnScroll:0,l.notification.isTriggeredOnScoll=0),l.notification.promptDesign.poweredbysrc="https://www.izooto.com/getting-started-with-izooto?utm_source=referral&utm_medium=PoweredBy&utm_campaign="+encodeURIComponent(l.notification.siteUrl),l.brandingPartner!=l.defaultBrandingPartner&&(l.notification.promptDesign.poweredbysrc="javascript:void(0);"),l.notification.promptDesign.message=l.notification.promptDesign.message||"Click on allow to subscribe to notifications",l.notification.promptDesign.subMessage=l.notification.promptDesign.subMessage||"Stay updated with the latest happenings on our site",l.notification.promptDesign.icon=l.notification.promptDesign.icon||"https://cdnimg.izooto.com/icons/7/bell-icon.png",l.notification.promptDesign.btn1Txt=l.notification.promptDesign.btn1Txt||"Later",l.notification.promptDesign.btn2Txt=l.notification.promptDesign.btn2Txt||"Allow",l.notification.promptDesign.position=l.notification.promptDesign.position||"right",l.notification.promptDesign.bgColor=l.notification.promptDesign.bgColor||"#fff",l.notification.promptDesign.titleForeColor=l.notification.promptDesign.titleForeColor||"#000000",l.notification.promptDesign.messageForeColor=l.notification.promptDesign.messageForeColor||"#999999",l.notification.promptDesign.btn1bgColor=l.notification.promptDesign.btn1bgColor||"#e4e4e4",l.notification.promptDesign.btn1ForeColor=l.notification.promptDesign.btn1ForeColor||"#686868",l.notification.promptDesign.btn2bgColor=l.notification.promptDesign.btn2bgColor||"#1194ff",l.notification.promptDesign.btn2ForeColor=l.notification.promptDesign.btn2ForeColor||"#ffffff",l.notification.httpsOverlay="<style>.iz-branding{color:white;font-size:25px;position:absolute;top:40%;left:28%;z-index:999999!important;width:50%!important}.iz-arrow img{transform:rotate(180deg)}@media screen and (max-width:600px){#izooto_desktop_overlay{display:none;.iz-arrow{width:100%;position:fixed;top:auto;bottom:35%;left:65%;border-radius:0px}.moz-transfer{width:100%;position:fixed;top:auto;bottom:30%;left:65% !important;border-radius:0px}.moz-transfer img{transform:rotate(180deg) !important}.iz-arrow img{transform:rotate(0deg)}.iz-branding{color:white;font-size:larger;position:fixed;top:40%;left:17%;width:100%}}</style><div id='izooto_desktop_overlay' onclick='_izooto.closeHttpsBranding();' style='z-index: 999999999;position: fixed;height: 100%;top: 0px;left: 0px;width: 100%;background: rgba(0, 0, 0, 0.89);'><div class='izoverlay-container'><div class='iz-branding'><div class='iz-text' style='padding-bottom:5px; font-family:Arial; display: -webkit-box; -webkit-line-clamp: 2; text-overflow: ellipsis; overflow: hidden; word-wrap: break-word; -webkit-box-orient: vertical;'>"+l.notification.overlayMessage+"</div><div class='iz-powered-text'><a class='izbranding' href='"+l.notification.promptDesign.poweredbysrc+"' target='_blank' style='cursor: pointer !important;color:#fff!important;font-size: 12px;font-family: Arial;letter-spacing: 0.4px;text-decoration: none;'><span style='color: #9c9c9c;'>Powered by</span> <span>"+l.brandingPartner+"</span></a></div></div></div>",l.notification.httpsBranding="<style>.iz-branding {z-index: 2147483646;background: #000;opacity: .65;box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.27);border-radius: 2px 0px 0px 2px;letter-spacing: 0.04em;padding: 6px 15px;display: flex;flex-direction: row;align-items: center;justify-content: center;max-width: fit-content;position: fixed;top: 0;right: 0;}.iz-branding .iz-text {font-size: 12px;font-family: Arial;letter-spacing: 0.04em;color: rgb(255 255 255 / 90%);display: flex;flex-direction: row;align-items: center;justify-content: center;}.iz-branding a .iz-brand {font-size: 12px;font-family: Arial;letter-spacing: 0.04em;color: #fff;font-weight:bold;}</style><div class='iz-branding'><div class='iz-text'>Notifications Powered by&nbsp;<a href='"+l.notification.promptDesign.poweredbysrc+"' target='_blank' style='text-decoration: none;color: unset;'><span class='iz-brand'>"+l.brandingPartner+"</span></a></div></div>",l.setupPath(),l.multiMessengerConfigHandler(),l.notification.gdprPromptStatus=void 0!==l.notification.gdprPrompt.status?l.notification.gdprPrompt.status:0,l.notification.gdprPromptType=void 0!==l.notification.gdprPrompt.type?l.notification.gdprPrompt.type:1,l.notification.manifest=l.notification.domainRoot+l.notification.manifestName,t=void 0!==izConfig.welcomeNotification&&""!==izConfig.welcomeNotification?izConfig.welcomeNotification:{},l.notification.welcomeNotification.status=void 0!==t.status?t.status:0,l.notification.welcomeNotification.title=void 0!==t.title?t.title:"",l.notification.welcomeNotification.body=void 0!==t.body?t.body:"",l.notification.welcomeNotification.icon=void 0!==t.icon?t.icon:"",l.notification.welcomeNotification.url=void 0!==t.url?t.url:"",l.notification.welcomeNotification.showAfter=void 0!==t.showAfter?t.showAfter:0,l.notification.welcomeNotification.timeout=void 0!==t.clickTimeout?t.clickTimeout:0,t=void 0!==izConfig.videoPlaybook&&""!==izConfig.videoPlaybook?izConfig.videoPlaybook:{},l.videoDropoff.status=void 0!==t.status&&""!==t.status?t.status:0,l.videoDropoff.allowedUrls=void 0!==t.allowedUrls?t.allowedUrls:[],t=void 0!==izConfig.welcomePlaybook&&""!==izConfig.welcomePlaybook?izConfig.welcomePlaybook:{},l.welcomePlaybook.status=void 0!==t.status&&""!==t.status?t.status:0,l.welcomePlaybook.data=void 0!==t.data&&""!==t.data?t.data:{},t=void 0!==izConfig.CRPSPlaybook&&""!==izConfig.CRPSPlaybook?izConfig.CRPSPlaybook:{},l.CRPSPlaybook.status=void 0!==t.status&&""!==t.status?t.status:0,l.CRPSPlaybook.data=void 0!==t.data&&""!==t.data?t.data:{},t=void 0!==izConfig.newsHub&&""!==izConfig.newsHub?izConfig.newsHub:{},l.newsHub.status=void 0!==t.status&&""!==t.status?t.status:0,l.newsHub.status=void 0!==t.mobileAllowed&&""!==t.mobileAllowed&&1!=l.global.deviceType?t.mobileAllowed:l.newsHub.status,l.newsHub.status=void 0!==t.desktopAllowed&&""!==t.desktopAllowed&&1==l.global.deviceType?t.desktopAllowed:l.newsHub.status,l.newsHub.iconType=void 0!==t.iconType&&""!==t.iconType?t.iconType:1,l.newsHub.designType=void 0!==t.designType&&""!==t.designType?t.designType:1,l.newsHub.mainColor=void 0!==t.mainColor&&""!==t.mainColor?t.mainColor:"",l.newsHub.placement=void 0!==t.placement&&""!==t.placement?t.placement:[1,1],l.newsHub.allVisitors=void 0!==t.allVisitors&&""!==t.allVisitors?t.allVisitors:1,l.newsHub.gaId=void 0!==t.gaId&&""!==t.gaId?t.gaId:"",l.newsHub.title=void 0!==t.title&&""!==t.title?t.title:"",l.newsHub.allowFeed=void 0!==t.allowFeed&&""!==t.allowFeed?t.allowFeed:0,l.newsHub.callout=void 0!==t.callout&&""!==t.callout?t.callout:1,l.newsHub.slidePercent=void 0!==t.slidePercent&&""!==t.slidePercent&&30<=t.slidePercent?t.slidePercent:50,l.newsHub.calloutTimeout=void 0!==t.calloutTimeout&&""!==t.calloutTimeout&&2<=t.calloutTimeout&&t.calloutTimeout<=10?t.calloutTimeout:10,l.newsHub.nudgeStatus=void 0!==t.nudgeStatus&&""!==t.nudgeStatus?t.nudgeStatus:1,l.newsHub.ads=null!=t.ads?t.ads:0,l.newsHub.adUnit=null!=t.adUnit&&""!==t.adUnit?t.adUnit:"",l.newsHub.callOutAds=null!=t.callOutAds&&""!==t.callOutAds?t.callOutAds:0,l.newsHub.callOutAdUnit=null!=t.callOutAdUnit&&""!==t.callOutAdUnit?t.callOutAdUnit:"",t=void 0!==izConfig.recommendArticle&&""!==izConfig.recommendArticle?izConfig.recommendArticle:{},l.recommendArticle.status=void 0!==t.status&&""!==t.status?t.status:0,(l.tabAbandonment=void 0!==izConfig.tabAbandonment&&""!==izConfig.tabAbandonment?izConfig.tabAbandonment:{}).status=null!=l.tabAbandonment.status?l.tabAbandonment.status:0,l.tabAbandonment.timeout=null!=l.tabAbandonment.timeout?l.tabAbandonment.timeout:600,l.tabAbandonment.pushTimeout=null!=l.tabAbandonment.pushTimeout?l.tabAbandonment.pushTimeout:3600,l.tabAbandonment.data=void 0!==l.tabAbandonment.data&&""!==l.tabAbandonment.data?l.tabAbandonment.data:{},t=void 0!==izConfig.exitIntent&&""!==izConfig.exitIntent?izConfig.exitIntent:{},l.exitIntent.status=null!=t.status?t.status:0,l.exitIntent.mobileAllowed=null!=t.mobileAllowed?t.mobileAllowed:1,l.exitIntent.desktopAllowed=null!=t.desktopAllowed?t.desktopAllowed:1,l.exitIntent.title=null!=t.title?t.title:" ",l.exitIntent.titleColor=null!=t.titleColor?t.titleColor:"#000000",l.exitIntent.bgColor=null!=t.bgColor?t.bgColor:"#1194FF",l.exitIntent.onExit=null!=t.onExit?t.onExit:0,l.exitIntent.onBack=null!=t.onBack?t.onBack:1,l.exitIntent.onScrollPercent=null!=t.onScrollPercent?t.onScrollPercent:0,l.exitIntent.onDelay=null!=t.onDelay?t.onDelay:0,l.exitIntent.repeatDelay=null!=t.repeatDelay?t.repeatDelay:0,l.exitIntent.closeDelay=null!=t.closeDelay?t.closeDelay:60,l.exitIntent.cid=null!=t.cid?t.cid:0,l.exitIntent.rid=null!=t.rid?t.rid:0,l.exitIntent.ads=null!=t.ads?t.ads:0,l.exitIntent.adUnit=null!=t.adUnit&&""!==t.adUnit?t.adUnit:"",l.exitIntent.logoURL=void 0!==t.logoURL&&""!=t.logoURL?t.logoURL:"",l.exitIntentMultiRSSFeedConfigHandler(),t=void 0!==izConfig.stickyBar&&""!==izConfig.stickyBar?izConfig.stickyBar:{},l.stickyBar.status=null!=t.status?t.status:0,l.stickyBar.title=null!=t.title?t.title:"You might also like",l.stickyBar.mobileAllowed=null!=t.mobileAllowed?t.mobileAllowed:1,l.stickyBar.desktopAllowed=null!=t.desktopAllowed?t.desktopAllowed:1,l.stickyBar.titleColor=null!=t.titleColor?t.titleColor:"#FFFFFF",l.stickyBar.bgColor=null!=t.bgColor?t.bgColor:"#1194FF",l.stickyBar.repeatDelay=null!=t.repeatDelay?t.repeatDelay:0,l.stickyBar.closeDelay=null!=t.closeDelay?t.closeDelay:60,l.stickyBar.cid=null!=t.cid?t.cid:0,l.stickyBar.rid=null!=t.rid?t.rid:0,l.stickyBar.ads=null!=t.ads?t.ads:0,l.stickyBar.adUnit=null!=t.adUnit&&""!==t.adUnit?t.adUnit:"",t=void 0!==izConfig.articleShare&&""!==izConfig.articleShare?izConfig.articleShare:{},l.articleShare.status=null!=t.status?t.status:0,l.articleShare.repeatDelay=null!=t.repeatDelay?t.repeatDelay:0,l.articleShare.closeDelay=null!=t.closeDelay?t.closeDelay:60,l.articleShare.cid=null!=t.cid?t.cid:0,l.articleShare.rid=null!=t.rid?t.rid:0,l.articleShare.ads=null!=t.ads?t.ads:0,l.articleShare.adUnit=null!=t.adUnit&&""!==t.adUnit?t.adUnit:"",t=void 0!==izConfig.convertBlockedUsers&&""!==izConfig.convertBlockedUsers?izConfig.convertBlockedUsers:{},l.convertBlockedUsers.status=void 0!==t.status?t.status:0,l.convertBlockedUsers.triggerType=void 0!==t.triggerType?t.triggerType:0,l.convertBlockedUsers.promptDelay=null!=t.promptDelay?t.promptDelay:5,l.convertBlockedUsers.title=null!=t.title?t.title:"",l.convertBlockedUsers.message=null!=t.message?t.message:"",l.convertBlockedUsers.btnText=null!=t.btnText?t.btnText:"",(!l.notification.mobileAllowed&&1!=l.global.deviceType||!l.notification.desktopAllowed&&1==l.global.deviceType)&&(l.izootoStatus=0),r.NotificationHelper.applyBrowserPatch(),l.gaMigration(),t=l.notification,[4,r.NotificationHelper.isSupported()];case 1:return t.isSupported=e.sent(),[2]}})})},l.izootoStatus=void 0!==izConfig.izootoStatus?izConfig.izootoStatus:1,l.defaultBrandingPartner="iZooto",l.debug=void 0!==izConfig.debug?izConfig.debug:0,l.branding=void 0!==izConfig.branding?izConfig.branding:1,l.promptSequencing=void 0!==izConfig.promptSequencing?izConfig.promptSequencing:1,l.global={isSetCidLoaded:!1,isIncoginito:!1,isSessionHandled:!1,locationProtocol:document.location.protocol,msgReceiverExist:0,cookieDomain:void 0!==izConfig.cDomain?izConfig.cDomain:"",cookieExpiryDays:1500,cookieSameSite:"SameSite=Lax;",browserName:"",browserType:0,deviceType:0,browserVer:"",browserMajorVersion:0,os:0,platform:"",isFrame:window.top!=window.self},l.channelHandler={webPush:0,messenger:0},l.debugger={status:0,err:0,successCode:"color: #228B22",errCode:"color: #FF0000",infoCode:"background: #ffffcc, color: #222",gcmValidator:"https://api.izooto.com/validate-gcm/",host:document.location.protocol+"//"+document.location.hostname},l.store={subscriberId:!1,lastClick:!1,lastView:!1,syncedEventList:[],isNotificationDisabledManually:!1,syncedSegments:[],isSoftSubscribeTriggered:!1,isTriggerPromptWithDelay:!1,subDomainPermissionStatus:void 0,isNotificationCalledManually:!1,isMDSyncingRequired:!1,isSubscriptionLost:!1,subscriptionBasedEventNameList:["event","trigger","userProfile","personalizationProperty","add_property"]},l.notification={tokenExpire:void 0!==izConfig.tokenExpire?izConfig.tokenExpire:86400,repeatPromptDelay:void 0!==izConfig.repeatPromptDelay?izConfig.repeatPromptDelay:0,optInCloseDelay:void 0!==izConfig.optInCloseDelay?izConfig.optInCloseDelay:60,sourceOrigin:"",domainRoot:"",isSdkHttps:void 0,serviceWorkerName:"",htmlName:void 0!==izConfig.htmlName&&""!=izConfig.htmlName?izConfig.htmlName:"/izooto.html",manifestName:"",manifest:"",subscriptionType:0,fcmToken:"",autoPrompt:!0,httpsBranding:"",swSubscribe:void 0!==izConfig.swSubscribe?izConfig.swSubscribe:1,overlay:void 0!==izConfig.overlay?izConfig.overlay:0,overlayMessage:void 0!==izConfig.overlayMessage?izConfig.overlayMessage:"Click on 'allow' to subscribe to notifications",httpsOverlay:"",clickOnAllowMsg:void 0!==izConfig.clickOnAllowMsg&&""!==izConfig.clickOnAllowMsg?izConfig.clickOnAllowMsg:"Click On allow to subscribe to notifications",subscribedMsg:null!=izConfig.subscribedMsg&&""!==izConfig.subscribedMsg?izConfig.subscribedMsg:"Subscribed",alreadySubscribedMsg:void 0!==izConfig.alreadySubscribedMsg&&""!==izConfig.alreadySubscribedMsg?izConfig.alreadySubscribedMsg:"You've already subscribed to notifications.",blockedMsg:void 0!==izConfig.blockedMsg&&""!==izConfig.blockedMsg?izConfig.blockedMsg:"Blocked",alreadyDeniedMsg:void 0!==izConfig.alreadyDeniedMsg&&""!==izConfig.alreadyDeniedMsg?izConfig.alreadyDeniedMsg:"You've blocked notifications from this site.",httpsNoRoot:void 0!==izConfig.httpsNoRoot?izConfig.httpsNoRoot:0,windowType:0,mobileAllowed:void 0!==izConfig.mobileAllowed?izConfig.mobileAllowed:1,desktopAllowed:void 0!==izConfig.desktopAllowed?izConfig.desktopAllowed:1,allowedKeys:["bookingurl","landingurl"],webPushId:void 0!==izConfig.webPushId?izConfig.webPushId:"",webServiceUrl:void 0!==izConfig.webServiceUrl?izConfig.webServiceUrl:"",processPriority:void 0!==izConfig.processPriority?izConfig.processPriority:0,masterDomain:void 0!==izConfig.masterDomain?izConfig.masterDomain:"",masterDomainPath:void 0!==izConfig.masterDomainPath?izConfig.masterDomainPath:"",cdnHost:"cdn.izooto.com",siteUrl:void 0!==izConfig.siteUrl?izConfig.siteUrl:"",promptDelay:void 0!==izConfig.promptDelay?izConfig.promptDelay:0,promptType:void 0!==izConfig.promptFlow?izConfig.promptFlow:0,defaultOptinDesign:"",hidePopup:void 0===izConfig.hidePopup||izConfig.hidePopup,fullPopUp:void 0!==izConfig.fullPopUp?izConfig.fullPopUp:0,promptDesign:void 0!==izConfig.promptDesign?izConfig.promptDesign:{message:void 0,subMessage:void 0,icon:void 0,btn1Txt:void 0,btn2Txt:void 0,position:void 0,bgColor:void 0,titleForeColor:void 0,messageForeColor:void 0,btn1bgColor:void 0,btn1ForeColor:void 0,btn2bgColor:void 0,btn2ForeColor:void 0},optInDesign:void 0!==izConfig.optInDesign&&""!=izConfig.optInDesign?izConfig.optInDesign:"",dialogDesign:"",gdprDialogDesign:"",optInSrc:"https://cdn.izooto.com/optin/",optInDesignType:void 0!==izConfig.optInDesignType?izConfig.optInDesignType:"1",optinModule:{optinType:1,data:""},gdprModule:{gdprType:1,data:""},sourceOriginAlt:void 0!==izConfig.sourceOriginAlt?izConfig.sourceOriginAlt:"",fcmEnable:void 0!==izConfig.fcmEnable?izConfig.fcmEnable:0,isAddFcm:0,allowedDomain:void 0!==izConfig.allowedDomain?izConfig.allowedDomain:"",serviceWorkerPath:"",serviceWorkerScope:void 0!==izConfig.swScope?izConfig.swScope:"",serviceWorkerNameMob:void 0!==izConfig.serviceWorkerNameMob?izConfig.serviceWorkerNameMob:"",vapidKey:void 0!==izConfig.vapidPublicKey&&""!==izConfig.vapidPublicKey?izConfig.vapidPublicKey:"",subscriptionObj:{},pluginStatus:void 0,isShopify:void 0!==izConfig.isShopify?izConfig.isShopify:0,gdprPrompt:void 0!==izConfig.gdprPrompt?izConfig.gdprPrompt:{},gdprPromptStatus:void 0,gdprPromptType:void 0,gdprNotAllowed:["userProfile","personalizationProperty","trigger","event"],isGdprAllowed:1,sysEvents:void 0!==izConfig.sysEvents?izConfig.sysEvents:1,sysEventsFlag:void 0!==izConfig.sysEvents?1:0,propsTracking:void 0!==izConfig.propsTracking?izConfig.propsTracking:1,evtTracking:void 0!==izConfig.evtTracking?izConfig.evtTracking:1,syncLimit:{evtPerDay:void 0!==izConfig.evtPerDay?izConfig.evtPerDay:1e4,propsPerDay:void 0!==izConfig.propsPerDay?izConfig.propsPerDay:1e4,evtPerMonth:void 0!==izConfig.evtPerMonth?izConfig.evtPerMonth:1e4,propsPerMonth:void 0!==izConfig.propsPerMonth?izConfig.propsPerMonth:1e4},userEvents:void 0!==izConfig.userEvents?izConfig.userEvents:0,isTagsEnabled:void 0!==izConfig.tagsEnabled?izConfig.tagsEnabled:0,utmKeys:["utm_content","utm_medium","utm_source","utm_campaign","utm_term"],shortutmKeys:["uco","ume","uso","uca","ute"],serviceWorkerVersion:void 0,promptOnScroll:void 0!==izConfig.promptOnScroll?izConfig.promptOnScroll:0,isTriggeredOnScoll:0,eventAsTrigger:void 0!==izConfig.eventAsTrigger?izConfig.eventAsTrigger:0,eventsToSync:void 0!==(null===(n=izConfig.webPush)||void 0===n?void 0:n.syncEvent)?izConfig.webPush.syncEvent:[],welcomeNotification:{status:void 0,title:void 0,body:void 0,icon:void 0,url:void 0,showAfter:void 0,timeout:void 0},syncNotificationView:void 0!==izConfig.syncNotificationView?izConfig.syncNotificationView:"",syncNotificationClick:void 0!==izConfig.syncNotificationClick?izConfig.syncNotificationClick:"",syncVisitType:void 0!==izConfig.syncVisitType?izConfig.syncVisitType:0,isSupported:!0},l.ga={id:"",syncCid:0,swEvents:0,syncWebPush:void 0,syncNewsHub:void 0,newsHubEvents:void 0,syncMessenger:void 0,subscriptionCallback:[],promptDisplayCallback:[],oldId:""},l.messenger={syncPrompt:null!=(null===(n=izConfig.messengerConf)||void 0===n?void 0:n.syncPrompt)?izConfig.messengerConf.syncPrompt:1,status:null!=izConfig.messengerPromptStatus?izConfig.messengerPromptStatus:0,pageId:null!=izConfig.messengerPageId?izConfig.messengerPageId:"",repeatDelay:null!=izConfig.messengerRepeatDelay?izConfig.messengerRepeatDelay:0,prompt:null!=izConfig.messengerPrompt?izConfig.messengerPrompt:{},size:"large",color:"blue",buttonTextType:0,autoPrompt:!0},l.tabAbandonment={status:void 0,timeout:void 0,pushTimeout:void 0,data:void 0,counter:0},l.welcomePlaybook={status:void 0,data:{}},l.newsHub={status:0,title:"",designType:void 0,mainColor:void 0,iconType:void 0,placement:void 0,pagination:10,allVisitors:0,gaId:"",autoWidget:!0,callout:void 0,slidePercent:void 0,calloutTimeout:void 0,allowFeed:!1,triggered:!1,nudgeStatus:!0,ads:void 0,adUnit:void 0,callOutAds:void 0,callOutAdUnit:void 0},l.videoDropoff={status:void 0,allowedUrls:[]},l.CRPSPlaybook={isPaidSubscriber:!1,status:null!=izConfig.CRPSPlaybook?izConfig.CRPSPlaybook:0,data:{}},l.exitIntent={status:void 0,mobileAllowed:void 0,desktopAllowed:void 0,autoPopup:!0,title:void 0,titleColor:void 0,bgColor:void 0,onExit:void 0,onScrollPercent:void 0,onDelay:void 0,onBack:void 0,repeatDelay:void 0,closeDelay:void 0,cid:void 0,rid:void 0,ads:void 0,adUnit:void 0,logoURL:void 0,feedHash:void 0,type:1},l.stickyBar={status:void 0,title:void 0,titleColor:void 0,mobileAllowed:void 0,desktopAllowed:void 0,autoPopup:!0,bgColor:void 0,repeatDelay:void 0,closeDelay:void 0,cid:void 0,rid:void 0,ads:void 0,adUnit:void 0,type:2},l.articleShare={status:void 0,repeatDelay:void 0,closeDelay:void 0,cid:void 0,rid:void 0,ads:void 0,adUnit:void 0,type:3},l.convertBlockedUsers={status:void 0,triggerType:void 0,promptDelay:void 0,title:void 0,message:void 0,btnText:void 0},l.recommendArticle={status:void 0},l.autoSegmentStatus=void 0!==izConfig.autoSegment?izConfig.autoSegment:0,l.hashFileName=void 0!==izConfig.hash?izConfig.hash:"",l);function l(){}t.Config=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyMapper=void 0,t.KeyMapper={OPTIN_SHOWN:"optInShown",OPTIN_CLOSED:"optInClosed",OPTIN_ALLOWED:"optInAllowed",PROMPTED:"prompted",PROMPT_CLOSED:"promptclose",PROMPT_DENIED:"denied",PROMPT_ALLOWED:"allowed",SUBSCRIBED:"subscribed",ALREADY_GRANTED:"already_granted",OLD_SUBSCRIPTION:"old_subscription",SUBSCRIBER_REGISTRED:"subscriber_registred",ALREADY_DENIED:"already_denied",ALREADY_UNSUBSCRIBED:"already_unsubscribed",UNSUBSCRIBED:"unsubscribed",POPUP_OPEN:"popupOpened",POPUP_CLOSED:"popClosed",BROWSER_UNSUPPORTED:"browserUnsupported",NOTIFICATION_DISABLED:"notificationDisabled",MESSENGER_PROMPTED:"messengerPrompted",MESSENGER_READY_SHOW:"messengerReadyToLoad",MESSENGER_READY:"messengerReady",MESSENGER_SUBSCRIBED:"messengerSubscribed",NEWSHUB_READY:"readyToShowNewsHub",NEWSHUB_FAILED:"newsHubFailed",NEWSHUB_OPEN:"newsHubOpen",NEWSHUB_CLOSED:"newsHubClosed",NEWSHUB_ANIMATIONEND:"newsHubAnimationEnd",EXITINTENT_SHOWN:"exitIntentShown",EXITINTENT_CLOSED:"exitIntentClosed",STICKYBAR_READY_SHOW:"stickyBarReadyToShow",STICKYBAR_SHOWN:"stickyBarShown",STICKYBAR_CLOSED:"stickyBarClosed",ARTICLESHARE_READY_SHOW:"articleShareReadyToShow",ARTICLESHARE_SHOWN:"articleShareShown",ARTICLESHARE_CLOSED:"articleShareClosed",UUID:"izootoUID",PUSH_TOKEN:"izootoPushToken",STATS:"izootoStats",SYNC:"izootoSync",CONFIG:"izootoConfig",USER_PROPERTY:"izootoUserProp",MASTER_DOMAIN:"izootoMDConfig",SESSION:"izootoSession",RECOMMEND_ARTICLE:"izootoRecommendArticle",MESSENGER:"izootoMessenger",ACTIVE_PROMPT:"izootoActivePrompt",WP_COOKIE:"izootoWpConfig",PROMPT_COUNT:"promptCount",OPTIN_SHOWN_COUNT:"optInShownCount",DM_SYNC_COUNT:"dmSyncCount",EVENT_DAILY:"eventDaily",EVENT_MONTHLY:"eventMonthly",PROPERTY_DAILY:"propDaily",PROPERTY_MONTHLY:"propMonthly",PUSH_TOKEN_NOT_SYNCED:"pushTokenNotSynced",PERMISSION_STATUS:"permissionStatus",REPEAT_PROMPT_DELAY:"notificationPromptDelay",GDPR_CONSENT:"gdprStatus",TAB_ABANDONMENT:"tabAbandonment",IZCID:"IZCID",ALT_DOMAIN_STATUS:"altDomainStatus",IDB_VERSION:"idbVersion",TAB_ABANDONMENT_PUSH:"tabAbandonmentPush",LAST_EVENT_SYNC:"lastEventSync",LAST_PROPERTY_SYNC:"lastPropSync",FIRST_SESSION:"firstSession",CRPS_PLAYBOOK:"crpsPlaybook",NH_MARK_ALL_AS_READ:"newsHubMarkAllAsRead",SUBSCRIBED_ON:"subscribedOn",SESSION_EXPIRY:"expiry",SESSION_COUNT:"count",MSNGR_REPEAT_PROMPT_DELAY:"promptDelay",MSNGR_IS_SUBSCRIBED:"isSubscribed",EXITINTENT_DELAY:"exitIntentDelay",STICKYBAR_DELAY:"stickyBarDelay",SHAREARTICLE_DELAY:"shareArticleDelay",LAST_SYNC_OF_RECOMMEND_ARTICLE:"recommendArticle",RECOMMEND_ARTICLE_SYNCED_PATH:"syncedPath",MESSAGE:"izootoMsg",BROWSER_CHROME:"Chrome",BROWSER_SAFARI:"Safari",BROWSER_FIREFOX:"Firefox",BROWSER_OPERA:"Opera",BROWSER_IE:"Microsoft Internet Explorer",BROWSER_OTHER:"Other",BROWSER_UCB:"Ucb",BROWSER_EDGE:"Edge",DEVICE_TYPE_DESKTOP:1,DEVICE_TYPE_TABLET:2,DEVICE_TYPE_MOBILE:3,OS_WINDOWS:"windows",OS_LINUX:"linux",OS_MAC:"mac",OS_ANDROID:"android",OS_IOS:"ios",OS_WP:"wp",OS_OTHER:"other_os",MASTER_TO_CHILD:"izMasterToChild",CHILD_TO_MASTER:"izChildToMaster",MASTER_AS_FRAME:"izMasterAsFrame",DAILY:"daily",MONTHLY:"monthly",REQUEST_QUEUE:"requestQueue",POST_FORM:"postForm",POST_JSON:"postJson",INVALID_PAYLOAD:"Invalid Payload",SOMETHING_WRONG:"Something wrong",IZCIDDOM:"izsetcgid",USER_PROP:"userProp",SCROLL_DOWN:"downScroll",SCROLL_UP:"upScroll",SUBSCRIPTION_SYNCED:"synced",NUDGEUSER_DELAY:"nudgeuserDelay"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Storage=void 0;var C=n(0),E=n(1),i=n(8),a=n(31),P=n(2),_=n(14),n=(T.updateLastSync=function(e){T.setConfigLocal(e,Date.now(),P.KeyMapper.SYNC)},T.setStorage=function(e,t){var n;a.LocalStorage.isLocalStorageSupport()?(e==P.KeyMapper.PUSH_TOKEN&&(n=decodeURIComponent(t),C.Helper.isJSONString(n)&&(n=JSON.parse(n)),i.CookieStorage.setWpCookie("push_token",n)),localStorage.setItem(e,t)):i.CookieStorage.setCookie(e,t)},T.getStorage=function(e){var t="";return null!=(t=a.LocalStorage.getLocalStorage(e))?e===P.KeyMapper.PUSH_TOKEN?decodeURIComponent(t):t:i.CookieStorage.getCookie(e)},T.removeStorage=function(e){i.CookieStorage.removeCookie(e),a.LocalStorage.removeLocalStorage(e)},T.removeConfigLocal=function(e,t){void 0===t&&(t=P.KeyMapper.CONFIG);var n={},i=a.LocalStorage.getLocalStorage(t);null!=(n=""!=i&&null!=i?C.Helper.parseToJSON(i):n).hasOwnProperty(e)&&delete n[e],a.LocalStorage.isLocalStorageSupport()&&a.LocalStorage.setLocalStorage(t,JSON.stringify(n))},T.setConfigLocal=function(e,t,n){void 0===n&&(n=P.KeyMapper.CONFIG);var i=Math.round((new Date).getTime()/1e3),o={},r=a.LocalStorage.getLocalStorage(n);(o=""!=r&&null!=r?(o=C.Helper.parseToJSON(r))||{}:o)[e]=null!=t&&""!==t?t:i,a.LocalStorage.isLocalStorageSupport()&&a.LocalStorage.setLocalStorage(n,JSON.stringify(o))},T.getConfigLocal=function(e,t){void 0===t&&(t=P.KeyMapper.CONFIG);var n=a.LocalStorage.getLocalStorage(t),i={},t="";return t=null!=(i=""!=n?(i=C.Helper.parseToJSON(n))||{}:i)&&null!=i[e]?i[e]:t},T.legacyStorageMigration=function(){try{if(T.getStorage(P.KeyMapper.UUID)||(E.Config.store.isMDSyncingRequired=!0),1==T.getConfigLocal("isLegacyStorageMigrated"))return;var e=T.getStorage("iztoken");e&&(T.setStorage(P.KeyMapper.PUSH_TOKEN,e),T.updateLastSync(P.KeyMapper.PUSH_TOKEN));var t=T.getConfigLocal("id","izConf");t&&T.setStorage(P.KeyMapper.UUID,t);var n,i=T.getStorage("izooto");i&&(E.Config.store.isMDSyncingRequired=!0,i=decodeURIComponent(i),C.Helper.isJSONString(i)&&(i=C.Helper.parseToJSON(i),n={token:JSON.stringify(i["iz_"+E.Config.client].bkey),subscribed_on:i["iz_"+E.Config.client].subscribed_on,uuid:T.getStorage(P.KeyMapper.UUID)},_.MasterDomain.setMasterStorage(n)));var o=T.getStorage("izstatus");o&&(o=decodeURIComponent(o),C.Helper.isJSONString(o)&&(o=C.Helper.parseToJSON(o),T.setConfigLocal(P.KeyMapper.PERMISSION_STATUS,o.v)));var r=T.getConfigLocal("pmtcount","izConf");r&&T.setConfigLocal(P.KeyMapper.PROMPT_COUNT,r,P.KeyMapper.STATS);var a=T.getConfigLocal("dscount","izConf");a&&T.setConfigLocal(P.KeyMapper.OPTIN_SHOWN_COUNT,a,P.KeyMapper.STATS);var s=T.getConfigLocal("IZCID","izConf");s&&(T.setConfigLocal(P.KeyMapper.IZCID,s),T.updateLastSync(P.KeyMapper.IZCID));var c=T.getStorage("izDl");c&&(c=decodeURIComponent(c),C.Helper.isJSONString(c)&&(c=C.Helper.parseToJSON(c),T.setConfigLocal(P.KeyMapper.REPEAT_PROMPT_DELAY,c.t)));var l=T.getConfigLocal("msngrSubscribed","izConf");l&&T.setConfigLocal(P.KeyMapper.MSNGR_IS_SUBSCRIBED,l);var p,d=T.getConfigLocal("msngrDl","izSync");d&&(d*=1e3,p=(d=new Date(d)).setTime(d.getTime()+60*E.Config.messenger.repeatDelay*1e3),T.setConfigLocal(P.KeyMapper.MSNGR_REPEAT_PROMPT_DELAY,p.getTime()));var u=T.getStorage("izup");u&&T.setStorage(P.KeyMapper.USER_PROPERTY,decodeURIComponent(u));var f=T.getStorage("izmd");f&&T.setConfigLocal(P.KeyMapper.ALT_DOMAIN_STATUS,decodeURIComponent(f));var g=T.getStorage("izgdpr");g&&T.setConfigLocal(P.KeyMapper.GDPR_CONSENT,g);var y,m,h,b,S,v,w=T.getConfigLocal("iz_apihc","izConf");w&&C.Helper.isJSONString(w)&&(w=C.Helper.parseToJSON(w),y={},m=new Date,!w.hasOwnProperty("evt_pd")||(h=w.evt_pd)&&(h=h.split("#"),y[P.KeyMapper.EVENT_DAILY]=h[1],m.setDate(h[0])),w.hasOwnProperty("evt_pm")&&((b=w.evt_pm)&&(b=b.split("#"),y[P.KeyMapper.EVENT_MONTHLY]=b[1],m.setMonth(b[0]-1)),T.setConfigLocal(P.KeyMapper.LAST_EVENT_SYNC,m.getTime(),P.KeyMapper.SYNC)),!w.hasOwnProperty("prop_pd")||(S=w.prop_pd)&&(S=S.split("#"),y[P.KeyMapper.PROPERTY_DAILY]=S[1],m.setDate(S[0])),w.hasOwnProperty("prop_pm")&&((v=w.prop_pm)&&(v=v.split("#"),y[P.KeyMapper.PROPERTY_MONTHLY]=v[1],m.setMonth(v[0]-1)),T.setConfigLocal(P.KeyMapper.LAST_PROPERTY_SYNC,m.getTime(),P.KeyMapper.SYNC)),T.setConfigLocal(P.KeyMapper.DM_SYNC_COUNT,y,P.KeyMapper.STATS)),T.setConfigLocal("isLegacyStorageMigrated",1)}catch(e){T.setConfigLocal("isLegacyStorageMigrated",1)}},T.isSessionStorageSupport=function(){return"sessionStorage"in window&&null!==window.sessionStorage},T.setSessionStorage=function(e,t){sessionStorage.setItem(e,t)},T.getSessionStorage=function(e){return sessionStorage.getItem(e)},T.removeSessionStorage=function(e){sessionStorage.removeItem(e)},T);function T(){}t.Storage=n},function(e,t,n){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},a=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},l=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationHelper=void 0;var p=n(0),y=n(1),d=n(3),u=n(5),i=n(9),o=n(22),f=n(10),s=n(23),g=n(24),m=n(25),h=n(6),b=n(26),S=n(2),v=n(11),w=n(27),C=n(14),E=n(28),P=n(29),_=n(30),T=n(12),M=n(7),n=(O.nativeHandler=function(){return r(this,void 0,void 0,function(){return a(this,function(e){return O.setManifest(),"default"==window.Notification.permission?(O.brandingOverlayHandler(),O.syncSendChurn(),O.sendEvent(S.KeyMapper.PROMPTED),window.Notification.requestPermission().then(function(e){O.closeHttpsOverlay(),p.Helper.displayLog("Permission Status : ",e),"granted"==e?O.permissionGrantedCallback():e==S.KeyMapper.PROMPT_DENIED?O.permissionDeniedCallback():"default"==e&&O.sendEvent(S.KeyMapper.PROMPT_CLOSED),d.Storage.removeStorage(S.KeyMapper.ACTIVE_PROMPT)})):"granted"==window.Notification.permission?(O.subscriptionOnAllow=!1,O.permissionAlreadyGrantedCallback()):window.Notification.permission==S.KeyMapper.PROMPT_DENIED&&O.sendEvent(S.KeyMapper.ALREADY_DENIED),[2]})})},O.permissionAlreadyGrantedCallback=function(){O.setSubscriberDetailsToIdb(S.KeyMapper.ALREADY_GRANTED),1!=y.Config.notification.httpsNoRoot?(O.subscriptionHandler().then(function(e){O.sendEvent(S.KeyMapper.ALREADY_GRANTED,JSON.stringify(e)),C.MasterDomain.masterDomainCallback(!0,e)}).catch(function(e){O.sendEvent(S.KeyMapper.BROWSER_UNSUPPORTED)}),1==y.Config.notification.isShopify&&s.Shopify.init()):O.addNoRootIframeHandler(S.KeyMapper.ALREADY_GRANTED)},O.setSubscribeOnActivateFlagIdb=function(){return new Promise(function(e,t){var n={status:y.Config.notification.swSubscribe,timestamp:Date.now()};y.Config.notification.swSubscribe?e(!0):f.IndexedDB.addUpdate("subscribeOnActivate",n).then(function(){e(!0)}).catch(function(){e(!1)})})},O.addNoRootIframeHandler=function(e){var t=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN);if(t&&1==O.getPermissionStatusFromStorage())return this.isSyncPermissionStatus=!1,void O.sendEvent(e,t);t=(t=y.Config.notification.sourceOrigin+"?action=noroot")+"&izpt="+y.Config.notification.promptType+"&status="+e;O.noRootVersionHandler(),y.Config.global.isFrame||window.location.pathname!=y.Config.notification.sourceOrigin?(p.Helper.addMsgReciever(O.msgReciever),p.Helper.addIFrame(t,"izSubFrame")):O.noRootHandler(e)},O.permissionGrantedCallback=function(){O.setSubscriberDetailsToIdb(S.KeyMapper.PROMPT_ALLOWED),1!=y.Config.notification.httpsNoRoot?O.subscriptionHandler().then(function(e){O.sendEvent(S.KeyMapper.PROMPT_ALLOWED,JSON.stringify(e)),C.MasterDomain.masterDomainCallback(!1,e)}).catch(function(e){O.sendEvent(S.KeyMapper.BROWSER_UNSUPPORTED)}):O.addNoRootIframeHandler("granted")},O.setSubscriberDetailsToIdb=function(e){return O.getHTTPSubscriptionParameters(e).then(function(i){return new Promise(function(e,t){var n={endpoint:p.Helper.getEndpoint(S.KeyMapper.PROMPT_ALLOWED),postData:i};f.IndexedDB.addUpdate("subscriberDetails",n).then(function(){e(!0)}).catch(function(){e(!1)})})})},O.permissionDeniedCallback=function(){O.sendEvent(S.KeyMapper.PROMPT_DENIED),p.Helper.displayLog("User denied prompt")},O.promptHandler=function(){var n=y.Config.notification.promptType;"https:"!=y.Config.global.locationProtocol&&1==y.Config.notification.isSdkHttps&&(y.Config.notification.promptType=1),3==y.Config.notification.subscriptionType?setTimeout(function(){O.checkSafariPermission()},300):0==y.Config.notification.isSdkHttps||y.Config.notification.isSdkHttps&&"http:"==y.Config.global.locationProtocol?(p.Helper.displayLog("Subdomain Process... "),O.getSubDomainPermissionStatus().then(function(e){var t;p.Helper.displayLog("Current subdomain status : ",e),0==e?2==n?O.triggerEventHandler(o.Notification.openPopup):O.promptEventHandler(O.loadOptin):1==e?(t=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN),O.sendEvent(S.KeyMapper.ALREADY_GRANTED,t)):2==e&&(O.updatePermissionStatus(2),O.sendEvent(S.KeyMapper.ALREADY_DENIED))})):1==y.Config.notification.isSdkHttps&&("default"==window.Notification.permission?(d.Storage.removeConfigLocal(S.KeyMapper.PERMISSION_STATUS,S.KeyMapper.SYNC),0==n?O.promptEventHandler(O.nativeHandler):1==n?O.promptEventHandler(O.loadOptin):2==n&&O.triggerEventHandler(O.nativeHandler)):O.nativeHandler())},O.triggerEventHandler=function(e){y.Config.store.isNotificationCalledManually?(y.Config.store.isTriggerPromptWithDelay||(y.Config.notification.promptDelay=0),O.delayHandler(e)):p.Helper.displayLog("auto prompt false found!")},O.requestSafariPermission=function(){O.sendEvent(S.KeyMapper.PROMPTED),O.brandingOverlayHandler();try{window.safari.pushNotification.requestPermission(y.Config.notification.webServiceUrl,y.Config.notification.webPushId,{url:window.location.href},function(e){var t;"granted"===e.permission?(O.closeHttpsOverlay(),t=e.deviceToken,O.sendEvent(S.KeyMapper.PROMPT_ALLOWED,t),p.Helper.displayLog("Granted Key= "+t)):e.permission===S.KeyMapper.PROMPT_DENIED&&(O.closeHttpsOverlay(),O.sendEvent(S.KeyMapper.PROMPT_DENIED))})}catch(e){O.closeHttpsOverlay()}},O.checkSafariPermission=function(){var e,t,n;""!=y.Config.notification.webPushId&&""!=y.Config.notification.webServiceUrl?(e="","safari"in window&&"pushNotification"in window.safari&&("default"===(t=window.safari.pushNotification.permission(y.Config.notification.webPushId)).permission?0==(n=y.Config.notification.promptType)?O.promptEventHandler(O.requestSafariPermission):1==n?O.promptEventHandler(O.loadOptin):2==n&&O.triggerEventHandler(O.requestSafariPermission):"granted"===t.permission?(e=t.deviceToken,O.sendEvent(S.KeyMapper.ALREADY_GRANTED,e),p.Helper.displayLog("Already Granted & key= ",e)):t.permission===S.KeyMapper.PROMPT_DENIED&&(O.sendEvent(S.KeyMapper.ALREADY_DENIED),p.Helper.displayLog(S.KeyMapper.PROMPT_DENIED)))):p.Helper.displayLog("Stopped! Safari certificate not found")},O.delayHandler=function(e){y.Config.notification.promptDelay?(p.Helper.displayLog("Triggering prompt delay for : "+y.Config.notification.promptDelay+" ms"),setTimeout(e,y.Config.notification.promptDelay)):e()},O.promptEventHandler=function(e){var t;O.isActivePrompt()?p.Helper.displayLog(y.Config.brandingPartner+" notification off for this device"):O.isRepeatPromptDelay()||(t=function(){"complete"==document.readyState?(p.Helper.displayLog("Calling prompt instantly"),e()):(p.Helper.displayLog("Wait till web page load completely"),window.addEventListener("load",function(){e()}))},1==y.Config.notification.promptOnScroll&&p.Helper.isScreenScrollable()?(p.Helper.displayLog("optIn will be shown on page scroll!"),window.addEventListener("scroll",function(){O.scrollHandler(t)})):O.delayHandler(t))},O.isRepeatPromptDelay=function(){var e,t=!1;return y.Config.notification.windowType||(e=new Date,d.Storage.getConfigLocal(S.KeyMapper.REPEAT_PROMPT_DELAY)>e.getTime()&&(t=!0,p.Helper.displayLog("Wait until repeat prompt delay expire!"))),t},O.triggerPromptHandler=function(e){void 0===e&&(e=!1),y.Config.store.isNotificationCalledManually||(e&&(y.Config.store.isTriggerPromptWithDelay=!0),y.Config.store.isNotificationCalledManually=!0,O.promptHandler())},O.noRootHandler=function(e){p.Helper.displayLog("No root handler initiated..."),p.Helper.addMsgReciever(O.msgReciever),"granted"==(e=e||p.Helper.getParamFromUrl(document.location.href,"status"))?O.subscriptionHandler().then(function(e){O.sendEvent(S.KeyMapper.PROMPT_ALLOWED,JSON.stringify(e))}).catch(function(e){O.sendEvent(S.KeyMapper.BROWSER_UNSUPPORTED)}):e==S.KeyMapper.ALREADY_GRANTED?(O.subscriptionOnAllow=!1,O.subscriptionHandler().then(function(e){O.sendEvent(S.KeyMapper.ALREADY_GRANTED,JSON.stringify(e))}).catch(function(e){O.sendEvent(S.KeyMapper.BROWSER_UNSUPPORTED)})):"getOldSubscription"==e&&O.httpsGetOldSubscription(!0)},O.httpsNoRootGetOldSubscription=function(){return r(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(t,e){var n;window.top==window.self?(n=(n=y.Config.notification.sourceOrigin+"?action=noroot")+"&izpt="+y.Config.notification.promptType+"&status=getOldSubscription",p.Helper.addMsgReciever(function(e){e=p.Helper.parseToJSON(e.data);!e.hasOwnProperty(S.KeyMapper.MESSAGE)||(e=e[S.KeyMapper.MESSAGE]).hasOwnProperty(S.KeyMapper.OLD_SUBSCRIPTION)&&null!=e[S.KeyMapper.OLD_SUBSCRIPTION]&&t(e[S.KeyMapper.OLD_SUBSCRIPTION])},!0),p.Helper.addIFrame(n,"izSubFrame")):O.noRootHandler()})]})})},O.httpsGetOldSubscription=function(r){return void 0===r&&(r=!1),new Promise(function(t,e){try{var n=!1,i=!1,o=function(e){0==i&&(i=!0,r&&p.Helper.postMessage("parent",S.KeyMapper.OLD_SUBSCRIPTION,n),p.Helper.displayLog(e),t(n))};setTimeout(function(){o("SW Registration not found!")},1500),navigator.serviceWorker.ready.then(function(e){-1==e.scope.indexOf(y.Config.notification.domainRoot)?o(y.Config.brandingPartner+" sw not found found !"):e.pushManager.getSubscription().then(function(e){e&&(n=JSON.stringify(e)),o("SW Registration found!"),p.Helper.displayLog("Recovered Subscription : ",n)}).catch(function(){p.Helper.displayLog("Not Resolved")})})}catch(e){}})},O.noRootVersionHandler=function(){f.IndexedDB.addUpdate("noRootAllowed",1).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})},O.getResponseCode=function(e){var t={};t[S.KeyMapper.PROMPT_ALLOWED]={response:"subscribed",statuscode:1},t[S.KeyMapper.SUBSCRIBED]={response:"subscribed",statuscode:1},t[S.KeyMapper.ALREADY_GRANTED]={response:"already subscribed",statuscode:2},t[S.KeyMapper.PROMPT_DENIED]={response:"blocked",statuscode:3},t[S.KeyMapper.ALREADY_DENIED]={response:"already blocked",statuscode:4},t[S.KeyMapper.BROWSER_UNSUPPORTED]={response:"browser not supported",statuscode:5},t[S.KeyMapper.PROMPT_CLOSED]={response:"prompt closed",statuscode:6},t[S.KeyMapper.UNSUBSCRIBED]={response:"soft unsubscribed",statuscode:7},t[S.KeyMapper.ALREADY_UNSUBSCRIBED]={response:"already soft unsubscribed",statuscode:8},t[S.KeyMapper.OPTIN_ALLOWED]={response:"soft subscribed",statuscode:9},t[S.KeyMapper.SUBSCRIBER_REGISTRED]={response:"subscriber reregistered",statuscode:10};var n={};return n[S.KeyMapper.OPTIN_SHOWN]={response:"soft prompt displayed",statuscode:1},n[S.KeyMapper.OPTIN_CLOSED]={response:"soft prompt closed",statuscode:2},n[S.KeyMapper.PROMPTED]={response:"native prompt displayed",statuscode:3},n[S.KeyMapper.POPUP_OPEN]={response:"prompt window opened",statuscode:4},n[S.KeyMapper.POPUP_CLOSED]={response:"prompt window closed",statuscode:5},void 0!==t[e]?t[e]:void 0!==n[e]?n[e]:void 0},O.sendEvent=function(n,i){var o=this;if(p.Helper.displayLog("Event caught : ",n),M.ChannelEventHandler.event("webPush",n),T.NewsHub.sendEvent(n),O.CBUEvent(n),1!=y.Config.notification.windowType&&6!=y.Config.notification.windowType){var r=[S.KeyMapper.PROMPT_ALLOWED,S.KeyMapper.SUBSCRIBED,S.KeyMapper.ALREADY_GRANTED,S.KeyMapper.PROMPT_DENIED,S.KeyMapper.ALREADY_DENIED,S.KeyMapper.BROWSER_UNSUPPORTED,S.KeyMapper.PROMPT_CLOSED,S.KeyMapper.UNSUBSCRIBED,S.KeyMapper.ALREADY_UNSUBSCRIBED,S.KeyMapper.OPTIN_ALLOWED],a=[S.KeyMapper.OPTIN_SHOWN,S.KeyMapper.OPTIN_CLOSED,S.KeyMapper.PROMPTED,S.KeyMapper.POPUP_OPEN,S.KeyMapper.POPUP_CLOSED],s=l([S.KeyMapper.PROMPT_ALLOWED,S.KeyMapper.ALREADY_GRANTED,S.KeyMapper.PROMPT_DENIED],y.Config.notification.eventsToSync);n!=S.KeyMapper.PROMPT_ALLOWED&&n!=S.KeyMapper.ALREADY_GRANTED||(O.syncPIDset(),g.GDPR.init(),O.syncHookInDb("syncNotificationView"),O.syncHookInDb("syncNotificationClick")),n==S.KeyMapper.PROMPT_ALLOWED&&""!=y.Config.notification.sourceOriginAlt&&O.removeSubsriptionFromAlternateDomain(),n!=S.KeyMapper.PROMPTED&&n!=S.KeyMapper.OPTIN_SHOWN||(O.updatePromptCount(n),O.setActivePrompt(5),d.Storage.removeStorage(S.KeyMapper.PUSH_TOKEN),0!=y.Config.notification.repeatPromptDelay&&O.setRepeatPromptDelay(y.Config.notification.repeatPromptDelay)),n==S.KeyMapper.OPTIN_CLOSED&&0!=y.Config.notification.optInCloseDelay&&O.setRepeatPromptDelay(y.Config.notification.optInCloseDelay),n!=S.KeyMapper.PROMPT_DENIED&&n!=S.KeyMapper.ALREADY_DENIED||(O.syncSendChurn(),O.subscribeOnBlocked()),n==S.KeyMapper.PROMPT_CLOSED&&d.Storage.removeStorage(S.KeyMapper.ACTIVE_PROMPT),f.IndexedDB.getValueFromiDbOptions("pushToken").then(function(e){var t;-1!=s.indexOf(n)&&(o.isSyncPermissionStatus&&O.updatePermissionStatus(n),null!=i?("object"==typeof i&&(i=JSON.stringify(i)),"object"==typeof e&&(e=JSON.stringify(e)),!(t=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN))&&e&&O.saveSubscritionToStorage(e),i!=(e||t)&&O.updateSubscriptionTokenForSync(i),n==S.KeyMapper.PROMPT_ALLOWED||n==S.KeyMapper.ALREADY_GRANTED?O.syncEvent(n,i):O.syncEvent(n)):O.syncEvent(n)),-1!=r.indexOf(n)&&(t=O.getResponseCode(n),n==S.KeyMapper.ALREADY_GRANTED&&(y.Config.store.isSoftSubscribeTriggered&&(t=O.getResponseCode(S.KeyMapper.SUBSCRIBED)),y.Config.store.isSubscriptionLost&&(t=O.getResponseCode(S.KeyMapper.SUBSCRIBER_REGISTRED))),O.subscriptionEventsCallback(n,t)),-1!=a.indexOf(n)&&O.promptDisplayCallback(n,O.getResponseCode(n))})}else try{var t="parent",e=[S.KeyMapper.SUBSCRIBED,S.KeyMapper.ALREADY_GRANTED,S.KeyMapper.PROMPT_DENIED,S.KeyMapper.PROMPT_ALLOWED,S.KeyMapper.PROMPT_CLOSED,S.KeyMapper.ALREADY_DENIED];y.Config.global.isFrame||(t="opener",O.popupNoticeHandler(n)),O.getswVersion().then(function(e){p.Helper.postMessage(t,n,i,e)}).catch(function(e){p.Helper.postMessage(t,n,i),p.Helper.displayLog("Error while getting sw version")}).finally(function(){n==S.KeyMapper.PROMPT_ALLOWED&&O.showWelcomeNotification(!1)&&p.Helper.postMessage(t,"syncWelcomeSent",1),-1<e.indexOf(n)&&"opener"==t&&O.closePopupWindow()})}catch(e){}},O.popupNoticeHandler=function(e){switch(e){case S.KeyMapper.PROMPTED:O.popupNotice(y.Config.notification.clickOnAllowMsg);break;case S.KeyMapper.PROMPT_ALLOWED:O.popupNotice(y.Config.notification.subscribedMsg);break;case S.KeyMapper.ALREADY_GRANTED:O.popupNotice(y.Config.notification.alreadySubscribedMsg);break;case S.KeyMapper.PROMPT_DENIED:O.popupNotice(y.Config.notification.blockedMsg);break;case S.KeyMapper.ALREADY_DENIED:O.popupNotice(y.Config.notification.alreadyDeniedMsg)}},O.subscriptionEventsCallback=function(e,t){try{"function"==typeof i.Queue.subscriptionCallback?i.Queue.subscriptionCallback(t):"function"==typeof i.Queue.userCallback&&(7!=t.statuscode&&8!=t.statuscode||(t={response:"unsubscribed",statuscode:7}),i.Queue.userCallback(t)),h.GoogleAnalytics.isCallbackAllowed(y.Config.ga.subscriptionCallback,t.statuscode)&&h.GoogleAnalytics.process(t.response)}catch(e){console.warn("Error while responding to subscription callback",e)}},O.promptDisplayCallback=function(e,t){try{"function"==typeof i.Queue.promptDisplayCallback&&i.Queue.promptDisplayCallback(t),h.GoogleAnalytics.isCallbackAllowed(y.Config.ga.promptDisplayCallback,t.statuscode)&&h.GoogleAnalytics.process(t.response)}catch(e){console.warn("Error while responding to prompt display callback",e)}},O.callEventOnSubscription=function(e){e==S.KeyMapper.PROMPT_ALLOWED&&(2==y.Config.global.browserType?O.showWelcomeNotificationOld():y.Config.notification.isSdkHttps&&"https:"==y.Config.global.locationProtocol&&O.showWelcomeNotification(!1)),1==y.Config.notification.isShopify&&s.Shopify.init(!0),i.Queue.sync(),m.TabAbandonments.init(),w.VideoDropOff.init(),E.CRPSPlaybook.init(),P.RecommendArticle.init(),O.syncLastVisit(),1==b.AdNetwork.forceSyncAdNetwork&&O.syncAdNetwork(b.AdNetwork.getAdNetworkParam(!0)),_.AutoSegment.init(),y.Config.newsHub.allVisitors||T.NewsHub.init()},O.brandingPartnerSyncSusbcription=function(e,t){"momagic"!=y.Config.brandingPartner.toLowerCase()||e!=S.KeyMapper.PROMPT_ALLOWED&&e!=S.KeyMapper.ALREADY_GRANTED||u.HttpRequest.postForm("https://irctc.truenotify.in/momagicflow/enp",t).then(function(){p.Helper.displayLog("Additional api : "+e+" synced successfully with "+y.Config.brandingPartner)}).catch(function(e){})},O.syncEvent=function(n,i){var e=this;if(0<=y.Config.store.syncedEventList.indexOf(n))p.Helper.displayLog("Abort! This event has been synced already");else{y.Config.store.syncedEventList.push(n);var o={},t=p.Helper.getUTMParamsOfUrl();if(Object.keys(t).length&&Object.keys(t).length&&Object.keys(t).length&&(o=c(c({},o),t)),void 0!==i){if((n==S.KeyMapper.PROMPT_ALLOWED||n==S.KeyMapper.ALREADY_GRANTED)&&(O.callEventOnSubscription(n),O.subscriptionSyncedFromSW))return;if(""!=d.Storage.getStorage(S.KeyMapper.UUID)&&!d.Storage.getConfigLocal(S.KeyMapper.PUSH_TOKEN_NOT_SYNCED))return}p.Helper.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0},i).then(function(t){return r(e,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:switch(o=c(c({},o),t),n){case S.KeyMapper.OPTIN_SHOWN:o.divShow=1;break;case S.KeyMapper.OPTIN_ALLOWED:o.divAllowed=1;break;case S.KeyMapper.OPTIN_CLOSED:o.divClosed=1;break;default:o[n]=1}return n!=S.KeyMapper.PROMPT_ALLOWED&&n!=S.KeyMapper.ALREADY_GRANTED?[3,2]:[4,O.getHTTPSubscriptionParameters(n)];case 1:o=e.sent(),e.label=2;case 2:return u.HttpRequest.postForm(p.Helper.getEndpoint(n),o,!0).then(function(){O.eventSynced(n,i),y.Config.brandingPartner}).catch(function(e){}),O.brandingPartnerSyncSusbcription(n,o),[2]}})})})}},O.eventSynced=function(e,t){e!=S.KeyMapper.PROMPT_ALLOWED&&e!=S.KeyMapper.ALREADY_GRANTED||(d.Storage.removeConfigLocal(S.KeyMapper.PUSH_TOKEN_NOT_SYNCED),t=O.subcriptionToObject(t),f.IndexedDB.addUpdate("pushToken",t),Object.keys(b.AdNetwork.adNetworkObj).map(function(e){b.AdNetwork.adNetworkObj[e]&&d.Storage.setConfigLocal(e,b.AdNetwork.adNetworkObj[e])}))},O.updateSubscriptionTokenForSync=function(e){switch(y.Config.notification.subscriptionType){case 1:case 2:case 3:O.saveSubscritionToStorage(e)}d.Storage.setConfigLocal(S.KeyMapper.PUSH_TOKEN_NOT_SYNCED,1),d.Storage.updateLastSync(S.KeyMapper.PUSH_TOKEN);var t=d.Storage.getStorage(S.KeyMapper.USER_PROPERTY);(t=p.Helper.parseToJSON(t))&&O.syncProperties("SegmentProperties","add",t,function(){return p.Helper.displayLog("User property re-synced succesfully")})},O.saveSubscritionToStorage=function(e){var t=e,n=e;2==y.Config.notification.subscriptionType&&("object"==typeof e&&(t=JSON.stringify(e)),t=encodeURIComponent(t),n=p.Helper.parseToJSON(e)),d.Storage.setStorage(S.KeyMapper.PUSH_TOKEN,t),f.IndexedDB.addUpdate("pushToken",n)},O.syncAdNetwork=function(t){var e=p.Helper.getEndpoint("syncAdNetwork"),n=c({pid:y.Config.client,bkey:y.Config.UUID},t);u.HttpRequest.postForm(e,n,!0).then(function(){Object.keys(t).map(function(e){t[e]&&d.Storage.setConfigLocal(e,t[e])})}).catch(function(e){})},O.syncProperties=function(t,n,i,o){var r=p.Helper.getEndpoint(t),a={},s=!1,e="";switch(t){case"SegmentEvents":e="evt";break;case"SegmentProperties":e="userp";break;case"PersonalProperties":e="pers";break;case"TriggerEvent":e="trg"}"userp"!=(a.et=e)&&"pers"!=e||(s=!0),null!=i?(i=encodeURIComponent(JSON.stringify(i)),a.act=n,a.val=i):a.act=n,O.isSubscriptionExist()?p.Helper.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0}).then(function(e){a=c(c({},a),e),u.HttpRequest.postForm(r,a,s).then(function(){O.syncUserEventCallback(t,n,i),null!=o&&"function"==typeof o&&o()}).catch(function(e){}),"momagic"==y.Config.brandingPartner.toLowerCase()&&"SegmentProperties"==t&&u.HttpRequest.postForm("https://irctc.truenotify.in/momagicflow/up",a,!0).then(function(){p.Helper.displayLog("Additional User property synced successfully with "+y.Config.brandingPartner)}).catch(function(e){})}):p.Helper.displayLog(t+" Aborted! No subscription key or UUID found")},O.isSubscriptionExist=function(){return!(!d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN)||!y.Config.UUID)},O.syncUserEventCallback=function(e,t,n){var i,o,r="";switch(e){case"SegmentEvents":r="User Event";break;case"SegmentProperties":r="User Property";break;case"PersonalProperties":r="Personalization Property";break;case"TriggerEvent":r="Trigger"}1==y.Config.debugger.status&&(i=v.Debugger.getMsgSet(),o=r+": "+(n=decodeURIComponent(n))+" "+i.ev,"SegmentEvents"!=e&&"TriggerEvent"!=e||(o=r+": "+t+" "+i.ev,n&&(o+=" with data "+n)),v.Debugger.log(o,y.Config.debugger.successCode))},O.getSyncCount=function(e,t){var n=new Date,i=n.getDate(),o=n.getMonth()+1,n=d.Storage.getConfigLocal(S.KeyMapper.DM_SYNC_COUNT,S.KeyMapper.STATS);if("event"==e){var r=d.Storage.getConfigLocal(S.KeyMapper.LAST_EVENT_SYNC,S.KeyMapper.SYNC);if(""==r)return 0;var a,s=(a=new Date(r)).getDate(),r=a.getMonth()+1;return t==S.KeyMapper.DAILY?null!=n[S.KeyMapper.EVENT_DAILY]&&i==s?n[S.KeyMapper.EVENT_DAILY]:0:t==S.KeyMapper.MONTHLY?null!=n[S.KeyMapper.EVENT_MONTHLY]&&o==r?n[S.KeyMapper.EVENT_MONTHLY]:0:void 0}if("userProperty"==e){e=d.Storage.getConfigLocal(S.KeyMapper.LAST_PROPERTY_SYNC,S.KeyMapper.SYNC);if(""==e)return 0;s=(a=new Date(e)).getDate(),r=a.getMonth()+1;return t==S.KeyMapper.DAILY?null!=n[S.KeyMapper.PROPERTY_DAILY]&&i==s?n[S.KeyMapper.PROPERTY_DAILY]:0:t==S.KeyMapper.MONTHLY?null!=n[S.KeyMapper.PROPERTY_MONTHLY]&&o==r?n[S.KeyMapper.PROPERTY_MONTHLY]:0:void 0}},O.hasSynclimitReached=function(e){return"event"==e?!y.Config.notification.evtTracking||(y.Config.notification.syncLimit.evtPerMonth<=O.getSyncCount("event",S.KeyMapper.MONTHLY)||y.Config.notification.syncLimit.evtPerDay<=O.getSyncCount("event",S.KeyMapper.DAILY)):"userProperty"==e?!y.Config.notification.propsTracking||(y.Config.notification.syncLimit.propsPerMonth<=O.getSyncCount("userProperty",S.KeyMapper.MONTHLY)||y.Config.notification.syncLimit.propsPerDay<=O.getSyncCount("userProperty",S.KeyMapper.DAILY)):void 0},O.userEventProcessor=function(e,t){if(!y.Config.notification.userEvents)return p.Helper.displayLog("Sync aborted! : User event disabled");var n;O.hasSynclimitReached("event")?p.Helper.displayLog("Sync aborted! : Daily/monthly limit reached!"):(e=O.parseData(e),e=O.filterData(e),O.validateData(e)&&(null!=t&&1<=Object.keys(t).length&&!(n=O.filterProperties(t,{key:32,value:32,object:16},["string","number","boolean"]))?p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD):O.syncProperties("SegmentEvents",e,n,function(){O.increaseSyncCount("event")})))},O.addPropertyProcessorFallback=function(t){var e,n,i;"object"!=typeof t||"string"!=typeof t.name||"string"!=typeof t.value&&"number"!=typeof t.value&&"boolean"!=typeof t.value||""===t.value?p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD):(e=d.Storage.getConfigLocal("subscriberId"))!=t.value?("subscriber_id"==t.name&&t.value&&f.IndexedDB.addUpdate("subscriberId",t.value).then(function(e){y.Config.store.subscriberId=t.value}).catch(function(e){p.Helper.displayLog(e)}),n=p.Helper.getEndpoint("CustomerIDSynch"),(i={}).name=t.name,i.value=t.value,i.operation="add_property",p.Helper.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0}).then(function(e){i=c(c({},i),e),u.HttpRequest.postForm(n,i).then(function(){d.Storage.setConfigLocal("subscriberId",t.value)}).catch(function(e){}),"momagic"==y.Config.brandingPartner.toLowerCase()&&u.HttpRequest.postForm("https://irctc.truenotify.in/momagicflow/up",i).then(function(){p.Helper.displayLog("Additional User property synced successfully with "+y.Config.brandingPartner)}).catch(function(e){})})):p.Helper.displayLog("This subscriber id already synced:",e)},O.increaseSyncCount=function(e){var t,n,i,o=new Date,r=o.getDate(),a=o.getMonth()+1,s=d.Storage.getConfigLocal(S.KeyMapper.DM_SYNC_COUNT,S.KeyMapper.STATS),c=""!=s?s:{};"event"==e?(""==(o=d.Storage.getConfigLocal(S.KeyMapper.LAST_EVENT_SYNC,S.KeyMapper.SYNC))?(c[S.KeyMapper.EVENT_DAILY]=1,c[S.KeyMapper.EVENT_MONTHLY]=1):(n=(t=new Date(o)).getDate(),i=t.getMonth()+1,null!=s[S.KeyMapper.EVENT_DAILY]&&r==n?c[S.KeyMapper.EVENT_DAILY]=s[S.KeyMapper.EVENT_DAILY]+1:c[S.KeyMapper.EVENT_DAILY]=1,null!=s[S.KeyMapper.EVENT_MONTHLY]&&a==i?c[S.KeyMapper.EVENT_MONTHLY]=s[S.KeyMapper.EVENT_MONTHLY]+1:c[S.KeyMapper.EVENT_MONTHLY]=1),d.Storage.updateLastSync(S.KeyMapper.LAST_EVENT_SYNC)):"userProperty"==e&&(""==(e=d.Storage.getConfigLocal(S.KeyMapper.LAST_PROPERTY_SYNC,S.KeyMapper.SYNC))?(c[S.KeyMapper.PROPERTY_DAILY]=1,c[S.KeyMapper.PROPERTY_MONTHLY]=1):(n=(t=new Date(e)).getDate(),i=t.getMonth()+1,null!=s[S.KeyMapper.PROPERTY_DAILY]&&r==n?c[S.KeyMapper.PROPERTY_DAILY]=s[S.KeyMapper.PROPERTY_DAILY]+1:c[S.KeyMapper.PROPERTY_DAILY]=1,null!=s[S.KeyMapper.PROPERTY_MONTHLY]&&a==i?c[S.KeyMapper.PROPERTY_MONTHLY]=s[S.KeyMapper.PROPERTY_MONTHLY]+1:c[S.KeyMapper.PROPERTY_MONTHLY]=1),d.Storage.updateLastSync(S.KeyMapper.LAST_PROPERTY_SYNC)),d.Storage.setConfigLocal(S.KeyMapper.DM_SYNC_COUNT,c,S.KeyMapper.STATS)},O.toTriggerData=function(e,t){var n={},i={},o={collection_viewed:["collection_viewed",{collection_title:"collection_name",collection_link:"collection_url"}],product_viewed:["product_viewed",{product_title:"product_name",product_link:"product_url"}],added_to_cart:["added_to_cart",{product_title:"product_name"}],add_to_cart:["added_to_cart",{product_title:"product_name"}],order_placed:["order_placed",{}],purchased:["order_placed",{}]};if(o.hasOwnProperty(e)&&(n=o[e=o[e][0]][1]),null!=t)for(var r in t)n.hasOwnProperty(r)?i[n[r]]=t[r]:i[r]=t[r];return[e,i]},O.syncAsTrigger=function(e,t){e=O.parseData(e),e=O.filterData(e);var n={product_viewed:["product_browsed"],added_to_cart:["product_addedtocart","product_browsed"],order_placed:["product_addedtocart","product_browsed"]};if(1==y.Config.notification.eventAsTrigger&&0<=["collection_viewed","product_viewed","added_to_cart","add_to_cart","order_placed","purchased"].indexOf(e)){t=O.toTriggerData(e,t);if(0<Object.keys(t[1]).length?O.triggerProcessor(t[0],t[1]):O.triggerProcessor(t[0]),n.hasOwnProperty(t[0])){var i,o=n[t[0]];for(i in o)O.triggerProcessor(o[i])}}},O.triggerProcessor=function(e,t,n){e=O.parseData(e),e=O.filterData(e);var i;O.validateData(e)&&(null!=t&&1<=Object.keys(t).length&&!(i=O.filterProperties(t,{key:32,value:512,object:16},["string"]))?p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD):O.syncProperties("TriggerEvent",e,i))},O.personalizationProcessor=function(e){null!=e&&1<=Object.keys(e).length&&((e=O.filterProperties(e.add,{key:32,value:32,object:1},["number","string"]))?O.syncProperties("PersonalProperties","",e):p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD))},O.userProfileProcessor=function(e){var t,n="",i={key:32,value:32,object:64};if(O.hasSynclimitReached("userProperty"))p.Helper.displayLog("Sync aborted! : Daily/monthly limit reached!");else if(null!=e&&1<=Object.keys(e).length){if(void 0!==e.add&&1<=Object.keys(e.add).length)t=O.filterProperties(e.add,i),n="add";else{if(!(void 0!==e.remove&&1<=Object.keys(e.remove).length))return void p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD);t=O.filterProperties(e.remove,i),n="remove"}if(t){if(O.isPropertySynced(t,n))return p.Helper.displayLog("This property already synced : ",t),void(1==y.Config.debugger.status&&(i="User Property: Already Sent to "+y.Config.brandingPartner,v.Debugger.log(i+" "+JSON.stringify(t),y.Config.debugger.successCode)));O.syncProperties("SegmentProperties",n,t,function(){O.increaseSyncCount("userProperty"),O.propertySynced("userProperty",t,n)})}else p.Helper.displayLog(S.KeyMapper.INVALID_PAYLOAD)}},O.propertySynced=function(e,n,i){var o;void 0===i&&(i="add"),"userProperty"==e&&(o=d.Storage.getStorage(S.KeyMapper.USER_PROPERTY),(o=p.Helper.parseToJSON(o))&&"object"==typeof o?Object.keys(n).forEach(function(t){Array.isArray(n[t])?"add"==i?(0==Array.isArray(o[t])&&(o[t]=[]),n[t].forEach(function(e){-1<o[t].indexOf(e)==0&&o[t].push(e)})):"remove"==i&&Array.isArray(o[t])&&(n[t].forEach(function(e){e=o[t].indexOf(e);-1<e&&o[t].splice(e,1)}),0==o[t].length&&delete o[t]):"remove"==i?delete o[t]:o[t]=n[t]}):o=n,d.Storage.setStorage(S.KeyMapper.USER_PROPERTY,JSON.stringify(o)),O.setUserProperties(o))},O.isPropertySynced=function(e,t){void 0===t&&(t="add");var n=d.Storage.getStorage(S.KeyMapper.USER_PROPERTY);if(!(n=p.Helper.parseToJSON(n))||"remove"==t)return!1;if(n&&"object"==typeof n){var t=Object.keys(e),i=Object.keys(n);if(0==t.every(function(e){return-1<i.indexOf(e)}))return!1;for(var o=!1,r=0,a=t;r<a.length;r++)if("break"===function(t){if(Array.isArray(e[t])){if(0==e[t].every(function(e){return-1<n[t].indexOf(e)}))return o=!0,"break"}else if(n.hasOwnProperty(t)&&n[t]!=e[t])return o=!0,"break"}(a[r]))break;if(o)return!1}return!0},O.filterData=function(e){if("string"==typeof e)return e},O.parseData=function(e){return"string"==typeof e?e.trim():"number"==typeof e?e.toString().trim():e},O.validateData=function(e){if(e.length<=32&&e.length)return!0},O.filterProperties=function(p,d,u){void 0===u&&(u=["number","string","boolean","object"]);try{var f={},g=0;if("object"==typeof p)return Object.keys(p).map(function(e){var t=e;if(e=e.substring(0,d.key),g<d.object&&""!=e.trim()&&e.length<=d.key){var n=(n=e.toLowerCase()).trim();if("string"==typeof(i=p[t])&&""!=i&&-1<u.indexOf(typeof i)){var i,e=(i=i.trim()).substring(0,d.value),t=new RegExp("^(https?)://");""!=i&&(i.length<=d.value||t.test(i))?f[n]=i:f[n]=e,g++}else if("object"==typeof i&&-1<u.indexOf(typeof i)){if(i instanceof Array&&1<=i.length){var o,r=i,a=[],s=0;for(o in r){var c,l=r[o];"number"==typeof(l=l.substring(0,d.value))&&null!=l&&s<=d.object&&l.toString().length<=d.value?(c=l,a.push(c),s++):"string"==typeof l&&""!=l.trim()&&s<=d.object&&l.trim().length<=d.value&&(c=l.trim(),a.push(c),s++)}1<=a.length&&(f[n]=a,g++)}}else("boolean"==typeof i&&-1<u.indexOf(typeof i)||"number"==typeof i&&-1<u.indexOf(typeof i)&&(i.toString().length<=d.value&&null!=i||-1<y.Config.notification.allowedKeys.indexOf(n)))&&(f[n]=i,g++)}}),f}catch(e){}return!1},O.setUserProperties=function(e){f.IndexedDB.addUpdate(S.KeyMapper.USER_PROP,e).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})},O.setIzcidDb=function(e){f.IndexedDB.addUpdate("IZCID",e).then(function(e){}).catch(function(e){p.Helper.displayLog(e)})},O.getIzCidPromise=function(){return new Promise(function(e,t){var n,i=d.Storage.getConfigLocal(S.KeyMapper.IZCID),o=d.Storage.getConfigLocal(S.KeyMapper.IZCID,S.KeyMapper.SYNC);""==i||""==o?(p.Helper.addMsgReciever(O.msgReciever),O.setCookieGlobalID(),""!=(n=d.Storage.getConfigLocal(S.KeyMapper.IZCID))?e(n):setTimeout(function(){e(n),n&&"undefined"!=n&&O.setIzcidDb(n)},2500)):(e(i),i&&"undefined"!=i&&O.setIzcidDb(i))}).catch(function(e){p.Helper.displayLog(e)})},O.setSubscriberIdFromDb=function(){return new Promise(function(t,e){f.IndexedDB.getIndexDBData("options","subscriberId").then(function(e){e?(p.Helper.displayLog("sub id found from db: ",e.val),y.Config.store.subscriberId=e.val,t(y.Config.store.subscriberId)):(p.Helper.displayLog("sub id not found "),t(!1))}).catch(function(e){p.Helper.displayLog("Error in getting sub id",e),t(!1)})})},O.setCookieGlobalID=function(){return new Promise(function(e,t){1!=y.Config.izootoStatus?e(!1):document.getElementById(S.KeyMapper.IZCIDDOM)?y.Config.global.isSetCidLoaded&&e(!0):p.Helper.addIFrame("https://cdn.izooto.com/scripts/sak/iz_setcid.html?v=1",S.KeyMapper.IZCIDDOM).then(function(){y.Config.global.isSetCidLoaded=!0,e(!0)})})},O.isIncognitoMode=function(){var t=this;return new Promise(function(n,e){return r(t,void 0,void 0,function(){var t;return a(this,function(e){switch(e.label){case 0:switch(y.Config.global.browserType){case 1:case 6:case 7:return[3,1];case 3:return[3,3]}return[3,4];case 1:return[4,O.chromePrivateTest()];case 2:return e.sent()?n(!0):n(!1),[3,5];case 3:try{return(t=indexedDB.open("test")).onsuccess=function(){return n(!1)},t.onerror=function(){return n(!0)},[3,5]}catch(e){}e.label=4;case 4:n(!1),e.label=5;case 5:return[2]}})})})},O.getChromiumQuotaLimit=function(){try{var e=window;return void 0!==e.performance&&void 0!==e.performance.memory&&void 0!==e.performance.memory.jsHeapSizeLimit?performance.memory.jsHeapSizeLimit:1073741824}catch(e){return 1073741824}},O.storageQuotaChromePrivateTest=function(){var i=this;return new Promise(function(n,e){try{navigator.webkitTemporaryStorage.queryUsageAndQuota(function(e,t){n(t<i.getChromiumQuotaLimit())},function(e){p.Helper.displayLog("detectIncognito somehow failed to query storage quota: "+e.message),n(!1)})}catch(e){n(!1)}})},O.oldChromePrivateTest=function(){return new Promise(function(e,t){var n=window.RequestFileSystem||window.webkitRequestFileSystem;n?n(0,1,function(){return e(!1)},function(){return e(!0)}):e(!1)})},O.chromePrivateTest=function(){return r(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return void 0===Promise||void 0===Promise.allSettled?[3,2]:[4,this.storageQuotaChromePrivateTest()];case 1:return[2,e.sent()];case 2:return[4,this.oldChromePrivateTest()];case 3:return[2,e.sent()]}})})},O.updatePromptCount=function(e){var t=0;e==S.KeyMapper.PROMPTED?(t=""!=d.Storage.getConfigLocal(S.KeyMapper.PROMPT_COUNT,S.KeyMapper.STATS)?d.Storage.getConfigLocal(S.KeyMapper.PROMPT_COUNT,S.KeyMapper.STATS)+1:1,d.Storage.setConfigLocal(S.KeyMapper.PROMPT_COUNT,t,S.KeyMapper.STATS)):e==S.KeyMapper.OPTIN_SHOWN&&(t=""!=d.Storage.getConfigLocal(S.KeyMapper.OPTIN_SHOWN_COUNT,S.KeyMapper.STATS)?d.Storage.getConfigLocal(S.KeyMapper.OPTIN_SHOWN_COUNT,S.KeyMapper.STATS)+1:1,d.Storage.setConfigLocal(S.KeyMapper.OPTIN_SHOWN_COUNT,t,S.KeyMapper.STATS))},O.getSubscriptionKey=function(e){if(!e)return"";if("string"==typeof(e=O.subcriptionToObject(e)))return e;var t=e.endpoint,e=y.Config.global.browserName;return e==S.KeyMapper.BROWSER_FIREFOX?t.substring(48):(e==S.KeyMapper.BROWSER_OPERA||e==S.KeyMapper.BROWSER_CHROME)&&null!=t&&0<=t.indexOf("fcm.googleapis.com")?t.substring(36):e==S.KeyMapper.BROWSER_EDGE?encodeURIComponent(t.substring(41)):e==S.KeyMapper.BROWSER_UCB?t.substring(36):t.substring(40)},O.getSubscriptionParameters=function(e){try{var t={};return 3==y.Config.notification.subscriptionType?t={bKey:y.Config.UUID,st:e}:2==y.Config.notification.subscriptionType?(e=O.subcriptionToObject(e),t={bKey:y.Config.UUID,ep:7==y.Config.global.browserType?encodeURIComponent(e.endpoint):e.endpoint,auth:e.keys.auth,pk:e.keys.p256dh,vpk:y.Config.notification.vapidKey}):1==y.Config.notification.subscriptionType&&(t={bKey:y.Config.UUID,fe:1,ft:e}),t}catch(e){return p.Helper.displayLog("Error in getSubscriptionParameters",e),{}}},O.getOptinDesignType=function(){return""!=y.Config.notification.optInDesignType?0==y.Config.notification.promptType?0:y.Config.notification.optInDesignType:""},O.getswVersion=function(){return r(this,void 0,void 0,function(){return a(this,function(e){try{return[2,new Promise(function(n,i){setTimeout(function(){f.IndexedDB.getIndexDBData("options","swVer").then(function(e){var t=e.val;e.hasOwnProperty("key")?n(t):i(!1)}).catch(function(e){p.Helper.displayLog(e),i(!1)})},50)})]}catch(e){p.Helper.displayLog(e)}return[2]})})},O.createWelcomeNotification=function(){var e;1===y.Config.notification.welcomeNotification.status&&""!=y.Config.notification.welcomeNotification.icon&&""!=y.Config.notification.welcomeNotification.title&&""!=y.Config.notification.welcomeNotification.body&&((e=new window.Notification(y.Config.notification.welcomeNotification.title,{icon:y.Config.notification.welcomeNotification.icon,body:y.Config.notification.welcomeNotification.body,tag:"welcome"})).addEventListener("click",function(){""!=y.Config.notification.welcomeNotification.url?(e.close(),window.open(y.Config.notification.welcomeNotification.url,"_blank")):e.close()}),0<y.Config.notification.welcomeNotification.timeout&&setTimeout(function(){e.close()},y.Config.notification.welcomeNotification.timeout))},O.showWelcomeNotificationOld=function(){1===y.Config.notification.welcomeNotification.status&&""!=y.Config.notification.welcomeNotification.icon&&""!=y.Config.notification.welcomeNotification.title&&""!=y.Config.notification.welcomeNotification.body&&1==y.Config.notification.isSdkHttps&&O.createWelcomeNotification()},O.sendLocalNotification=function(a){return navigator.serviceWorker.ready.then(function(e){var t={},n={};n.pid=a.key,n.link=a.link,n.cid=a.id,n.rid=a.rid,n.viewFlag=a.viewFlag,n.clickFlag=a.clickFlag,n.sysEvents=a.sysEvents,n.domainNum=a.domainNum;var i={body:a.message,icon:a.icon,requireInteraction:a.reqInt,tag:a.tag,image:a.banner,data:n};if(0<a.act_num&&a.act1name&&a.act1link){var o,r={action:"action1",title:a.act1name};return a.hasOwnProperty("act1icon")&&""!=a.act1icon&&(r.icon=a.act1icon),n.act1link=a.act1link,t=[r],2==a.act_num&&a.act2name&&a.act2link&&(o={action:"action2",title:a.act2name},a.hasOwnProperty("act2icon")&&""!=a.act2icon&&(o.icon=a.act2icon),n.act2link=a.act2link,t=[r,o]),i.actions=t,e.showNotification(a.title,i)}return e.showNotification(a.title,i)})},O.customizeOptInPrompt=function(e){var t={title:50,message:100,allowButton:10,laterButton:10};try{for(var n in e)""!=e[n]&&(e[n]=e[n].trim(),"title"==n?y.Config.notification.promptDesign.message=e[n].substring(0,t[n]):"message"==n?y.Config.notification.promptDesign.subMessage=e[n].substring(0,t[n]):"icon"!=n||!e[n].startsWith("http://")&&!e[n].startsWith("https://")||e[n].includes("panel.izooto")?"allowButton"==n?y.Config.notification.promptDesign.btn2Txt=e[n].substring(0,t[n]):"laterButton"==n&&(y.Config.notification.promptDesign.btn1Txt=e[n].substring(0,t[n])):y.Config.notification.promptDesign.icon=e[n])}catch(e){p.Helper.displayLog(e)}},O.registerServiceWorker=function(){return new Promise(function(t,e){var n;"serviceWorker"in navigator?(n=(n=y.Config.notification.serviceWorkerScope)?{scope:n}:void 0,navigator.serviceWorker.register(y.Config.notification.serviceWorkerPath,n).then(function(){O.getswVersion().then(function(e){e&&"undefined"!=e&&(y.Config.notification.serviceWorkerVersion=e,t(e))}).catch(function(e){t(void 0),p.Helper.displayLog("swVersion undefined",e)}),y.Config.notification.windowType||(f.IndexedDB.setIndexedDb("gaId"),f.IndexedDB.setIndexedDb("sysEvents"))}).catch(function(e){t(void 0),p.Helper.displayLog(e)})):(p.Helper.displayLog("Service workers are not supported in this browser."),t(void 0))}).catch(function(e){p.Helper.displayLog(e)})},O.sendMsgToSW=function(t,o){return r(this,void 0,void 0,function(){return a(this,function(e){return[2,new Promise(function(n,i){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data,e=(t=p.Helper.parseToJSON(t)).izootoSWToSDKSender;e&&e.izootoSWSubscribe&&((t=e.izootoSWSubscribe).error?i(e.izootoSWSubscribe):(t.hasOwnProperty(S.KeyMapper.SUBSCRIPTION_SYNCED)&&(O.subscriptionSyncedFromSW=t[S.KeyMapper.SUBSCRIPTION_SYNCED]),n(t.subscription)))},(navigator.serviceWorker.controller||t.watiting||t.installing||t.active).postMessage(JSON.stringify({izootoSDKToSWSender:o}),[e.port2])})]})})},O.getHTTPSubscriptionParameters=function(n){return r(this,void 0,void 0,function(){var t;return a(this,function(e){return t={},[2,p.Helper.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0}).then(function(e){(t=c(c({},t),e)).bKey=y.Config.UUID,t.vpk=y.Config.notification.vapidKey;e=p.Helper.getUTMParamsOfUrl();Object.keys(e).length&&(t=c(c({},t),e));e=b.AdNetwork.getAdNetworkParam(!0);return null!=e&&"undefined"!=e&&(t=c(c({},t),e)),O.subscriptionSource&&(t.ss=O.subscriptionSource),n!=S.KeyMapper.ALREADY_GRANTED&&n!=S.KeyMapper.PROMPT_ALLOWED||(t[n]=1),p.Helper.removeUndefinedValuesFromObj(t)})]})})},O.subscribeFromSW=function(){return r(this,void 0,void 0,function(){return a(this,function(e){return[2,O.getHTTPSubscriptionParameters().then(function(e){var o={izootoSWSubscribe:{endpoint:p.Helper.getEndpoint(S.KeyMapper.PROMPT_ALLOWED),postData:e}};return new Promise(function(n,i){navigator.serviceWorker.ready.then(function(t){O.getswVersion().then(function(e){!e||e<O.minSWVersion?i("sw version condtion not met => "+e):O.sendMsgToSW(t,JSON.stringify(o)).then(function(e){n(e)}).catch(function(e){i(e)})}).catch(function(e){i("rejecting sw version undefined")})})})})]})})},O.subscriptionHandler=function(){var e=this;return new Promise(function(i,o){return r(e,void 0,void 0,function(){var t,n;return a(this,function(e){switch(e.label){case 0:if(t=function(){O.subscribe().then(function(e){i(e)}).catch(function(e){o(e)})},!(n=O.getPushTokenFromLStorage()))return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,f.IndexedDB.addUpdate("pushToken",n)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return O.registerServiceWorker().then(function(){y.Config.notification.swSubscribe,y.Config.notification.serviceWorkerVersion,y.Config.notification.swSubscribe?O.subscribeFromSW().then(function(e){i(e)}).catch(function(){t()}):O.subscriptionOnAllow?t():navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){e||(y.Config.store.isSubscriptionLost=!0),t()})})}).catch(function(e){o({error:S.KeyMapper.BROWSER_UNSUPPORTED})}),[2]}})})})},O.subscribe=function(){return r(this,void 0,void 0,function(){return a(this,function(e){return y.Config.notification.subscriptionObj={userVisibleOnly:!0,applicationServerKey:p.Helper.urlB64ToUint8Array(y.Config.notification.vapidKey)},[2,new Promise(function(n,i){p.Helper.displayLog("Subscription initiated..."),navigator.serviceWorker.ready.then(function(e){e.pushManager.subscribe(y.Config.notification.subscriptionObj).then(function(e){p.Helper.displayLog("Subscrption : ",JSON.stringify(e)),n(e)}).catch(function(t){p.Helper.displayLog("Unable to subscribe due to error : ",t),null!=t.message&&(-1<t.message.indexOf("push service error")||-1<t.message.indexOf("User denied permission to use the Push API"))?(p.Helper.displayLog("Browser does not have complete support of vapid"),i({error:S.KeyMapper.BROWSER_UNSUPPORTED})):e.pushManager.getSubscription().then(function(e){if(!e)throw t;p.Helper.displayLog("Unexpected subscription found! Unsubscribing...",JSON.stringify(e)),e.unsubscribe().then(function(){p.Helper.displayLog("Re Subscribing..."),n(O.subscribe())})}).catch(function(e){i({error:e})})})})})]})})},O.unsubscribeNotification=function(){p.Helper.displayLog("Notification unsubscribe is initiated..."),navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){e&&e.unsubscribe().then(function(e){p.Helper.displayLog("Unsubscribed : ",e)}).catch(function(e){p.Helper.displayLog("Unsubscription failed : ",e)})}).catch(function(e){p.Helper.displayLog("Get subscription failed : ",e)})}).catch(function(e){})},O.closePopupWindow=function(){if(self==top&&y.Config.notification.windowType)try{setTimeout(function(){var e={};e[S.KeyMapper.POPUP_CLOSED]=1;var t={};t[S.KeyMapper.MESSAGE]=e,null!==(e=window.opener)&&void 0!==e&&e.postMessage(JSON.stringify(t),"*"),window.close()},1e3)}catch(e){p.Helper.displayLog(e)}},O.removeSubsriptionFromAlternateDomain=function(){var e,t=d.Storage.getConfigLocal(S.KeyMapper.ALT_DOMAIN_STATUS);if(""!=t)try{t=JSON.parse(t),O.alternateDomainJson=t}catch(e){t=""}"object"==typeof y.Config.notification.sourceOriginAlt&&1<y.Config.notification.sourceOriginAlt.length?(e=y.Config.notification.sourceOriginAlt.length,O.alternateDomainPermissionHandler(0,e-1,O.alternateDomainJson)):(e="object"==typeof y.Config.notification.sourceOriginAlt?y.Config.notification.sourceOriginAlt[0]:y.Config.notification.sourceOriginAlt,3==(e=O.getAlternateDomainConfig(O.alternateDomainJson,O.permissionDomain=e))||2==e||(p.Helper.addMsgReciever(O.msgReciever),"https:"==y.Config.global.locationProtocol?p.Helper.addIFrame(O.permissionDomain+"?action=izrmsubs&izHardUnsub=1","izAltSubFrame"):p.Helper.addIFrame(O.permissionDomain+"?action=izrmsubs","izAltSubFrame")))},O.removeSubscriptionReceiver=function(e){3==e&&(O.setAlternateDomainConfig(O.alternateDomainJson,O.permissionDomain,e),"object"==typeof y.Config.notification.sourceOriginAlt&&O.alternateDomainIndex<y.Config.notification.sourceOriginAlt.length&&O.alternateDomainPermissionHandler(O.sourceOriginIndex,y.Config.notification.sourceOriginAlt.length-1,O.alternateDomainJson))},O.alternateDomainPermissionHandler=function(e,t,n){for(var i=e;i<=t;i++){O.permissionDomain=y.Config.notification.sourceOriginAlt[i];var o=O.getAlternateDomainConfig(n,O.permissionDomain);if(O.sourceOriginIndex=i+1,3!=o&&2!=o){p.Helper.addMsgReciever(O.msgReciever),"https:"==y.Config.global.locationProtocol?p.Helper.addIFrame(O.permissionDomain+"?action=izrmsubs&izHardUnsub=1","izAltSubFrame"+i):p.Helper.addIFrame(O.permissionDomain+"?action=izrmsubs","izAltSubFrame"+i);break}if(i==t)return}},O.getAlternateDomainConfig=function(e,t){return null!=e[t]?e[t]:""},O.setAlternateDomainConfig=function(e,t,n){e=""!=e?e:{};e[t]=n,O.alternateDomainJson=e,e=JSON.stringify(e),d.Storage.setConfigLocal(S.KeyMapper.ALT_DOMAIN_STATUS,e)},O.getPushTokenFromLStorage=function(){var e="";return(e=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN))&&p.Helper.isJSONString(e)&&(e=decodeURIComponent(e),e=p.Helper.parseToJSON(e)||{}),e},O.removeSubscriptionInFrame=function(){var e="rmSubToParent",t={izrmstatus:3},n=document.location.href,n=p.Helper.getParamFromUrl(n,"izHardUnsub");try{var i,o=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN);1==n?(O.unsubscribeNotification(),p.Helper.postMessage("parent",e,t)):""!=o?(i=y.Config.UUID,O.sendSubscriptionUpdate(i,2,function(){p.Helper.postMessage("parent",e,t)})):p.Helper.postMessage("parent",e,t)}catch(e){}},O.syncLastVisit=function(){var e=p.Helper.getLanguage(),t=p.Helper.getMetaValue("keywords"),n={last_website_visit:!0};""!=e&&(n.lang=e),""!=t&&(n.keywords=t);var i=new Date,e=d.Storage.getConfigLocal("lastVisit",S.KeyMapper.SYNC),t=!1;e&&(t=new Date(e).getDate()),O.syncAllSubscribersVisit(),""!=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN)&&i.getDate()!==t?(t=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN),t=p.Helper.isJSONString(t)?p.Helper.parseToJSON(t):t,n={pid:y.Config.client,et:"userp",act:"add",val:JSON.stringify(n)},n=c(c({},n),O.getSubscriptionParameters(t)),u.HttpRequest.postForm(p.Helper.getEndpoint("last_visit"),n).then(function(){d.Storage.updateLastSync("lastVisit")}).catch(function(e){})):p.Helper.displayLog("Sync last Visit Blocked")},O.syncAllSubscribersVisit=function(){var e,t,n,i;1==y.Config.notification.syncVisitType&&(e=p.Helper.getEndpoint("syncAllSubscribersVisit"),t=p.Helper.getLanguage(),n=p.Helper.getMetaValue("keywords"),i=encodeURIComponent([window.location.protocol,"//",window.location.host,window.location.pathname].join("")),i={pid:y.Config.client,bkey:y.Config.UUID,url:i},""!=n&&(i.keywords=n),""!=t&&(i.lang=t),u.HttpRequest.postForm(e,i).catch(function(e){}))},O.applyBrowserPatch=function(){1==y.Config.global.browserType&&0==y.Config.notification.promptType&&(61<parseInt(y.Config.global.browserVer)||60<parseInt(y.Config.global.browserVer)&&1!=y.Config.global.deviceType)&&(!y.Config.notification.isSdkHttps||y.Config.notification.isSdkHttps&&"http:"==y.Config.global.locationProtocol)&&(y.Config.notification.promptType=1,y.Config.notification.optInDesignType||(y.Config.notification.optInDesignType=1)),2==y.Config.global.browserType&&0==y.Config.notification.promptType&&12.1<=parseFloat(y.Config.global.browserVer)&&(y.Config.notification.promptType=1,y.Config.notification.optInDesignType||(y.Config.notification.optInDesignType=1)),3==y.Config.global.browserType&&0==y.Config.notification.promptType&&72<=y.Config.global.browserMajorVersion&&(y.Config.notification.promptType=1,y.Config.notification.optInDesignType||(y.Config.notification.optInDesignType=1))},O.isSupported=function(){return r(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return y.Config.global.browserName==S.KeyMapper.BROWSER_FIREFOX&&"http:"==y.Config.global.locationProtocol?[2,!1]:[4,O.isIncognitoMode()];case 1:return e.sent()?(y.Config.global.isIncoginito=!0,p.Helper.displayLog("Incognito mode detected!"),[2,!1]):[2,O.isPushSupported()]}})})},O.isPushSupported=function(){return!!O.isVapidSupported()||"safari"in window&&"pushNotification"in window.safari},O.isVapidSupported=function(){return!!("https:"==y.Config.global.locationProtocol&&(y.Config.notification.isSdkHttps||1==y.Config.notification.windowType&&0==y.Config.notification.isSdkHttps)&&"Notification"in window&&"serviceWorker"in navigator)},O.loadOptin=function(){return r(this,void 0,void 0,function(){var t,n;return a(this,function(e){return t=y.Config.notification.optInSrc,n=y.Config.notification.optInDesignType,n=t+""+n+".js?v=3",""!=y.Config.notification.optInDesign?(y.Config.notification.dialogDesign=y.Config.notification.optInDesign,O.showOptin()):null!=window.izOptinDesign&&""!=window.izOptinDesign?(y.Config.notification.dialogDesign=window.izOptinDesign,O.showOptin()):p.Helper.addExternalJS(n,"izOptin",!0),[2]})})},O.showOptin=function(){var e;if(null!=window.izOptinDesign&&(y.Config.notification.dialogDesign=window.izOptinDesign),y.Config.notification.dialogDesign=O.loadDesign(y.Config.notification.promptDesign,y.Config.notification.dialogDesign),y.Config.notification.dialogDesign=O.dynamicBrandingPartnerHandler(y.Config.notification.dialogDesign),p.Helper.addHTML("div",y.Config.notification.dialogDesign,"izmiddle-box"))try{y.Config.brandingPartner!=y.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izmiddle-box a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}p.Helper.izootoBrandingHandler(),O.sendEvent(S.KeyMapper.OPTIN_SHOWN)},O.dynamicBrandingPartnerHandler=function(e){return e=y.Config.brandingPartner!=y.Config.defaultBrandingPartner?y.Config.notification.dialogDesign.replace("iZooto",y.Config.brandingPartner):e},O.loadDesign=function(e,t){try{if("object"!=typeof e)return"";for(var n in e){var i;e.hasOwnProperty(n)&&(i=new RegExp("{{--"+n+"--}}","g"),t=t.replace(i,e[n]))}}catch(e){}return t},O.getPermissionStatusFromFrame=function(){return new Promise(function(t,e){p.Helper.addMsgReciever(function(e){e=p.Helper.parseToJSON(e.data);!e.hasOwnProperty(S.KeyMapper.MESSAGE)||(e=e[S.KeyMapper.MESSAGE]).hasOwnProperty("izPermsStatus")&&null!=e.izPermsStatus&&t(e.izPermsStatus)},!0);var n=y.Config.notification.sourceOrigin+"?action=izcheckperms";p.Helper.addIFrame(n,"izPermsFrame")})},O.getSubDomainPermissionStatus=function(){return new Promise(function(t,e){var n=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN),i=d.Storage.getStorage(S.KeyMapper.PERMISSION_STATUS),o=O.getPermissionStatusFromStorage();0!=o||2==i?t(o):"https:"==y.Config.global.locationProtocol?O.getPermissionStatusFromFrame().then(function(e){O.updatePermissionStatus(e=1==e&&""!=n?0:e),t(e)}):""!=n?O.tokenValidator(function(e){O.updatePermissionStatus(e),t(e)}):t(o)}).catch(function(e){p.Helper.displayLog(e)})},O.setRepeatPromptDelay=function(e){var t;0!==e&&(t=(t=new Date).setTime(t.getTime()+60*e*1e3),d.Storage.setConfigLocal(S.KeyMapper.REPEAT_PROMPT_DELAY,t))},O.setActivePrompt=function(e){var t;("https:"===y.Config.global.locationProtocol&&0==y.Config.notification.windowType||"http:"===y.Config.global.locationProtocol)&&(window.addEventListener("beforeunload",function(){d.Storage.removeStorage(S.KeyMapper.ACTIVE_PROMPT)}),t=(t=new Date).setTime(t.getTime()+60*e*1e3),d.Storage.setStorage(S.KeyMapper.ACTIVE_PROMPT,t))},O.isActivePrompt=function(){var e=new Date;return d.Storage.getStorage(S.KeyMapper.ACTIVE_PROMPT)>e.getTime()},O.updatePermissionStatus=function(e){e===S.KeyMapper.PROMPT_ALLOWED||e===S.KeyMapper.ALREADY_GRANTED||1===e?d.Storage.setConfigLocal(S.KeyMapper.PERMISSION_STATUS,1):e===S.KeyMapper.PROMPT_DENIED||e===S.KeyMapper.ALREADY_DENIED||2==e?d.Storage.setConfigLocal(S.KeyMapper.PERMISSION_STATUS,2):d.Storage.setConfigLocal(S.KeyMapper.PERMISSION_STATUS,0),d.Storage.updateLastSync(S.KeyMapper.PERMISSION_STATUS)},O.sendPermissionStatusFromFrame=function(){var e=0;"Notification"in window&&"granted"==window.Notification.permission&&(e=1),p.Helper.postMessage("parent","izPermsStatus",e)},O.updateSubscriptionProcessor=function(e,t){var n=y.Config.UUID,i=d.Storage.getConfigLocal(S.KeyMapper.PERMISSION_STATUS);t=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN);t=O.getSubscriptionKey(t);"subscribe"==e?y.Config.store.isSoftSubscribeTriggered||(""!=t&&""!=n&&O.sendSubscriptionUpdate(n,0,function(){p.Helper.displayLog("Re-Subscribing")}),y.Config.store.isSoftSubscribeTriggered=!0,3==i&&d.Storage.removeConfigLocal(S.KeyMapper.PERMISSION_STATUS),O.triggerPromptHandler()):"unsubscribe"==e&&""!=t&&""!=n&&O.sendSubscriptionUpdate(n,2,function(){d.Storage.setConfigLocal(S.KeyMapper.PERMISSION_STATUS,3),O.sendEvent(S.KeyMapper.UNSUBSCRIBED)})},O.sendSubscriptionUpdate=function(t,n,i){var o=0==n?p.Helper.getEndpoint("SoftSubscribe"):2==n?p.Helper.getEndpoint("SoftUnsubscribe"):p.Helper.getEndpoint("supUrl");p.Helper.getFlagBasedParameter().then(function(e){e.bKey=t,e.action=n,e.izcid=d.Storage.getConfigLocal(S.KeyMapper.IZCID),e.ht="https:"==y.Config.global.locationProtocol?1:0,u.HttpRequest.postForm(o,e).then(function(){i()}).catch(function(e){})})},O.scrollHandler=function(e){var t=window.screen.availHeight,n=window.scrollY;1!=y.Config.notification.isTriggeredOnScoll&&(t<=n||document.documentElement.scrollTop>=t)&&(y.Config.notification.isTriggeredOnScoll=1,e())},O.brandingOverlayHandler=function(){1==y.Config.notification.overlay?O.openHttpsOverlay():1==y.Config.branding&&O.openHttpsBranding()},O.openHttpsBranding=function(){var e;if(!(0<y.Config.notification.windowType)&&0!=y.Config.branding){if(1!=p.Helper.getDeviceType())try{window.addEventListener("scroll",O.brandingScroll)}catch(e){}if(p.Helper.addHTML("div",y.Config.notification.httpsBranding,"izooto-branding"))try{y.Config.brandingPartner!=y.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izooto-branding a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}p.Helper.izootoBrandingHandler()}},O.openHttpsOverlay=function(){var e;if(!(0<y.Config.notification.windowType)&&0!=y.Config.notification.overlay){if(1!=p.Helper.getDeviceType())try{window.addEventListener("scroll",O.brandingScroll)}catch(e){}if((y.Config.global.browserName=S.KeyMapper.BROWSER_CHROME)&&62<parseInt(p.Helper.getBrowserVersion())&&3==p.Helper.getDeviceType()&&(y.Config.notification.httpsOverlay=""),p.Helper.addHTML("div",y.Config.notification.httpsOverlay,"izooto-branding"))try{y.Config.brandingPartner!=y.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izooto-branding a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}p.Helper.izootoBrandingHandler()}},O.brandingScroll=function(){null!=document.getElementById("izooto-branding")&&(30<window.pageYOffset||30<document.body.scrollTop)&&O.closeHttpsOverlay()},O.closeHttpsOverlay=function(){var e;if(!(0<y.Config.notification.windowType)){try{null!==(e=document.getElementById("izooto-branding"))&&void 0!==e&&e.remove()}catch(e){p.Helper.displayLog("Error-Removing-Div"+e)}if(1!=p.Helper.getDeviceType())try{window.removeEventListener("scroll",O.brandingScroll)}catch(e){}}},O.popupNotice=function(e){try{document.getElementById("dynamic_iz").innerHTML="<center>"+e+"</center>"}catch(e){}},O.setManifest=function(){try{if(1!=y.Config.global.browserType||0!=y.Config.notification.subscriptionType)return;var e=document.getElementsByTagName("head")[0],t=document.createElement("link");t.rel="manifest",t.href=y.Config.notification.manifest,e.appendChild(t)}catch(e){}},O.tokenValidator=function(n,e){null==e&&(e=y.Config.UUID);e=p.Helper.getEndpoint("subscriptionValidator")+"?s=1&bkey="+e+"&pid="+y.Config.client;u.HttpRequest.get(e).then(function(e){var t=1;e=p.Helper.parseToJSON(e),null!=n&&(e.hasOwnProperty("status")&&0==e.status&&(t=0),n(t))}).catch(function(){})},O.checkAlternates=function(){"object"==typeof window._izAlternate?(null!=window._izAlternate.initAlt&&"function"==typeof window._izAlternate.initAlt&&window._izAlternate.initAlt(),Object.keys(window._izAlternate).map(function(n,e){Object.keys(window._izooto).map(function(e,t){e===n&&(window._izooto[e]=window._izAlternate[n])})})):p.Helper.displayLog("No alternate implementations found")},O.subcriptionToObject=function(e){return e="string"==typeof e&&p.Helper.isJSONString(e)?p.Helper.parseToJSON(e):e},O.isCurrentTokenExpired=function(e,t){var n=d.Storage.getConfigLocal(t,S.KeyMapper.SYNC),t=new Date;return!(t.getTime()<t.setTime(n+1e3*e))},O.isPermissionStatusExpired=function(e){return 1==e&&O.isCurrentTokenExpired(y.Config.notification.tokenExpire,S.KeyMapper.PERMISSION_STATUS)},O.getPermissionStatusFromStorage=function(){var e=0,t=d.Storage.getConfigLocal(S.KeyMapper.PERMISSION_STATUS);return e=""!=t&&!this.isPermissionStatusExpired(t)?t:e},O.isHttpsSitePermissionAlreadyGranted=function(){return!!(y.Config.notification.isSdkHttps&&y.Config.notification.isSupported&&"granted"==window.Notification.permission&&2!=y.Config.global.browserType||2==y.Config.global.browserType&&"16"<=y.Config.global.browserVer)},O.getWindowType=function(){var e=window.location.href.toLocaleLowerCase(),t="";return-1!==(t=e.substr(e.lastIndexOf("?")+1)).indexOf("action=prompt")?1:-1!==t.indexOf("action=izrmsubs")?2:-1!==t.indexOf("action=izcheckmaster")?3:"action=izcheckperms"==t?4:-1!==t.indexOf("action=izvalidator&izobj=")?5:-1!==t.indexOf("action=noroot")?6:0},O.syncPIDset=function(){d.Storage.getConfigLocal("pidList",S.KeyMapper.SYNC)||O.setCookieGlobalID().then(function(){var e=document.getElementById(S.KeyMapper.IZCIDDOM);d.Storage.updateLastSync("pidList"),p.Helper.postMessage(e,"setAllowedList",y.Config.client)})},O.msgReciever=function(e){var t,e=p.Helper.parseToJSON(e.data);e.hasOwnProperty(S.KeyMapper.MESSAGE)&&(e=e[S.KeyMapper.MESSAGE],p.Helper.displayLog("Received event : ",e),"izCidToParent"==(null==e?void 0:e.k)?(O.setIzcidDb(e.v),d.Storage.setConfigLocal(S.KeyMapper.IZCID,e.v),d.Storage.updateLastSync("IZCID")):"izCidWithPidList"==(null==e?void 0:e.k)?"object"!=typeof e.v||(t=e.v).hasOwnProperty("pidList")&&t.pidList&&d.Storage.setConfigLocal("pidList",t.pidList):e.hasOwnProperty("rmSubToParent")&&void 0!==e.rmSubToParent?O.removeSubscriptionReceiver(e.rmSubToParent.izrmstatus):e.hasOwnProperty(S.KeyMapper.MASTER_TO_CHILD)&&void 0!==e[S.KeyMapper.MASTER_TO_CHILD]?C.MasterDomain.masterConfigReciver(e[S.KeyMapper.MASTER_TO_CHILD]):e.hasOwnProperty(S.KeyMapper.CHILD_TO_MASTER)&&void 0!==e[S.KeyMapper.CHILD_TO_MASTER]?C.MasterDomain.setMasterStorage(e[S.KeyMapper.CHILD_TO_MASTER]):e.hasOwnProperty("izPermsStatus")?(d.Storage.setConfigLocal(S.KeyMapper.PERMISSION_STATUS,e.izPermsStatus),d.Storage.updateLastSync(S.KeyMapper.PERMISSION_STATUS)):e.hasOwnProperty("syncWelcomeSent")?O.showWelcomeNotification(!0):e.hasOwnProperty("sendLocalNotification")?O.sendLocalNotification(e.sendLocalNotification):0<(t=Object.keys(e)).length&&(e.hasOwnProperty("serviceWorkerVersion")&&null!=e.serviceWorkerVersion&&(y.Config.notification.serviceWorkerVersion=e.serviceWorkerVersion,delete e.serviceWorkerVersion),e.hasOwnProperty(S.KeyMapper.SUBSCRIPTION_SYNCED)&&1==e[S.KeyMapper.SUBSCRIPTION_SYNCED]&&(O.subscriptionSyncedFromSW=!0,delete e[S.KeyMapper.SUBSCRIPTION_SYNCED]),t=Object.keys(e),O.sendEvent(t[0],e[t[0]])))},O.syncHookInDb=function(t){var n;"syncNotificationClick"!=t&&"syncNotificationView"!=t||(null!=y.Config.notification.syncNotificationClick||null!=y.Config.notification.syncNotificationView?(n=y.Config.notification[t],f.IndexedDB.getIndexDBData("options",t).then(function(e){(e&&e.hasOwnProperty("val")?e.val:"")!=n&&f.IndexedDB.addUpdate(t,n).then(function(e){}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})):p.Helper.displayLog("Invalid Hook Request"))},O.syncNotificationSent=function(e){e={pid:y.Config.client,bkey:y.Config.UUID,btype:y.Config.global.browserType,dtype:y.Config.global.deviceType,rid:e.rid};u.HttpRequest.postForm(p.Helper.getEndpoint("notificationSent"),e,!0).then(function(){y.Config.brandingPartner}).catch(function(e){})},O.syncNotificationView=function(e){var t={pid:y.Config.client,bkey:y.Config.UUID,cid:e.id,rid:e.rid,op:"view",pl:1};1==e.viewFlag&&(e=p.Helper.getEndpoint("syncNotificationView"),u.HttpRequest.postForm(e,t,!0).catch(function(e){}))},O.showWelcomeNotification=function(e){try{var t=y.Config.welcomePlaybook,n=t.data;return 0==t.status?void 0:(n.viewFlag=1,n.clickFlag=1,n.sysEvents=0,n.domainNum=0,O.getPayloadVerification(n)?e?(O.syncNotificationSent(n),void O.syncNotificationView(n)):O.sendLocalNotification(n).then(function(){return y.Config.notification.isSdkHttps&&!y.Config.notification.httpsNoRoot&&(O.syncNotificationSent(n),O.syncNotificationView(n)),!0}):void p.Helper.displayLog("Welcome playbook : "+S.KeyMapper.INVALID_PAYLOAD))}catch(e){}},O.getPayloadVerification=function(e){return!!(e.title&&e.message&&e.icon&&e.rid&&e.key&&e.id)},O.syncSendChurn=function(){try{var e,t,n,i=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN);i&&(e=O.getSubscriptionParameters(i),t=c({pid:y.Config.client},e),n=p.Helper.getEndpoint("syncClientSideChurn"),u.HttpRequest.postForm(n,t).then(function(){var e=d.Storage.getStorage(S.KeyMapper.PUSH_TOKEN);i==e&&d.Storage.removeStorage(S.KeyMapper.PUSH_TOKEN)}))}catch(e){}},O.CBUEvent=function(e){if(y.Config.convertBlockedUsers.status)switch(e){case S.KeyMapper.PROMPT_ALLOWED:case S.KeyMapper.ALREADY_GRANTED:p.Helper.hideElement("#iz-wp-cbu-dialog");break;case S.KeyMapper.PROMPT_DENIED:case S.KeyMapper.ALREADY_DENIED:O.initCBUDialog()}},O.initCBUDialog=function(){O.isCbuRepeatDelayed()||O.registerEventForCbuDialog()},O.registerEventForCbuDialog=function(){y.Config.convertBlockedUsers.triggerType?O.cbuDialogOnScroll():O.cbuDialogWithDelay()},O.cbuDialogWithDelay=function(){setTimeout(function(){O.isCBURepeatDelayed()},1e3*y.Config.convertBlockedUsers.promptDelay)},O.cbuDialogOnScroll=function(){try{var t;p.Helper.isScreenScrollable()&&(p.Helper.displayLog("onblock prompt will be shown on page scroll!"),t=0,window.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop;t<e&&0<t&&O.isCBURepeatDelayed(),t=e<=0?0:e},!1))}catch(e){}},O.isCBURepeatDelayed=function(){O.isUnBlockPopupInitialize||(O.isUnBlockPopupInitialize=!0,u.HttpRequest.get("https://cdn.izooto.com/webpush/blockedvis/dialog.html").then(function(e){try{if(!e)return;p.Helper.addHTML("div",e,"iz-wp-cbu-dialog"),O.dynamicTitleMesssageHandling(),O.setCbuDialogRepeatPromptDelay(),p.Helper.izootoBrandingHandler(),p.Helper.setHref(".iz-wp-block-dialog-branding-url","https://www.izooto.com/campaign/getting-started-with-izooto?utm_source=referral&utm_medium=convert_blocked_users&utm_campaign="+y.Config.notification.siteUrl),O.registerEventToHideCbuDialog(),O.registerEventToShowUnblockContent()}catch(e){}}).catch(function(e){}))},O.registerEventToHideCbuDialog=function(){try{document.querySelectorAll(".iz-wp-block-dialog-close").forEach(function(e){e.addEventListener("click",function(e){p.Helper.hideElement("#iz-wp-cbu-dialog")})})}catch(e){}},O.registerEventToShowUnblockContent=function(){try{document.querySelector("#iz-wp-block-dialog-show-btn").addEventListener("click",function(e){O.subscriptionSource=3,O.changeContentOnDifferentBrowser(),p.Helper.hideElement("#iz-wp-block-dialog-popup"),p.Helper.showElement("#iz-wp-block-dialog-content")})}catch(e){}},O.dynamicTitleMesssageHandling=function(){try{var e,t,n,i=p.Helper.getDomElement(".iz-wp-block-dialog-title"),o=p.Helper.getDomElement(".iz-wp-block-dialog-message"),r=p.Helper.getDomElement("#iz-wp-block-dialog-show-btn");""!=y.Config.convertBlockedUsers.title&&(e=(e=y.Config.convertBlockedUsers.title.trim()).slice(0,100),i.innerHTML=e),""!=y.Config.convertBlockedUsers.message&&(t=(t=y.Config.convertBlockedUsers.message.trim()).slice(0,100),o.innerHTML=t),""!=y.Config.convertBlockedUsers.btnText&&(n=(n=y.Config.convertBlockedUsers.btnText.trim()).slice(0,20),r.innerHTML=n)}catch(e){}},O.changeContentOnDifferentBrowser=function(){try{for(var e=p.Helper.getDomElement(".iz-wp-block-dialog-browserimage"),t=p.Helper.getDomElement(".iz-wp-block-dialog-browser-content"),n=O.getInstructions(),i=0;i<n.length;i++){var o=document.createElement("li");o.innerHTML=n[i],t.appendChild(o)}e.src=O.getGIFUrl()}catch(e){}},O.getGIFUrl=function(){var e=O.nudgeUserObj();return!!e.hasOwnProperty("type")&&"https://cdn.izooto.com/webpush/blockedvis/"+e.type+".gif"},O.getInstructions=function(){var e=O.nudgeUserObj();return!!e.hasOwnProperty("instructions")&&e.instructions},O.nudgeUserObj=function(){var e=p.Helper.getOSName(),t=p.Helper.getBrowserName()+"_"+e,e={};return e[S.KeyMapper.BROWSER_CHROME+"_"+S.KeyMapper.OS_WINDOWS]={type:1,instructions:["Click on the <b>lock</b> icon in the website address bar.","Enable the <b>Notifications</b> toggle","<b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_CHROME+"_"+S.KeyMapper.OS_MAC]={type:2,instructions:["Click on the <b>lock</b> icon in the website address bar.","Under notifications, enable the toggle and change it to <b>Allow</b>","All Set! <b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_CHROME+"_"+S.KeyMapper.OS_ANDROID]={type:8,instructions:["Tap on the lock icon in the website address bar","Tap on <b>Permissions</b>, and then Reset permissions","All Set! <b>Reload</b> the page and click on Allow when prompted! "]},e[S.KeyMapper.BROWSER_SAFARI+"_"+S.KeyMapper.OS_MAC]={type:3,instructions:["Click on Safari -> Preferences","Under Websites -> Notifications, select Allow from the dropdown","All Set! <b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_FIREFOX+"_"+S.KeyMapper.OS_WINDOWS]={type:4,instructions:["Click on the <b>Notifications</b> icon in the website address bar","Clear the <b>blocked</b> status and reload the page","Click on <b>Allow</b> when prompted to subscribe","All Set! <b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_FIREFOX+"_"+S.KeyMapper.OS_MAC]={type:7,instructions:["Click on the <b>Notifications</b> icon in the website address bar","Clear the <b>blocked</b> status and reload the page","Click on <b>Allow</b> when prompted to subscribe","All Set! Youre good to go! "]},e[S.KeyMapper.BROWSER_FIREFOX+"_"+S.KeyMapper.OS_ANDROID]={type:9,instructions:["Tap on the <b>lock</b> icon in the website address bar","Under notifications, change status to <b>Allowed</b>","All Set! <b>Reload</b> the page and click on Allow when prompted! "]},e[S.KeyMapper.BROWSER_OPERA+"_"+S.KeyMapper.OS_WINDOWS]={type:5,instructions:["Click on the <b>lock</b> icon in the website address bar","Enable the <b>Notifications</b> toggle","All Set! <b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_OPERA+"_"+S.KeyMapper.OS_MAC]={type:6,instructions:["Click on the <b>lock</b> icon in the website address bar","Enable the <b>Notifications</b> toggle","All Set! <b>Reload</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_OPERA+"_"+S.KeyMapper.OS_ANDROID]={type:10,instructions:["Tap on the <b>green tick</b> icon in the website address bar","Under permissions, set notifications as <b>Allowed</b>.","All Set! <b>Reload</b> the page and click on Allow when prompted! "]},e[S.KeyMapper.BROWSER_EDGE+"_"+S.KeyMapper.OS_WINDOWS]={type:11,instructions:["Click on the <b>lock</b> icon in the website address bar","Under <b>Permissions</b> for the site, click on <b>Allow</b> notifications","All Set! <b>Refresh</b> the page and youre good to go! "]},e[S.KeyMapper.BROWSER_EDGE+"_"+S.KeyMapper.OS_MAC]={type:12,instructions:["Click on the bell icon in the website address bar","Click on Allow notifications","All Set! <b>Refresh</b> the page and youre good to go! "]},!!e.hasOwnProperty(t)&&e[t]},O.setCbuDialogRepeatPromptDelay=function(){var e=(e=new Date).setTime(e.getTime()+6048e5);d.Storage.setConfigLocal(S.KeyMapper.NUDGEUSER_DELAY,e)},O.isCbuRepeatDelayed=function(){var e=!1,t=new Date,n=d.Storage.getConfigLocal(S.KeyMapper.NUDGEUSER_DELAY);return""!=n&&n>t.getTime()&&(e=!0,p.Helper.displayLog("Wait until convert block user prompt repeat delay expire!")),e},O.subscribeOnBlocked=function(){var t;O.isOnBlockedRegister||(O.isOnBlockedRegister=!0,t=setInterval(function(){var e;"granted"==(null===(e=window.Notification)||void 0===e?void 0:e.permission)&&(clearInterval(t),p.Helper.displayLog("User granted prompt mannually!"),O.nativeHandler())},200))},O.alternateDomainJson="",O.alternateDomainIndex=0,O.permissionDomain="",O.isSyncPermissionStatus=!0,O.subscriptionOnAllow=!0,O.subscriptionSyncedFromSW=!1,O.minSWVersion="4.22",O.isUnBlockPopupInitialize=!1,O.isOnBlockedRegister=!1,O.subscriptionSource=0,O.syncableEvents=[,S.KeyMapper.PROMPTED,S.KeyMapper.OPTIN_SHOWN,S.KeyMapper.OPTIN_ALLOWED,S.KeyMapper.OPTIN_CLOSED,S.KeyMapper.ALREADY_DENIED],O);function O(){}t.NotificationHelper=n},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},l=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},p=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.HttpRequest=void 0;var d=n(0),o=n(10),u=n(2),n=(f.init=function(){f.processor(),window.addEventListener("online",f.processor)},f.get=function(i,o,r){return l(this,void 0,void 0,function(){return p(this,function(e){return[2,new Promise(function(t,n){f.create(i,"GET",o,r).then(function(e){t(e.response)}).catch(function(e){n(e.status)})})]})})},f.postForm=function(i,o,r){return void 0===r&&(r=!1),l(this,void 0,void 0,function(){return p(this,function(e){return[2,new Promise(function(t,n){f.postRequestHandler(i,o,u.KeyMapper.POST_FORM,r).then(function(e){t(e.response)}).catch(function(e){n(e)})})]})})},f.postJSON=function(i,o,r){return void 0===r&&(r=!1),l(this,void 0,void 0,function(){return p(this,function(e){return[2,new Promise(function(t,n){f.postRequestHandler(i,o,u.KeyMapper.POST_JSON,r).then(function(e){t(e.response)}).catch(function(e){n(e)})})]})})},f.postRequestHandler=function(o,r,a,s){void 0===a&&(a=u.KeyMapper.POST_FORM),void 0===s&&(s=!1);var c=Date.now();return new Promise(function(t,n){var e,i="";r=d.Helper.removeUndefinedValuesFromObj(r),1==s&&f.saveFailedRequest(o,r,a,c),i=a==u.KeyMapper.POST_JSON?(e={"Content-Type":"application/json"},JSON.stringify(r)):(e={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},d.Helper.objToParam(r)),f.recursivePostUntilSuccess(o,i,e,f.retryNo).then(function(e){t(e),1==s&&f.deleteSyncedRequestsFromDb(c)}).catch(function(e){n(e)})})},f.recursivePostUntilSuccess=function(r,a,s,c){return l(this,void 0,void 0,function(){var o=this;return p(this,function(e){return[2,new Promise(function(n,i){--c,f.create(r,"POST",a,s).then(function(e){n(e)}).catch(function(t){return l(o,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return 0<c?[4,d.Helper.sleep(f.retrieDelayMs)]:[3,2];case 1:return e.sent(),n(f.recursivePostUntilSuccess(r,a,s,c)),[3,3];case 2:i(t),e.label=3;case 3:return[2]}})})})})]})})},f.saveFailedRequest=function(e,t,n,i){o.IndexedDB.addUpdateToTable(u.KeyMapper.REQUEST_QUEUE,{url:e,data:t,type:n,key:i,retryNo:0}).then(function(e){d.Helper.displayLog(e)}).catch(function(e){d.Helper.displayLog(e)})},f.processor=function(){var e=this;o.IndexedDB.getIndexDBData(u.KeyMapper.REQUEST_QUEUE,"all").then(function(r){return l(e,void 0,void 0,function(){var n,t,i,o;return p(this,function(e){switch(e.label){case 0:t=function(){var t;return p(this,function(e){switch(e.label){case 0:return(t=a({},n)).hasOwnProperty("type")&&!t.hasOwnProperty("isSynced")&&(t.type==u.KeyMapper.POST_JSON?f.postJSON:f.postForm)(t.url,t.data,!1).then(function(){d.Helper.displayLog("Http Request Re-synced successfully!",t),f.deleteSyncedRequestsFromDb(t.key)}).catch(function(e){f.increaseHttpRetryCount(t.key)}),[4,d.Helper.sleep(500)];case 1:return e.sent(),[2]}})},i=0,o=r,e.label=1;case 1:return i<o.length?(n=o[i],[5,t()]):[3,4];case 2:e.sent(),e.label=3;case 3:return i++,[3,1];case 4:return[2]}})})}).catch(function(e){d.Helper.displayLog("Error in getting request q",e)})},f.increaseHttpRetryCount=function(t){o.IndexedDB.getIndexDBData(u.KeyMapper.REQUEST_QUEUE,t).then(function(e){!e||(e=e).retryNo&&(e.retryNo<10?(e.retryNo+=1,o.IndexedDB.addUpdateToTable(u.KeyMapper.REQUEST_QUEUE,e)):f.deleteSyncedRequestsFromDb(t))}).catch(function(e){})},f.deleteSyncedRequestsFromDb=function(t){return l(this,void 0,void 0,function(){return p(this,function(e){return o.IndexedDB.removeKeyFromTable(u.KeyMapper.REQUEST_QUEUE,t),[2]})})},f.create=function(o,r,a,s){return l(this,void 0,void 0,function(){return p(this,function(e){return[2,new Promise(function(e,t){var n=new XMLHttpRequest;if(n.onreadystatechange=function(){4==this.readyState&&(200==this.status?e:t)({status:this.status,response:this.responseText})},n.open(r,o,!0),s&&s.hasOwnProperty("Content-Type")||n.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),"object"==typeof s&&0<Object.keys(s).length)for(var i in s)n.setRequestHeader(i,s[i]);""!=a?n.send(a):n.send()})]})})},f.retrieDelayMs=1e3,f.retryNo=10,f);function f(){}t.HttpRequest=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GoogleAnalytics=void 0;var a=n(1),n=(i.init=function(e){a.Config.ga.id=e[1],a.Config.ga.syncWebPush=1;e=e[2];e.subscriptionCallback&&"object"==typeof e.subscriptionCallback&&(a.Config.ga.subscriptionCallback=e.subscriptionCallback),e.promptDisplayCallback&&"object"==typeof e.promptDisplayCallback&&(a.Config.ga.promptDisplayCallback=e.promptDisplayCallback)},i.process=function(e){if(a.Config.ga.syncWebPush&&""!=a.Config.ga.id)try{window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",a.Config.ga.id),window.gtag("event",e,{event_category:"izooto"})}catch(e){}},i.processNewsHub=function(e,t){var n=a.Config.ga.newsHubEvents;if(""!=a.Config.ga.id&&a.Config.ga.syncNewsHub){var i={Shown:{message:"Shown to website visitor",responsecode:1},"Widget Click":{message:"User clicked on News Hub widget",responsecode:2},"Article Clicked":{message:"User clicked on an article",responsecode:3},"Clicked Share":{message:"User clicked on Share Icon inside News Hub",responsecode:4},"Shared on":{message:"User shared article on Social",responsecode:5},Scroll:{message:"User scrolled in News Hub",responsecode:6},"Widget Close":{message:"User closed News Hub",responsecode:7}};if(0==n.length||-1!=n.indexOf(i[e].responsecode))try{var o=null!=t?"News Hub: "+e+" "+t:"News Hub: "+e,r={event_category:"News Hub",event_label:i[e].message};window.gtag("event",o,r)}catch(e){}}},i.processMessanger=function(e,t){if(a.Config.ga.syncMessenger&&""!=a.Config.ga.id)try{var n=null!=t?"Messenger Push: "+e+" "+t:"Messenger Push: "+e,i={event_category:"Messenger Push",event_label:{Impression:"Messenger opt-in shown","Repeat Impression":"Messenger opt-in shown to  users 2 or more times","Send to Messenger":"User clicked on Send to Messenger in the opt-in",Dismissed:"Messenger opt-in dismissed"}[e]};window.gtag("event",n,i)}catch(e){}},i.isCallbackAllowed=function(e,t){for(var n in e){n=e[n];if("string"==typeof n&&"all"==n.toLowerCase()||n==t)return!0}return!1},i.initUsingConfig=function(){""!=a.Config.ga.id&&a.Config.ga.subscriptionCallback.push(1,2)},i);function i(){}t.GoogleAnalytics=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ChannelEventHandler=void 0;var r=n(2),a=n(12),i=n(15),o=n(17),s=n(20),n=(c.event=function(e,t){var n=[r.KeyMapper.PROMPTED,r.KeyMapper.POPUP_OPEN,r.KeyMapper.OPTIN_SHOWN,r.KeyMapper.OPTIN_ALLOWED],i=[r.KeyMapper.ALREADY_GRANTED,r.KeyMapper.ALREADY_DENIED,r.KeyMapper.PROMPT_DENIED,r.KeyMapper.BROWSER_UNSUPPORTED,r.KeyMapper.PROMPT_ALLOWED,r.KeyMapper.OPTIN_CLOSED,r.KeyMapper.NOTIFICATION_DISABLED,r.KeyMapper.PROMPT_CLOSED],o=[r.KeyMapper.NEWSHUB_CLOSED,r.KeyMapper.NEWSHUB_FAILED];"webPush"==e&&(-1<i.indexOf(t)&&(c.channelStatus.webPush=1),-1<n.indexOf(t)&&(c.channelStatus.webPush=2)),"messenger"==e&&(t!=r.KeyMapper.SUBSCRIBED&&t!=r.KeyMapper.PROMPT_CLOSED||(c.channelStatus.messenger=1,a.NewsHub.showNewsHubWidget()),t==r.KeyMapper.MESSENGER_READY&&(c.channelStatus.messenger=3),t==r.KeyMapper.MESSENGER_READY_SHOW&&(c.channelStatus.messenger=2,this.handleMessengerInterval())),"newsHub"==e&&(-1<o.indexOf(t)&&(c.channelStatus.newsHub=1),t==r.KeyMapper.NEWSHUB_ANIMATIONEND&&3!=c.channelStatus.newsHub&&(c.channelStatus.newsHub=1),t==r.KeyMapper.NEWSHUB_OPEN&&(c.channelStatus.newsHub=3),t==r.KeyMapper.NEWSHUB_READY&&this.handleNewsHubInterval()),"exitIntent"==e&&(t==r.KeyMapper.EXITINTENT_SHOWN&&(c.channelStatus.exitIntent=2),t==r.KeyMapper.EXITINTENT_CLOSED&&(c.channelStatus.exitIntent=1)),"stickyBar"==e&&(t==r.KeyMapper.STICKYBAR_READY_SHOW&&(c.channelStatus.stickyBar=3),t==r.KeyMapper.STICKYBAR_SHOWN&&(c.channelStatus.stickyBar=2),t==r.KeyMapper.STICKYBAR_CLOSED&&(c.channelStatus.stickyBar=1),t!=r.KeyMapper.STICKYBAR_READY_SHOW&&t!=r.KeyMapper.STICKYBAR_SHOWN||c.handleStickyBarInterval()),"articleShare"==e&&(t==r.KeyMapper.ARTICLESHARE_READY_SHOW&&(c.handlerArticleShareInterval(),c.channelStatus.articleShare=3),t==r.KeyMapper.ARTICLESHARE_SHOWN&&(c.channelStatus.articleShare=2),t==r.KeyMapper.ARTICLESHARE_CLOSED&&(c.channelStatus.articleShare=1))},c.handleNewsHubInterval=function(){var e=setInterval(function(){c.channelStatus.messenger,1==c.channelStatus.webPush&&3==c.channelStatus.messenger||1!=c.channelStatus.messenger&&0!=c.channelStatus.messenger&&2!=c.channelStatus.webPush&&0!=c.channelStatus.webPush||(clearInterval(e),c.channelStatus.newsHub=2,a.NewsHub.showNewsHubWidget())},200)},c.handleMessengerInterval=function(){var e=setInterval(function(){2==c.channelStatus.webPush||2<=c.channelStatus.newsHub||1==c.channelStatus.webPush&&(c.channelStatus.messenger=2,a.NewsHub.hideNewsHubWidget(),i.Messenger.showMessenger(),clearInterval(e))},200)},c.handleStickyBarInterval=function(){var e=e||setInterval(function(){0!=c.channelStatus.exitIntent&&1!=c.channelStatus.exitIntent||3!=c.channelStatus.stickyBar?2==c.channelStatus.exitIntent&&2==c.channelStatus.stickyBar?(o.ExitIntent.stickybarHide=!0,o.ExitIntent.hideStickyBar()):1==c.channelStatus.exitIntent&&2==c.channelStatus.stickyBar&&(clearInterval(e),o.ExitIntent.showStickyBar()):(clearInterval(e),o.ExitIntent.stickybarReadyToShow())},200)},c.handlerArticleShareInterval=function(){var e=setInterval(function(){0!=c.channelStatus.exitIntent&&1!=c.channelStatus.exitIntent||3!=c.channelStatus.articleShare?2==c.channelStatus.exitIntent&&2==c.channelStatus.articleShare?s.ArticleShare.hideArticleShareDialog():1==c.channelStatus.exitIntent&&2==c.channelStatus.articleShare&&(clearInterval(e),s.ArticleShare.showArticleShareDialog()):(clearInterval(e),s.ArticleShare.showArticleShareDialogEventHandling())},100)},c.channelStatus={webPush:0,messenger:0,newsHub:0,exitIntent:0,stickyBar:0,articleShare:0},c);function c(){}t.ChannelEventHandler=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookieStorage=void 0;var o=n(1),r=n(0),a=n(2),n=(s.setCookie=function(e,t,n){void 0===n&&(n=o.Config.global.cookieExpiryDays);var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);i="expires="+i.toUTCString();document.cookie=e+"="+t+";path=/;"+o.Config.global.cookieDomain+i+";"+o.Config.global.cookieSameSite},s.getCookie=function(e){try{for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}}catch(e){}return""},s.setWpCookie=function(e,t){var n,i;1==window.is_wp&&("object"==typeof window._izootoModule&&window._izootoModule.hasOwnProperty("swPath")?(i={},n=s.getCookie(a.KeyMapper.WP_COOKIE),(i=(i=r.Helper.parseToJSON(n))||{})[e]=t,i=encodeURI(JSON.stringify(i)),s.setCookie(a.KeyMapper.WP_COOKIE,i)):s.setLegacyCookie(e,t))},s.removeCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT; "+o.Config.global.cookieSameSite},s.setLegacyCookie=function(e,t){switch(e){case"bType":case"dType":var n=JSON.stringify({dtype:o.Config.global.deviceType,btype:o.Config.global.browserType});s.setCookie("bddata",n);break;case"evtTrk":s.setCookie("evtrk",o.Config.notification.evtTracking);break;case"pushToken":s.setCookie("iztoken",t)}},s);function s(){}t.CookieStorage=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Queue=void 0;var i=n(4),o=n(1),r=n(0),a=n(11),s=n(6),c=n(3),l=n(2),p=n(15),d=n(12),u=n(21),n=(f.init=function(){"[object Array]"==Object.prototype.toString.call(window._izq)?f.readSavedPreferences():window._izq=[],window._izq.push=function(e){if(null!=e[0])return f.process(e)}},f.sync=function(e){if(void 0===e&&(e=!0),r.Helper.displayLog("Syncing queue.."),!(window._izq.length<1)){for(var t=[],n=0;n<window._izq.length;n++)t.push(window._izq[n]);if(0<t.length)if(e)for(n=t.length-1;0<=n;n--)null!=t[n]&&(t[n][0],this.process(t[n]),window._izq.splice(n,1));else for(n=t.length-1;0<=n;n--)null!=t[n]&&-1==o.Config.store.subscriptionBasedEventNameList.indexOf(t[n][0])?(t[n][0],this.process(t[n]),window._izq.splice(n,1)):r.Helper.displayLog("Sync later queue item",t[n][0])}},f.process=function(e){try{if("debug"===e[0]&&1==e[1])return void a.Debugger.init();if(1==o.Config.izootoStatus){if(1==o.Config.notification.gdprPromptStatus&&0==o.Config.notification.isGdprAllowed&&this.isValidQueueForGdpr(e[0]))return void r.Helper.displayLog("Blocked due to GDPR is disallowed : ",e[0]);if(3==i.NotificationHelper.getPermissionStatusFromStorage()&&-1<o.Config.store.subscriptionBasedEventNameList.indexOf(e[0]))return void r.Helper.displayLog("Blocked due to soft unsubscribe : ",e[0]);if(!i.NotificationHelper.isSubscriptionExist()&&-1<o.Config.store.subscriptionBasedEventNameList.indexOf(e[0]))return void r.Helper.displayLog("Blocked => Subscription not found: ",e[0]);if("event"===e[0]&&void 0!==e[1]&&"string"==typeof e[1]&&""!==e[1])i.NotificationHelper.userEventProcessor(e[1],e[2]),i.NotificationHelper.syncAsTrigger(e[1],e[2]);else if("triggerPromptWithDelay"==e[0])i.NotificationHelper.triggerPromptHandler(!0);else if("triggerPrompt"==e[0])i.NotificationHelper.triggerPromptHandler();else{if("customizeOptInPrompt"===e[0]&&"object"==typeof e[1])return void i.NotificationHelper.customizeOptInPrompt(e[1]);if("syncFCMToken"===e[0])"string"==typeof e[1]&&""!=e[1]&&(o.Config.notification.subscriptionType=1,o.Config.notification.fcmToken=e[1],i.NotificationHelper.sendEvent(l.KeyMapper.PROMPT_ALLOWED,e[1]));else if("updateSubscription"===e[0])"subscribe"!=e[1]&&"unsubscribe"!=e[1]||i.NotificationHelper.updateSubscriptionProcessor(e[1]);else{if("getSubscriberId"===e[0])return o.Config.store.subscriberId||c.Storage.getStorage(l.KeyMapper.UUID);if("getSubscriptionObject"===e[0])return c.Storage.getStorage(l.KeyMapper.PUSH_TOKEN);"userProfile"===e[0]&&(void 0!==e[1]||""!==e[1])||"personalizationProperty"===e[0]?i.NotificationHelper.userProfileProcessor(e[1]):"trigger"!==e[0]||void 0===e[1]&&""===e[1]?"gaId"===e[0]&&"string"==typeof e[1]&&"object"==typeof e[2]?s.GoogleAnalytics.init(e):"registerPromptDisplayCallback"===e[0]&&"function"==typeof e[1]?this.promptDisplayCallback=e[1]:"registerSubscriptionCallback"===e[0]&&"function"==typeof e[1]?this.subscriptionCallback=e[1]:"register_callback"===e[0]&&"function"==typeof e[1]?this.userCallback=e[1]:"getNotificationFeed"===e[0]&&"function"==typeof e[1]&&u.NotificationFeed.init(e[1]):i.NotificationHelper.triggerProcessor(e[1],e[2],e[3])}}o.Config.notification.isTagsEnabled&&("add_tag"===e[0]||"remove_tag"===e[0]?console.warn(o.Config.brandingPartner+" :: Tags are no longer supported. See https://help.izooto.com/article/segementation/ "):"add_property"===e[0]&&void 0!==e[1]&&""!==e[1]&&i.NotificationHelper.addPropertyProcessorFallback(e[1]))}else r.Helper.displayLog("Sync action aborted! due to notification module disable");if("triggerMessengerPrompt"===e[0])return o.Config.messenger.autoPrompt=!0,void p.Messenger.init(!0);"triggerNewsHub"===e[0]&&(d.NewsHub.isNewsContainerLoaded?d.NewsHub.toggleNewsHubDisplay(!0):(o.Config.newsHub.triggered=!0,d.NewsHub.init()))}catch(e){r.Helper.displayLog("Queue error :",e)}},f.readSavedPreferences=function(){window._izq,window._izq.forEach(function(e){var t;"subscriberProfile"==e[0]&&null!=e[1]&&"object"==typeof e[1]&&e[1].hasOwnProperty("isPaid")&&(o.Config.CRPSPlaybook.isPaidSubscriber=e[1].isPaid,r.Helper.displayLog("Paid subscriber is set to : ",e[1].isPaid)),"init"==e[0]&&null!=e[1]&&"object"==typeof e[1]?((e[1].hasOwnProperty("auto_prompt")||e[1].hasOwnProperty("notificationAutoPrompt")||e[1].hasOwnProperty("autoPrompt"))&&(o.Config.notification.autoPrompt=null!=e[1].auto_prompt?e[1].auto_prompt:null!=e[1].autoPrompt?e[1].autoPrompt:e[1].notificationAutoPrompt,r.Helper.displayLog("Notification auto prompt set to : ",e[1].auto_prompt),0==o.Config.notification.autoPrompt&&(o.Config.notification.promptType=2)),e[1].hasOwnProperty("messengerAutoPrompt")&&(o.Config.messenger.autoPrompt=e[1].messengerAutoPrompt,r.Helper.displayLog("Messenger auto prompt set to : ",e[1].messengerAutoPrompt)),e[1].hasOwnProperty("showNewsHubWidget")&&(o.Config.newsHub.autoWidget=e[1].showNewsHubWidget,r.Helper.displayLog("Newshub auto widget set to : ",e[1].showNewsHubWidget)),e[1].hasOwnProperty("onsi")&&(null!==(t=e[1].onsi.exitIntent)&&void 0!==t&&t.hasOwnProperty("enable")&&(o.Config.exitIntent.autoPopup=e[1].onsi.exitIntent.enable,r.Helper.displayLog("Onsite exitIntent auto popup set to : ",o.Config.exitIntent.autoPopup)),null!==(t=e[1].onsi.stickyBar)&&void 0!==t&&t.hasOwnProperty("enable")&&(o.Config.stickyBar.autoPopup=e[1].onsi.stickyBar.enable,r.Helper.displayLog("Onsite stickyBar auto popup set to : ",o.Config.stickyBar.autoPopup)))):"epSyncState"==e[0]&&1==e[1]&&(r.Helper.displayLog("Custom subscription found! waiting for for FCM Token sync command!"),o.Config.store.isNotificationDisabledManually=!0,f.sync())})},f.isValidQueueForGdpr=function(e){return-1<o.Config.notification.gdprNotAllowed.indexOf(e)},f);function f(){}t.Queue=n},function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.IndexedDB=void 0;var c=n(0),o=n(1),l=n(2),r=n(3),n=(p.setup=function(){4==r.Storage.getConfigLocal(l.KeyMapper.IDB_VERSION)&&(p.currentIdbVersion=4)},p.init=function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,new Promise(function(t,n){var i;"undefined"!=typeof indexedDB?p.idbDatabase&&4==p.currentIdbVersion?t(p.idbDatabase):("4.3"<=o.Config.notification.serviceWorkerVersion&&-1==o.Config.notification.serviceWorkerVersion.toString().indexOf("4.22")&&(p.currentIdbVersion=4),(i=indexedDB.open("izooto",p.currentIdbVersion)).onerror=function(){c.Helper.displayLog("DB not load =>",i.error);var e=null===(e=i.error)||void 0===e?void 0:e.name;e&&"VersionError"===e?(p.currentIdbVersion=4,t(p.init())):n("DB not load")},i.onsuccess=function(){r.Storage.setConfigLocal(l.KeyMapper.IDB_VERSION,p.currentIdbVersion);var e=i.result;(p.idbDatabase=e).onversionchange=function(){try{c.Helper.displayLog("idb version change detected! => closing current idb instance!"),e.close(),p.idbDatabase=null}catch(e){}},c.Helper.displayLog("Success : IndexedDB Instance"),p.detectSWVersionChange(e),t(e)},i.onblocked=function(e){n("DB blocked"),c.Helper.displayLog("idb blocked somewhere its still opened ...",e)},i.onupgradeneeded=function(e){try{r.Storage.setConfigLocal(l.KeyMapper.IDB_VERSION,e.newVersion);var t=i.result,n=e.oldVersion;e.oldVersion,e.newVersion,n<2&&(t.createObjectStore("swEvents",{keyPath:"eventName"}),t.createObjectStore("options",{keyPath:"key"})),n<3&&t.createObjectStore("notificationLog",{keyPath:"key"}),n<4&&(t.createObjectStore(l.KeyMapper.REQUEST_QUEUE,{keyPath:"key"}),t.createObjectStore("log",{keyPath:"key"}))}catch(e){c.Helper.displayLog("idb upgrade error",e)}}):n("DB not supported")})]})})},p.addUpdateToTable=function(i,o){return new Promise(function(t,n){p.init().then(function(e){e=e.transaction([i],"readwrite").objectStore(i).put(o);e.onsuccess=function(){t(i+" added to db.")},e.onerror=function(){n("Unable to add data in db!")}}).catch(function(e){c.Helper.displayLog(l.KeyMapper.SOMETHING_WRONG,e)})})},p.addUpdate=function(i,o){return a(this,void 0,void 0,function(){return s(this,function(e){try{return[2,new Promise(function(t,n){p.init().then(function(e){e=e.transaction(["options"],"readwrite").objectStore("options").put({key:i,val:o});e.onsuccess=function(e){t(i+" added to db.")},e.onerror=function(e){n("Unable to add data in db!")}}).catch(function(e){n(e),c.Helper.displayLog(l.KeyMapper.SOMETHING_WRONG,e)})})]}catch(e){c.Helper.displayLog(e)}return[2]})})},p.getIndexDBData=function(o,r){return a(this,void 0,void 0,function(){return s(this,function(e){try{return[2,new Promise(function(n,i){p.init().then(function(e){var e=e.transaction([o]).objectStore(o),t="all"==r?e.getAll():e.get(r);t.onerror=function(){i("Unable to retrieve data from db!")},t.onsuccess=function(){var e="";t.result?e=t.result:c.Helper.displayLog("Not found in db-> "+o+" -> "+r),n(e)}}).catch(function(e){c.Helper.displayLog(l.KeyMapper.SOMETHING_WRONG,e)})})]}catch(e){c.Helper.displayLog(e)}return[2]})})},p.setIndexedDb=function(t){window._izooto.sysEvents=o.Config.notification.sysEvents,"gaId"==t&&1!=o.Config.ga.swEvents||"sysEvents"==t&&1!=o.Config.notification.sysEventsFlag?c.Helper.displayLog("Not saved : ",t):p.getIndexDBData("options",t).then(function(e){(e&&!e.hasOwnProperty("val")||e.val!=window._izooto[t])&&p.addUpdate(t,window._izooto[t]).then(function(e){c.Helper.displayLog(e)}).catch(function(e){c.Helper.displayLog(e)})}).catch(function(e){c.Helper.displayLog(e)})},p.removeKeyFromTable=function(i,o){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,new Promise(function(t,n){p.init().then(function(e){e=e.transaction([i],"readwrite").objectStore(i).delete(o);e.onsuccess=function(e){t(o+" added to db.")},e.onerror=function(e){n("Unable to add data in db!")}}).catch(function(e){c.Helper.displayLog(l.KeyMapper.SOMETHING_WRONG,e)})})];case 1:return[2,e.sent()];case 2:return t=e.sent(),c.Helper.displayLog(t),[3,3];case 3:return[2]}})})},p.detectSWVersionChange=function(e,t,n){var i;void 0===t&&(t="options"),void 0===n&&(n="swVer"),o.Config.notification.serviceWorkerVersion<"4.21"&&(t=e.transaction([t]).objectStore(t),(i="all"==n?t.getAll():t.get(n)).onsuccess=function(){i.result&&i.result.hasOwnProperty("val")&&(o.Config.notification.serviceWorkerVersion=i.result.val)})},p.getValueFromiDbOptions=function(n){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,new Promise(function(t,e){p.getIndexDBData("options",n).then(function(e){if(!e.hasOwnProperty("val"))throw n+" not found in idb options";t(e.val)}).catch(function(e){c.Helper.displayLog(e),t("")})})]})})},p.currentIdbVersion=3,p.idbDatabase=null,p);function p(){}t.IndexedDB=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Debugger=void 0;var s=n(1),c=n(0),o=n(5),n=(l.init=function(e){l.msg=l.getMsgSet(),s.Config.debugger.err=0,console.clear(),l.log(l.dash.repeat(20)+(s.Config.brandingPartner+" Debug Mode")+l.dash.repeat(20)),s.Config.debugger.status=1,l.log("Verifying "+s.Config.brandingPartner+" integration on your website",s.Config.debugger.infoCode);function t(){1==s.Config.debugger.err?l.log(l.msg.integration_f,s.Config.debugger.errCode):l.log(l.msg.integration,s.Config.debugger.successCode),e&&e(l.debuggerObj)}var n=s.Config.global.platform;l.debuggerObj.plugin=n,l.debugger.rcvObj={};var i=document.location.href,i=c.Helper.getParamFromUrl(i,"izObj");(i=c.Helper.parseToJSON(i))&&null!=i.domainRoot&&(s.Config.notification.domainRoot=i.domainRoot,s.Config.notification.httpsNoRoot=""!=s.Config.notification.domainRoot?1:0,s.Config.setupPath()),i&&null!=i.cdnHost&&""!=i.cdnHost&&(s.Config.notification.cdnHost=i.cdnHost),""!=n&&l.log(l.msg.plugin.replace("{plg}",n),s.Config.debugger.successCode);n=l.getScript();null!=n?(l.debuggerObj.scriptSrc=n,l.log(l.msg.code_t+l.msg.code_f+"("+n+")",s.Config.debugger.successCode),1==s.Config.notification.isSdkHttps?l.validateSw(function(){t()}):t()):(s.Config.debugger.err=1,l.log(l.msg.code_t+l.msg.code_nf,s.Config.debugger.errCode),t())},l.log=function(e,t){t=t||"",console.info("%c"+e,t)},l.getMsgSet=function(){var e=s.Config.brandingPartner,t="support@"+e.toLowerCase()+".com";return{code_t:e+" JS code: ",code_f:"found",code_nf:"missing. Learn more here: http://bit.ly/2WHcP4a",sw_t:"Service Worker JS: ",sw_f:"found at {sw}",sw_nf:"missing from {sw} , Learn more here: http://bit.ly/2K0yGSs",sw_ct:"Service Worker JS: Invalid Content-Type found ",html_f:e+" Html: found",html_nf:e+" Html: not found ",html_ct:e+" Html: Invalid Content-Type found ",mfst_t:"Manifest file: ",mfst_f:"found at {m}",mfst_nf:"missing form {m} , Learn more here: http://bit.ly/2K0yGSs",multi_mfst:"multiple manifest files found. Learn more here: http://bit.ly/2WCd2FC",gcm_t:"gcm_sender_id: ",gcm_nf:"missing in the manifest file. Learn more here: http://bit.ly/2WCd2FC",fallback:"FCM project: issue with your FCM project.",integration:e+" integration is working fine on your website.",integration_f:e+" integration is incomplete. Contact "+t+" to get assistance.",plugin:"You have integrated "+e+" using the {plg} plugin.",ev:"sent to "+e}},l.requestFile=function(e,n,i){var o=new XMLHttpRequest,t=Math.random();e+=e.includes("?")?"&":"?",e+=t,o.onreadystatechange=function(){var e,t;4==this.readyState&&(e=o.responseText,t="",o.getResponseHeader("Content-Type")?t=o.getResponseHeader("Content-Type"):o.getResponseHeader("content-type")&&(t=o.getResponseHeader("content-type")),200==this.status?n(this.status,e,t):i(this.status,e))},o.open("GET",e,!0),o.send()},l.getFileInfo=function(e,i){var o={};l.requestFile(e,function(e,t,n){o.status=!0,o.contentType=n,o.body=t,i(o)},function(e,t){o.status=!1,i(o)})},l.contentTypeValidator=function(e,t){var n=!0;return t=t.toLowerCase(),1==e?t.indexOf("application")<0&&t.indexOf("javascript")<0&&(n=!1):2==e&&t.indexOf("html")<0&&(n=!1),n},l.validateIzootoHtml=function(t){l.debuggerObj.plugin&&t();var n=this.getMsgSet();s.Config.debugger.host;l.getFileInfo(s.Config.notification.sourceOrigin,function(e){1==(l.debuggerObj.izootoHtml=e).status?(l.log(n.html_f,s.Config.debugger.successCode),l.contentTypeValidator(2,e.contentType)||(l.log(n.html_ct+e.contentType,s.Config.debugger.errCode),s.Config.debugger.err=1)):(l.log(n.html_nf,s.Config.debugger.errCode),s.Config.debugger.err=1),t()})},l.validateSw=function(t){var n=this.getMsgSet(),i=s.Config.debugger.host;l.getFileInfo(s.Config.notification.serviceWorkerPath,function(e){if(1==(l.debuggerObj.sw=e).status){if(l.log(n.sw_t+n.sw_f.replace("{sw}",i+s.Config.notification.serviceWorkerPath),s.Config.debugger.successCode),!l.contentTypeValidator(1,e.contentType))return l.log(n.sw_ct+e.contentType,s.Config.debugger.errCode),s.Config.debugger.err=1,void t();l.validateIzootoHtml(t)}else l.log(n.sw_t+n.sw_nf.replace("{sw}",i+s.Config.notification.serviceWorkerPath),s.Config.debugger.errCode),s.Config.debugger.err=1,t()})},l.validateGCM=function(e,i){o.HttpRequest.postForm(s.Config.debugger.gcmValidator,{pid:s.Config.client,gcm:e}).then(function(e){var t="fail",n=(e=c.Helper.parseToJSON(e)).response||"Something went wrong";"success"==e.status?(t=e.status,l.log("GCM Sender ID Validation "+t,s.Config.debugger.successCode),i(!0)):(l.log("GCM Sender ID Validation "+t+" , "+n,s.Config.debugger.errCode),i(!1))}).catch(function(e){})},l.validateManifest=function(i){for(var o=l.getMsgSet(),r=s.Config.debugger.host,e=document.getElementsByTagName("link"),t=0;t<e.length;t++){var n=e[t],a=n.getAttribute("href"),n=n.getAttribute("rel");null!=n&&"manifest"==n&&a!=s.Config.notification.manifest&&(l.log(o.mfst_t+o.multi_mfst,s.Config.debugger.errCode),s.Config.debugger.err=1)}l.requestFile(s.Config.notification.manifest,function(e,t){l.log(o.mfst_t+o.mfst_f.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.successCode);try{var n=c.Helper.parseToJSON(t);if(""==(n=n.gcm_sender_id||""))return l.log(o.gcm_t+o.gcm_nf,s.Config.debugger.errCode),void i(!1);l.validateGCM(n,i)}catch(e){l.log(o.gcm_t+o.gcm_nf.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.errCode)}},function(e,t){l.log(o.mfst_t+o.mfst_nf.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.errCode),i(!1)})},l.getScript=function(){for(var e=document.getElementsByTagName("script"),t=new RegExp(s.Config.notification.cdnHost+"/scripts/[^/]*.js"),n=0;n<e.length;n++){var i=e[n];if(null!=(i=i.getAttribute("src"))&&t.test(i))return i=i.startsWith("//")?"https:"+i:i}return null},l.showMsgOverlay=function(){var e='<div class="iz-verification-overlay" style="width: 100%;position: fixed;top: 0;left:0;z-index: 9999999999;text-align: center;background: rgba(0,0,0,0.6);height: 100%;color: #fff;display: flex;justify-content: center;align-items: center;overflow-y: hidden;"><div class="inner-content" style="font-size: 2em;"><span style="line-height: 2;">Please wait while we are verifying '+s.Config.brandingPartner+" integration on your website. <br>This window will close automatically.</span></div></div>";c.Helper.addHTML("div",e,"iz-integration-overlay")},l.verifyIzootoIntegration=function(){l.showMsgOverlay(),l.init(function(e){c.Helper.postMessage("opener","integrationObj",e)})},l.dash="-",l.debuggerObj={sw:{},izootoHtml:{}},l.debugger={rcvObj:{}},l);function l(){}t.Debugger=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.NewsHub=void 0;var c=n(1),l=n(0),r=n(5),s=n(2),p=n(7),d=n(6),a=n(16),u=n(19),f=n(4),g=n(13),n=(Object.defineProperty(y,"isCrios",{get:function(){return c.Config.global.browserName==s.KeyMapper.BROWSER_CHROME&&l.Helper.isIos()},enumerable:!1,configurable:!0}),Object.defineProperty(y,"isFxios",{get:function(){return c.Config.global.browserName==s.KeyMapper.BROWSER_FIREFOX&&l.Helper.isIos()},enumerable:!1,configurable:!0}),y.init=function(){return i(this,void 0,void 0,function(){var t=this;return o(this,function(e){if(c.Config.newsHub.status){if(c.Config.global.isFrame)return[2];if(!c.Config.newsHub.autoWidget&&!c.Config.newsHub.triggered)return[2];l.Helper.displayLog("New Hub initiated..."),y.render().then(function(e){t.nhFeed=new u.FeedHelper(e),t.nhFeed.setup(),c.Config.newsHub.autoWidget||(y.showNewsHubWidget(),y.toggleNewsHubDisplay(!0)),y.minimumNotificationToShow=e,y.showLoader(e)})}return[2]})})},y.showEmptyNotificationMessage=function(){l.Helper.setCssPropperty("#iz-news-hub-notifications-body-container","height","100%"),document.querySelector(y.elmSelector.noNotification).style.display="flex",document.querySelector(y.elmSelector.notificationWrapperId).style.display="none"},y.showNotificationContent=function(){return i(this,void 0,void 0,function(){var t,n;return o(this,function(e){switch(e.label){case 0:return(e.trys.push([0,2,,3]),y.isNewsLoading)?[2]:(y.isNewsLoading=!0,y.showLoader(),[4,y.nhFeed.getNotifications()]);case 1:return(t=e.sent(),y.isNewsLoading=!1,n=t.data,(t=t.status)!=y.nhFeed.status.ALREADY_IN_PROGRESS&&y.hideLoader(),t==y.nhFeed.status.NO_MORE_NOTIFICATIONS&&y.showFooterMessage(),t==y.nhFeed.status.NULL_NOTIFICATION_SENT&&y.showEmptyNotificationMessage(),document.querySelector(this.elmSelector.notificationWrapperId)||this.isNewsContainerLoaded)?(n.forEach(function(e,t){e=y.payloadParser(e);e&&y.appendNews(e)}),[3,3]):(l.Helper.displayLog("News container not loaded!"),[2]);case 2:return n=e.sent(),l.Helper.displayLog("add news handler error:",n),[3,3];case 3:return[2]}})})},y.payloadParser=function(e){if(e&&e.hasOwnProperty("payload"))try{var t=e.key,n=e.clickedAt;e=e.payload;var i=l.Helper.getTimeAgoStringByTimestamp(parseInt(e.ct)),o=e.ln,o=l.Helper.replaceQueryParam(o,"utm_source","izooto");return o=l.Helper.replaceQueryParam(o,"utm_content","article_click"),{id:t,title:e.t,url:l.Helper.replaceQueryParam(o,"utm_medium","news_hub"),bannerImage:e.bi||e.i,createdAt:i,createdAtTimeStamp:e.ct,clickedAt:n,cid:e.id}}catch(e){l.Helper.displayLog("Payload parser error:",e)}},y.appendNews=function(n){var e,t,i,o=this,r=y.nhPrefix+"notification-"+n.id,a=y.noticationHtmlElement.cloneNode(!0),r="#"+(a.id=r);for(t in n)!function(t){try{var i=a.querySelector(y.notificationPrefix+t);"bannerImage"==t?(i.style.display="none",i.src=n[t],i.onerror=function(e){try{document.querySelector(r+" img").style.display="none",document.querySelector(r+" svg.no-preview").style.display="block",l.Helper.removeHTML(document.querySelector(r+" .iz-news-hub-post-icon-wrapper-loader.iz-news-hub-animated-background"))}catch(e){l.Helper.displayLog("Newshub error onError",e)}},i.onload=function(e){try{var t,n;document.querySelector(r+" img").style.display="block",l.Helper.removeHTML(document.querySelector(r+" .iz-news-hub-post-icon-wrapper-loader.iz-news-hub-animated-background")),i.height>i.width&&(t=document.querySelector(r+" .iz-news-hub-customer-icon-container"),(n=y.bluredBackgroudImage.cloneNode(!0)).querySelector("image").setAttribute("href",i.src),t.appendChild(n))}catch(e){l.Helper.displayLog("Newshub error onLoad",e)}}):"title"==t?i.innerHTML=l.Helper.removeHtmlTagsFromString(n[t]):"createdAt"==t&&(i.innerText=n[t])}catch(e){l.Helper.displayLog("Error in append news payload- "+t+":",n)}}(t);null!==(e=document.querySelector("#posts-content-cotainer"))&&void 0!==e&&e.insertAdjacentHTML("beforeend",a.outerHTML),y.nhFeed.isNoNotification&&(y.nhFeed.isNoNotification=!1),y.rtlFlag&&(y.rtlFlag=!1,y.detectRTL()),null!==(e=document.querySelector(r))&&void 0!==e&&e.addEventListener("click",function(e){var t;y.closeShareTab(),o.nhFeed.setPayloadData(n.id,{clickedAt:Date.now()}),d.GoogleAnalytics.processNewsHub("Article Clicked"),y.syncClick(n),null!==(t=window.open(n.url,"_blank"))&&void 0!==t&&t.focus()},!1),1==c.Config.global.deviceType&&((i=document.querySelector(r+" "+y.elmSelector.sharesheetTrigger)).classList.add("share-before-desktop"),null!==(s=document.querySelector(r))&&void 0!==s&&s.addEventListener("mouseleave",function(e){i.style.visibility="hidden",y.closeShareTab()},!1),null!==(s=document.querySelector(r))&&void 0!==s&&s.addEventListener("mouseenter",function(e){i.style.visibility="visible"},!1));var s=document.querySelector(r+" "+y.elmSelector.sharesheetTrigger);null!=s&&s.addEventListener("click",function(e){var t=document.querySelector(r+" "+y.elmSelector.shareSheetTab);t&&("flex"==t.style.display?y.closeShareTab():(y.closeShareTab(),t.style.display="flex",y.addShareSheetAnimationClass(t),y.setSocialShareLink(r,n),d.GoogleAnalytics.processNewsHub("Clicked Share"))),e.stopPropagation()},!0)},y.addShareSheetAnimationClass=function(e){try{var t=0;e.querySelectorAll("svg").forEach(function(e){y.isCrios?e.style.opacity="1":(setTimeout(function(){e.style.opacity="1",e.classList.add("iz-share-icons-animation")},t),t+=50)})}catch(e){l.Helper.displayLog("Newshub animation error",e)}},y.setSocialShareLink=function(n,e){try{var t,i=y.getSharingLink(e.url);for(t in i)!function(t){var e=document.querySelector(n+" "+y.elmSelector.socialSharePrefix+t);"link"==t?e.onclick=function(e){e.stopPropagation(),y.copyNewsLinkToClipboard(i[t]),d.GoogleAnalytics.processNewsHub("Shared on","copy link")}:(e.onclick=function(e){e.stopPropagation(),d.GoogleAnalytics.processNewsHub("Shared on",t)},e.href=i[t])}(t)}catch(e){l.Helper.displayLog("set social share error:",e)}},y.closeShareTab=function(){try{var e=document.querySelectorAll(y.elmSelector.shareSheetTab);null!=e&&e.forEach(function(e){e.style.display="none",e.querySelectorAll("svg").forEach(function(e){e.style.opacity="0",e.classList.remove("iz-share-icons-animation")})})}catch(e){l.Helper.displayLog("close action list error:",e)}},y.getSharingLink=function(e){return e=l.Helper.replaceQueryParam(e,"utm_campaign","Share"),{link:decodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","link_copy")),whatsapp:"https://api.whatsapp.com/send?text="+encodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","whatsapp")),facebook:"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","facebook")),twitter:"https://twitter.com/intent/tweet?url="+encodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","twitter"))+"&text=",mail:"mailto:info@example.com?&subject=&cc=&bcc=&body="+encodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","mail")),linkedin:"https://www.linkedin.com/shareArticle?mini=true&url="+encodeURIComponent(l.Helper.replaceQueryParam(e,"utm_content","linkedin"))}},y.render=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,new Promise(function(n,e){l.Helper.displayLog("Rendering News Hub");r.HttpRequest.get("https://cdn.izooto.com/newshub/widgetv3.html?v=2").then(function(e){try{if(!e)return void p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_FAILED);l.Helper.addHTML("div",e),y.isNewsContainerLoaded=!0,y.animatedLoaderHtmlElement=document.querySelector(y.elmSelector.animatedLoader),l.Helper.removeHTML(y.animatedLoaderHtmlElement),y.bluredBackgroudImage=document.querySelector("."+y.nhPrefix+"blur-image-container"),l.Helper.removeHTML(y.bluredBackgroudImage),y.noticationHtmlElement=document.querySelector("."+y.nhPrefix+"notification"),l.Helper.removeHTML(y.noticationHtmlElement),y.footerTextElement=document.querySelector("#"+y.nhPrefix+"end-text"),l.Helper.removeHTML(y.footerTextElement),y.webPushHandler(),y.applyConfigStyle();try{document.querySelector("."+y.nhPrefix+"branding-text").href="https://www.izooto.com/campaign/getting-started-with-izooto?utm_source=referral&utm_medium=news_hub&utm_campaign="+c.Config.notification.siteUrl}catch(e){l.Helper.displayLog("newshub branding hide error")}var t=window.getComputedStyle(document.querySelector("#"+y.nhPrefix+"posts-main-container")).height;t=((t=parseInt(t))-62)/85,y.attachEventListner(),n(parseInt(t||7)+1)}catch(e){p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_FAILED),l.Helper.displayLog("Error while rendering newshub  : ",e)}})})]})})},y.attachEventListner=function(){var e;try{var t=document.querySelector("#"+y.nhPrefix+"posts-main-container");t.addEventListener("scroll",function(){t.scrollHeight-50<t.scrollTop+t.clientHeight&&y.showNotificationContent()}),document.querySelectorAll(y.elmSelector.closeButton+" , "+y.elmSelector.triggerFloating+" , "+y.elmSelector.triggerSticky).forEach(function(e){e.addEventListener("click",function(e){y.triggerClickHandler()})}),null!==(e=document.querySelector("."+y.nhPrefix+"copyclose-button"))&&void 0!==e&&e.addEventListener("click",function(){document.querySelector("#"+y.nhPrefix+"copied-main").style.display="none"})}catch(e){l.Helper.displayLog("Error while attaching event listner",e)}},y.triggerClickHandler=function(){c.Config.newsHub.callout?!y.isCallOutStart&&a.Session.isNew?(y.toggleNewsHubDisplay(),y.widgetClicked=!0,1==c.Config.newsHub.designType&&y.stopWiggleAnimation()):y.isCallOutClose&&(1==c.Config.newsHub.designType&&y.stopWiggleAnimation(),y.toggleNewsHubDisplay(),y.widgetClicked=!0):y.toggleNewsHubDisplay()},y.applyConfigStyle=function(){try{c.Config.newsHub.title&&document.querySelectorAll("."+y.nhPrefix+"dynamic-title").forEach(function(e){var t=c.Config.newsHub.title.slice(0,20);e.innerHTML=t}),y.triggerButtonVisibiltyHandler(),c.Config.newsHub.placement[1]||document.querySelector(y.elmSelector.newsHubCotainerId).classList.add(y.nhPrefix+"notification-container-left"),p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_READY)}catch(e){l.Helper.displayLog("Error while applying config:",e)}},y.bellWigglehandler=function(){try{var e,t,n;1!=c.Config.newsHub.designType||1!=c.Config.newsHub.iconType||a.Session.isNew||(e=document.querySelector(y.elmSelector.mainIconContainer),t=document.querySelector("#iz-news-hub-bell-group"),n=document.querySelector("#iz-news-hub-bell-clapper"),e.addEventListener("animationend",function(){setTimeout(function(){y.startWiggleAnimation(),t.addEventListener("animationend",function(){t.classList.remove("iz-news-hub-bell-group"),n.classList.remove("iz-news-hub-bell-clapper")})},1500)},{once:!0}))}catch(e){l.Helper.displayLog("Error bell wiggling on page refresh:",e)}},y.calloutHandler=function(){if(!y.isCalloutShown&&(y.isCalloutShown=!0,a.Session.isNew))switch(c.Config.newsHub.designType){case 1:y.bellAnimationHandler();break;case 2:y.stickyAnimationHandler()}},y.triggerButtonVisibiltyHandler=function(){try{var e,t,n,i,o,r=document.querySelector(y.elmSelector.triggerSticky),a=document.querySelector(y.elmSelector.triggerFloating);r.style.display="none",a.style.display="none",c.Config.newsHub.autoWidget&&(2==c.Config.newsHub.designType?(r.style.display="flex",c.Config.newsHub.placement[1]||r.classList.add(y.nhPrefix+"sidebar-container-left")):(a.style.display="flex",e=c.Config.newsHub.placement[0]?"bottom":"top",t=c.Config.newsHub.placement[1]?"right":"left",n=y.nhPrefix+"floating-icon-container-"+e+"-"+t,a.classList.contains(n)||a.classList.add(n)),setTimeout(function(){var e;null!==(e=document.querySelector(y.elmSelector.triggerFloating+" "+y.elmSelector.mainIcon))&&void 0!==e&&e.classList.add("izooto-news-hub-swing-animation")},1e3),1==c.Config.newsHub.iconType?document.querySelectorAll(y.elmSelector.mainIcon).forEach(function(e){e.style.display="none"}):(1==c.Config.newsHub.designType&&(document.querySelector(y.elmSelector.bellIcon).style.display="none"),2==c.Config.newsHub.designType&&document.querySelectorAll("#iz-newshub-bell-svg").forEach(function(e){e.style.display="none"}),i="https://cdn.izooto.com/newshub/icons/"+c.Config.newsHub.iconType+".svg",document.querySelectorAll(y.elmSelector.mainIcon).forEach(function(e){e.src=i}))),c.Config.newsHub.mainColor&&(o=document.querySelector("#"+y.nhPrefix+"sticky-sidebar-dummy-text"),document.querySelector("#"+y.nhPrefix+"title-container").style.backgroundColor=c.Config.newsHub.mainColor,r.style.backgroundColor=c.Config.newsHub.mainColor,o.style.backgroundColor=c.Config.newsHub.mainColor,a.querySelector("#"+y.nhPrefix+"icon-container").style.backgroundColor=c.Config.newsHub.mainColor,1==c.Config.newsHub.iconType&&(document.querySelector("#iz-news-hub-bell-clapper").style.fill=c.Config.newsHub.mainColor,document.querySelector(".iz-newsHub-bell-shell").style.fill=c.Config.newsHub.mainColor)),c.Config.branding||(document.querySelector("."+y.nhPrefix+"header-branding-text").style.display="none")}catch(e){l.Helper.displayLog("Error while applying config:",e)}},y.toggleNewsHubDisplay=function(e){var t,n,i;void 0===e&&(e=!1),y.isNewsContainerLoaded&&(y.isDataLoaded||(y.isDataLoaded=!0,y.showNotificationContent()),t=c.Config.newsHub.placement[1]?"right":"left",(n=document.querySelector(y.elmSelector.newsHubCotainerId)).classList.add("izootoSlideAnimation"),"none"===n.style.display||e?(y.isGAEventSent.open||(y.isGAEventSent.open=!0,d.GoogleAnalytics.processNewsHub("Widget Click")),y.syncEventsWithAPI("syncNewshubOpen","wopen"),n.style.display="block",y.isCrios||n.classList.add("izooto-slide-in-"+t+"-animation"),y.isNewsHubOpened=!0,p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_OPEN),c.Config.newsHub.ads&&1!=y.adLoaded&&(y.adLoaded=!0,g.AdManager.loadNewshubAd())):(y.isNewsHubOpened=!1,i=function(){n.style.display="none",n.removeEventListener("animationend",i),y.closeShareTab(),y.isGAEventSent.close||(y.isGAEventSent.close=!0,d.GoogleAnalytics.processNewsHub("Widget Close")),n.classList.remove("izooto-slide-out-"+t+"-animation"),p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_CLOSED)},n.classList.remove("izooto-slide-in-"+t+"-animation"),n.addEventListener("animationend",i),y.isCrios?i():n.classList.add("izooto-slide-out-"+t+"-animation")))},y.setElmStyles=function(){try{var e=document.querySelector("#iz-news-hub-sticky-sidebar");c.Config.newsHub.placement[1]?(e.style.left="unset",e.style.right="-"+(e.clientWidth/2-e.clientHeight/2)+"px"):(e.clientWidth,e.clientHeight,e.style.right="unset",e.style.left="-"+(e.clientWidth/2-e.clientHeight/2)+"px")}catch(e){}},y.copyNewsLinkToClipboard=function(e){try{y.closeShareTab();var t=document.querySelector("#"+y.nhPrefix+"copied-main");if(clearTimeout(y.copiedTimeoutInstance),t.style.display="block",y.copiedTimeoutInstance=setTimeout(function(){t.style.display="none"},3e3),!navigator.clipboard){var n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.left="-999999px",n.style.top="-999999px",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy");n.remove()}catch(e){l.Helper.displayLog("Fallback: Oops, unable to copy",e)}return}navigator.clipboard.writeText(e).then(function(){},function(e){l.Helper.displayLog("Async: Could not copy text: ",e)})}catch(e){l.Helper.displayLog("Error: Could not copy text: ",e)}},y.showLoader=function(e){var t;void 0===e&&(e=1);for(var n=1;n<=e;n++)null!==(t=document.querySelector("#posts-content-cotainer"))&&void 0!==t&&t.insertAdjacentHTML("beforeend",y.animatedLoaderHtmlElement.outerHTML)},y.hideLoader=function(){document.querySelectorAll(y.elmSelector.animatedLoader).forEach(function(e){e.parentNode.removeChild(e)})},y.syncClick=function(e){e={pid:c.Config.client,bkey:c.Config.UUID,rid:e.id,cid:e.cid,op:"click",isid:1,cs:1};c.Config.notification.serviceWorkerVersion&&(e.ver=c.Config.notification.serviceWorkerVersion),r.HttpRequest.postForm(l.Helper.getEndpoint("notificationClick"),e,!0).then(function(){c.Config.brandingPartner}).catch(function(e){})},y.showFooterMessage=function(){var e;try{if(y.nhFeed.isNoNotification)return;null!==(e=document.querySelector(this.elmSelector.notificationWrapperId))&&void 0!==e&&e.appendChild(y.footerTextElement),y.footerTextElement.style.display="block",(l.Helper.isIos()&&(y.isFxios||y.isCrios)||3==c.Config.global.deviceType&&1==c.Config.global.browserType)&&y.footerTextElement.classList.add("pb-40"),2==c.Config.global.deviceType&&y.isCrios&&y.footerTextElement.classList.add("pb-74")}catch(e){}},y.detectRTL=function(){var e=document.querySelector("."+y.nhPrefix+"customer-icon-container");15<e.offsetLeft&&(e.offsetLeft,document.querySelector("#"+y.nhPrefix+"main-container").setAttribute("izdirection","rtl"))},y.showNewsHubWidget=function(){try{if(y.isNewsHubOpened||!y.isNewsContainerLoaded)return;l.Helper.showElement("#iz-news-hub-main-container"),y.syncShownEvent(),l.Helper.displayLog("News hub widget shown"),c.Config.newsHub.callout&&!y.isCrios?(y.calloutHandler(),y.bellWigglehandler()):p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_ANIMATIONEND),y.setElmStyles()}catch(e){}},y.hideNewsHubWidget=function(){try{if(y.isNewsHubOpened||!y.isNewsContainerLoaded)return;l.Helper.hideElement("#iz-news-hub-main-container"),y.shownTimeoutInstance=clearTimeout(y.shownTimeoutInstance),l.Helper.displayLog("News hub widget hidden")}catch(e){}},y.syncShownEvent=function(){y.isGAEventSent.shown||!c.Config.newsHub.autoWidget||y.shownTimeoutInstance||(y.shownTimeoutInstance=setTimeout(function(){y.isGAEventSent.shown=!0,d.GoogleAnalytics.processNewsHub("Shown"),y.syncNewsHubImp||y.syncEventsWithAPI("syncNewshubView","wview")},5e3))},y.syncEventsWithAPI=function(e,t){t={pid:c.Config.client,bkey:c.Config.UUID,op:t,btype:c.Config.global.browserType,dtype:c.Config.global.deviceType,os:c.Config.global.os,bver:c.Config.global.browserVer},e=l.Helper.getEndpoint(e);r.HttpRequest.postForm(e,t,!0).then(function(){c.Config.brandingPartner}).catch(function(e){})},y.showCallout=function(){try{y.isCallOutStart=!0;var e=1==c.Config.newsHub.designType?document.querySelector("#"+y.nhPrefix+"main-container #"+y.nhPrefix+"icon-discoverability"):document.querySelector("."+y.nhPrefix+"stickybar-callout");y.calloutHtml=e.cloneNode(!0),e.style.visibility="hidden",!0===g.AdManager.isCallOutAds()?g.AdManager.loadCallOutAds().then(function(){e.style.visibility="visible",y.callOutAdSuccess(),1==c.Config.newsHub.designType?y.calloutCrossHandling():y.applyConfigStyleOnStickyCallOut()}).catch(function(e){y.getLatestData()}):y.getLatestData(),y.callOutAnimationHandler(e),e.style.display="flex"}catch(e){l.Helper.displayLog("Show callout error",e)}},y.callOutAnimationHandler=function(e){2==c.Config.newsHub.designType?e.classList.add(c.Config.newsHub.placement[1]?"iz-news-hub-stickybarCallout-slideIn-right":"iz-news-hub-stickybarCallout-slideIn-left"):e.classList.add(c.Config.newsHub.placement[1]?"iz-news-hub-slideInRight":"iz-news-hub-slideInLeft")},y.getLatestData=function(){try{y.loadlatestNotificationForCallout().then(function(e){var t=1==c.Config.newsHub.designType?document.querySelector("#"+y.nhPrefix+"main-container #"+y.nhPrefix+"icon-discoverability"):document.querySelector("."+y.nhPrefix+"stickybar-callout");t.style.visibility="visible",1==c.Config.newsHub.designType&&y.calloutCrossHandling();!0===g.AdManager.isCallOutAds()&&(t.innerHTML=y.calloutHtml.innerHTML),y.setCallOutNotification(e,t),y.calloutEventHandler(e)}).catch(function(e){})}catch(e){}},y.callOutAdSuccess=function(){var e=document.querySelector("#iz-nhdis-ads"),t=c.Config.newsHub.placement[1]?"margin-inline-start: -15px;":"margin-inline-start: -26px;";2==c.Config.newsHub.designType&&(t=c.Config.newsHub.placement[1]?"margin-inline-start: 0px;":"margin-inline-start: -9px;"),e.setAttribute("style","transform: scale(0.9);"+t),y.calloutEventHandler(!1)},y.calloutEventHandler=function(n){try{var e=1==c.Config.newsHub.designType?document.querySelector("#"+y.nhPrefix+"main-container #"+y.nhPrefix+"icon-discoverability"):document.querySelector("#"+y.nhPrefix+"icon-sticky-discoverability");n&&e.addEventListener("click",function(e){var t;null!==(t=null==n?void 0:n.p)&&void 0!==t&&t.ln&&window.open(n.p.ln),y.CalloutHover=!1,y.hideCallout(),e.stopPropagation()},!1),e.addEventListener("mouseenter",function(e){y.CalloutHover=!0}),e.addEventListener("mouseleave",function(e){y.CalloutHover=!1}),(1==c.Config.newsHub.designType?document.querySelector(y.elmSelector.triggerFloating):document.querySelector(".iz-news-hub-stickybar-callout-close")).addEventListener("click",function(){1==c.Config.newsHub.designType?y.hideCallout():y.hideStickyCallout()})}catch(e){l.Helper.displayLog("callout event handling error",e)}},y.startWiggleAnimation=function(){try{var e=document.querySelector("#iz-news-hub-bell-group"),t=document.querySelector("#iz-news-hub-bell-clapper");if(e.classList.add("iz-news-hub-bell-group"),t.classList.add("iz-news-hub-bell-clapper"),y.wiggleIntervalId)return;y.wiggleIntervalId=setInterval(function(){e.classList.add("iz-news-hub-bell-group"),t.classList.add("iz-news-hub-bell-clapper")},4e3)}catch(e){l.Helper.displayLog("Start wiggle animation error",e)}},y.stopWiggleAnimation=function(){y.wiggleIntervalId=window.clearInterval(y.wiggleIntervalId)},y.setCallOutNotification=function(e,t){try{y.applyConfigStyleOnStickyCallOut();l.Helper.getDomElement(".iz_osn_icon_1",t);var n,i=l.Helper.getDomElement("."+y.nhPrefix+"icon-discoverability-text",t),o=l.Helper.getDomElement("."+y.nhPrefix+"icon-discoverability-img-wrapper img",t),r=l.Helper.getDomElement("."+y.nhPrefix+"icon-discoverability-img-wrapper",t);e.p.bi?(n=e.p.bi,o.src=n,y.imagebgBlur(r,o),o.onerror=function(e){y.removeImageWhiteSpace(t)}):e.p.i?(n=e.p.i,o.src=n,y.imagebgBlur(r,o),o.onerror=function(e){y.removeImageWhiteSpace(t)}):y.removeImageWhiteSpace(t),i.innerHTML=e.p.t,c.Config.newsHub.placement[1]||"rtl"!=document.dir||(i.style.direction="ltr")}catch(e){l.Helper.displayLog("Set callout notification error",e)}},y.removeImageWhiteSpace=function(e){var t=document.querySelector("#"+y.nhPrefix+"icon-discoverability");l.Helper.getDomElement("."+y.nhPrefix+"icon-discoverability-img-wrapper",e).style.display="none",c.Config.newsHub.placement[1]||(t.style.paddingRight="0px")},y.calloutCrossHandling=function(){try{setTimeout(function(){l.Helper.hideElement(y.elmSelector.bellIcon),1!=c.Config.newsHub.iconType&&l.Helper.hideElement(y.elmSelector.mainIcon),l.Helper.showElement(y.elmSelector.crossIcon)},700)}catch(e){l.Helper.displayLog("Callout animationend error",e)}},y.imagebgBlur=function(n,i){i.onload=function(e){try{var t;i.style.display="block",(i.naturalHeight>i.naturalWidth||i.naturalWidth==i.naturalHeight)&&((t=y.bluredBackgroudImage.cloneNode(!0)).querySelector("image").setAttribute("href",i.src),n.appendChild(t),i.style.objectFit="contain")}catch(e){l.Helper.displayLog("Newshub discoverability image error onLoad",e)}}},y.hideCallout=function(e){try{var t=document.querySelector(y.elmSelector.notificationCallout);document.querySelector(y.elmSelector.triggerFloating).removeEventListener("click",y.hideCallout);var n="iz-news-hub-slideInLeft",i="iz-news-hub-slideOutLeft";c.Config.newsHub.placement[1]&&(n="iz-news-hub-slideInRight",i="iz-news-hub-slideOutRight"),t.classList.replace(n,i),l.Helper.hideElement(y.elmSelector.crossIcon);var o=1!=c.Config.newsHub.iconType?y.elmSelector.mainIcon:y.elmSelector.bellIcon;l.Helper.showElement(o),t.addEventListener("animationend",function(){t.style.display="none",p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_ANIMATIONEND)}),setTimeout(function(){y.widgetClicked||y.startWiggleAnimation()},3e3),y.isCallOutClose=!0,null!=e&&e.stopPropagation()}catch(e){l.Helper.displayLog("Callout hide error",e)}},y.hideStickyCallout=function(e){try{var t=document.querySelector("."+y.nhPrefix+"stickybar-callout"),n=document.querySelector("#"+y.nhPrefix+"sticky-sidebar"),i=c.Config.newsHub.placement[1]?"iz-news-hub-stickybar-slideIn-right":"iz-news-hub-stickybar-slideIn-left",o=c.Config.newsHub.placement[1]?"iz-news-hub-stickybar-slideOut-right":"iz-news-hub-stickybar-slideOut-left",r="iz-news-hub-stickybarCallout-slideIn-left",a="iz-news-hub-stickybarCallout-slideOut-left";c.Config.newsHub.placement[1]&&(r="iz-news-hub-stickybarCallout-slideIn-right",a="iz-news-hub-stickybarCallout-slideOut-right"),t.classList.replace(r,a),t.addEventListener("animationend",function(){t.style.display="none",p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_ANIMATIONEND),n.classList.replace(o,i)}),y.isCallOutClose=!0,null!=e&&e.stopPropagation()}catch(e){l.Helper.displayLog("Callout hide error",e)}},y.stickyAnimationHandler=function(){y.isCallOutClose=!1;var e=document.querySelector("#"+y.nhPrefix+"sticky-sidebar"),t=c.Config.newsHub.placement[1]?"iz-news-hub-stickybar-slideIn-right":"iz-news-hub-stickybar-slideIn-left",n=c.Config.newsHub.placement[1]?"iz-news-hub-stickybar-slideOut-right":"iz-news-hub-stickybar-slideOut-left";e.classList.add(t),e.addEventListener("animationend",function(){setTimeout(function(){e.classList.replace(t,n),y.widgetClicked?e.classList.remove(n):(y.showCallout(),y.calloutCloseHandler())},3e3)},{once:!0})},y.applyConfigStyleOnStickyCallOut=function(){2==c.Config.newsHub.designType&&(document.querySelector(".iz-news-hub-stickybar-callout-close").style.backgroundColor=c.Config.newsHub.mainColor)},y.bellAnimationHandler=function(){try{var e,t,n;y.isCallOutClose=!1,1==c.Config.newsHub.iconType?(e=document.querySelector(y.elmSelector.mainIconContainer),t=document.querySelector("#iz-news-hub-bell-group"),n=document.querySelector("#iz-news-hub-bell-clapper"),e.addEventListener("animationend",function(){setTimeout(function(){t.classList.add("iz-news-hub-bell-group"),n.classList.add("iz-news-hub-bell-clapper"),t.addEventListener("animationend",function(){t.classList.remove("iz-news-hub-bell-group"),n.classList.remove("iz-news-hub-bell-clapper")})},1500)},{once:!0}),t.addEventListener("animationend",function(){setTimeout(function(){y.widgetClicked||(y.showCallout(),y.calloutCloseHandler())},1500)},{once:!0})):document.querySelector("#izooto-news-hub-swing-animation").addEventListener("animationend",function(){setTimeout(function(){y.widgetClicked||(y.showCallout(),y.calloutCloseHandler())},1500)},{once:!0})}catch(e){l.Helper.displayLog("bell animate handler error",e)}},y.calloutCloseHandler=function(){setTimeout(function(){var e=setInterval(function(){y.CalloutHover||(clearInterval(e),1==c.Config.newsHub.designType?y.hideCallout():y.hideStickyCallout())},1e3)},1e3*c.Config.newsHub.calloutTimeout)},y.loadlatestNotificationForCallout=function(){return i(this,void 0,void 0,function(){return o(this,function(e){return[2,new Promise(function(n,i){var e="https://nh.iz.do/nh/"+c.Config.hashFileName+"/latest.json";r.HttpRequest.get(e).then(function(e){try{var t=l.Helper.parseToJSON(e);t.hasOwnProperty("p")&&t.p.t?n(t):(p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_ANIMATIONEND),i(!1))}catch(e){p.ChannelEventHandler.event("newsHub",s.KeyMapper.NEWSHUB_ANIMATIONEND),i(!1)}}).catch(function(e){i(!1),l.Helper.displayLog("Load latest notification error",e)})})]})})},y.sendEvent=function(e){if(c.Config.newsHub.status)switch(e){case s.KeyMapper.PROMPT_ALLOWED:case s.KeyMapper.ALREADY_GRANTED:case s.KeyMapper.PROMPT_DENIED:case s.KeyMapper.ALREADY_DENIED:y.webPushHandler();break;case s.KeyMapper.OPTIN_SHOWN:y.isNotificationOptinShowing=!0,y.webPushHandler();break;case s.KeyMapper.OPTIN_CLOSED:y.isNotificationOptinShowing=!1,y.webPushHandler()}},y.webPushHandler=function(){var e=f.NotificationHelper.getGIFUrl();if(c.Config.izootoStatus&&c.Config.notification.isSupported&&c.Config.newsHub.nudgeStatus&&y.isNewsContainerLoaded&&e)switch(Notification.permission){case"default":y.isNotificationOptinShowing?y.hideNudgeBar():y.webPushPermissionDefaultHandler();break;case s.KeyMapper.PROMPT_DENIED:y.webPushPermissionDeniedHandler();break;case"granted":y.hideNudgeBar()}},y.webPushPermissionDefaultHandler=function(){l.Helper.showElement("."+y.nhPrefix+"noti-default-wrapper",!1),l.Helper.hideElement("."+y.nhPrefix+"noti-blocked-wrapper");var e=document.querySelector("."+y.nhPrefix+"noti-default-wrapper button");null!=e&&e.addEventListener("click",function(){f.NotificationHelper.subscriptionSource=1,f.NotificationHelper.nativeHandler()})},y.webPushPermissionDeniedHandler=function(){var e;try{var t=f.NotificationHelper.getGIFUrl();0!=t&&(l.Helper.hideElement("."+y.nhPrefix+"noti-default-wrapper"),l.Helper.showElement("."+y.nhPrefix+"noti-blocked-wrapper",!1),document.querySelector(".iz-news-hub-noti-blocked-wrapper img").src=t,null!==(e=document.querySelector("."+y.nhPrefix+"noti-blocked-wrapper .know-more-txt"))&&void 0!==e&&e.addEventListener("mouseenter",function(){f.NotificationHelper.subscriptionSource=2})),f.NotificationHelper.subscribeOnBlocked()}catch(e){}},y.hideNudgeBar=function(){l.Helper.hideElement("."+y.nhPrefix+"noti-blocked-wrapper"),l.Helper.hideElement("."+y.nhPrefix+"noti-default-wrapper")},y.minimumNotificationToShow=0,y.isNewsLoading=!1,y.isNewsContainerLoaded=!1,y.notificationPrefix="."+(y.nhPrefix="iz-news-hub-")+"notification-",y.isNewsHubOpened=!1,y.lastMarkAllAsRead=!1,y.isDataLoaded=!1,y.rtlFlag=!0,y.isCallOutClose=!0,y.CalloutHover=!1,y.isCalloutShown=!1,y.isCallOutStart=!1,y.widgetClicked=!1,y.syncNewsHubImp=!1,y.adLoaded=!1,y.calloutHtml="",y.isNotificationOptinShowing=!1,y.elmSelector={newsHubCotainerId:"#"+y.nhPrefix+"notification-container",noNotification:"#"+y.nhPrefix+"no-notifications-container",notificationWrapperId:"#"+y.nhPrefix+"posts-main-container",triggerSticky:"#"+y.nhPrefix+"sticky-sidebar",triggerFloating:"#"+y.nhPrefix+"discovr-outer-wrapper",mainIcon:"."+y.nhPrefix+"main-icon",mainIconContainer:"#"+y.nhPrefix+"icon-container",closeButton:"."+y.nhPrefix+"close-news-hub-btn",animatedLoader:y.notificationPrefix+"loader",sharesheetTrigger:"."+y.nhPrefix+"share-before",shareSheetTab:"."+y.nhPrefix+"share-icons",socialSharePrefix:"."+y.nhPrefix+"social-share-",notificationCallout:"#"+y.nhPrefix+"icon-discoverability",crossIcon:"#"+y.nhPrefix+"cross-icon",bellIcon:"."+y.nhPrefix+"bell"},y.isGAEventSent={shown:!1,open:!1,close:!1},y);function y(){}t.NewsHub=n},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},s=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},c=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.AdManager=void 0;var a=n(1),l=n(0),r=n(5),o=n(4),n=(p.isThirdPartyAds=function(){return!!p.thirdPartyAds.hasOwnProperty(a.Config.client)},p.isCallOutAds=function(){return!!(p.callOutAds.hasOwnProperty(a.Config.client)||50627==a.Config.client&&a.Config.newsHub.callOutAds||a.Config.newsHub.callOutAds&&""!=a.Config.newsHub.callOutAdUnit)},p.getPidSpecificAPI=function(){return o.NotificationHelper.loadDesign(i(i({},p.thirdPartyAds[a.Config.client]),{uuid:a.Config.UUID}),p.thirdPartyAds.templateURL)},p.getJSONAd=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,new Promise(function(o,e){var t=p.getPidSpecificAPI();setTimeout(function(){o(!1)},2e3),r.HttpRequest.get(t).then(function(e){try{var t=JSON.parse(e);if(t[0]){var n=t[0];if(n.notificationMessage&&n.size_21_800x400&&n.trackerUrl){var i={title:n.notificationMessage,image:n.size_21_800x400,url:n.trackerUrl,isAd:1};return void o(i)}}}catch(e){l.Helper.displayLog("Error to loadAd:",e)}o(!1)}).catch(function(){o(!1)})})]})})},p.createAdContainer=function(e,t){var n=document.getElementById(e);n.innerHTML="";e=document.createElement("div");e.id=t,n.appendChild(e)},p.loadOnsiteAd=function(n,i){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,new Promise(function(e,t){""==i?t("Ad config not found"):p.addGPTScript(n,i,[[320,50],[300,100],[320,100]]).then(e).catch(t)})]})})},p.loadNewshubAd=function(){var e,t="iz-news-hub-ads-container",n="iz-nh-ads";50627==a.Config.client?(p.createAdContainer(t,n),p.loadThirdPartyGAMAd(n,"TR-41c011e8-f0a5-11ed-8147-bf107f503423")):""!=a.Config.newsHub.adUnit&&(p.createAdContainer(t,n),e=void 0,""!=a.Config.newsHub.adUnit&&(e=a.Config.newsHub.adUnit),t=21092==a.Config.client?[[300,250]]:[[320,50],[320,100],[300,50],[300,100]],p.addGPTScript(n,e,t).then(function(){p.addNewshubStyleOncustomizeAd()}).catch(function(){}))},p.addNewshubStyleOncustomizeAd=function(){21092==a.Config.client&&document.querySelector("#iz-news-hub-posts-main-container").classList.add("large-ad")},p.loadCallOutAds=function(){return s(this,void 0,void 0,function(){return c(this,function(e){return[2,new Promise(function(i,o){!1===p.isCallOutAds()&&o("Ad callout config not found");var r,e=1==a.Config.newsHub.designType?"iz-news-hub-icon-discoverability":"iz-news-hub-icon-sticky-discoverability",t="iz-nhdis-ads";p.createAdContainer(e,t),50627==a.Config.client?(p.loadThirdPartyGAMAd(t,r="TR-4a5b9a7c-0525-11ee-9d06-c79fe9fbd4cd"),window.momagicGAMCallback=function(e,t,n){n==r&&(!1===e?o(!1):i(!0))}):(e=p.callOutAds.hasOwnProperty(a.Config.client)?p.callOutAds[a.Config.client]:a.Config.newsHub.callOutAdUnit,p.addGPTScript(t,e,[[320,50]]).then(i).catch(o))})]})})},p.loadShareArticleAd=function(){var e={};try{if(""==a.Config.articleShare.adUnit&&!e.hasOwnProperty(a.Config.client))return;var t=e[a.Config.client],n=[[320,50],[300,100],[320,100]];""!=a.Config.articleShare.adUnit&&(t=a.Config.articleShare.adUnit);var i="iz-share-ads";p.createAdContainer("iz-shareAricle-ads",i),l.Helper.addExternalJS(this.GPTScriptSrc).then(function(){p.loadAdUnit(i,t,n)})}catch(e){}},p.loadAdUnit=function(t,n,i,o){try{window.googletag=window.googletag||{cmd:[]},window.googletag.cmd.push(function(){var e=window.googletag.defineSlot(n,i,t).addService(window.googletag.pubads());window.googletag.pubads().set("page_url",a.Config.notification.siteUrl),window.googletag.enableServices(),window.googletag.display(t),window.googletag.pubads().isInitialLoadDisabled()&&window.googletag.pubads().refresh([e]),window.googletag.pubads().addEventListener("slotRenderEnded",function(e){o&&t==e.slot.getSlotElementId()&&(e.isEmpty,o(e.isEmpty))})})}catch(e){o(!0)}},p.loadThirdPartyGAMAd=function(t,n){l.Helper.addExternalJS(this.thirdPartyAdScriptSrc,this.thirdPartyScriptId).then(function(){var e=document.createElement("div");e.id=n,document.getElementById(t).appendChild(e)})},p.addGPTScript=function(o,r,a){return s(this,void 0,void 0,function(){var i=this;return c(this,function(e){return[2,new Promise(function(t,n){l.Helper.addExternalJS(i.GPTScriptSrc).then(function(){p.loadAdUnit(o,r,a,function(e){!0===e?n(!1):t(!0)})})})]})})},p.GPTScriptSrc="https://securepubads.g.doubleclick.net/tag/js/gpt.js",p.thirdPartyAdScriptSrc="https://1437953666.rsc.cdn77.org/publisher/cd35c7c7-f0a4-11ed-8147-172214151312/truereachAdRender.js",p.thirdPartyScriptId="interactive_js_adcode",p.thirdPartyAds={},p.callOutAds={47825:"/22809537726/wtskora/wtskora_newshub_flyout",33757:"/22809537726/dimsumdaily/dd_flyout",51411:"/22809537726/tamil.abplive.com/ta_flyout",27714:"/22809537726/sinarharian/sh_flyout",27827:"/22809537726/dailythanthi/dt_flyout",18518:"/22809537726/republicworld/rw_flyout",51431:"/22809537726/marathi.abplive.com/ma_flyout",42051:"/22809537726/siamsport/ss_flyout",47481:"/22809537726/tribune.net/tb_flyout",43326:"/22809537726/missionmpsc/mm_flyout",45716:"/22809537726/insidenova.com/in_flyout",42476:"/22809537726/skymetweather/smw_flyout",48591:"/22809537726/punjabkesari/pk_flyout",51857:"/22809537726/pratibha.eenadu.net_osn/pe_flyout",48254:"/22809537726/philstarlife/pl_flyout",36400:"/22809537726/orientaldaily.com.my/od_flyout",35515:"/22809537726/vtvgujarati/vg_fo",56500:"/22809537726/gujaratijagran/gj_fo",53356:"/22809537726/emandirates/er_flyout",54032:"/22809537726/talkaaj/ta_fo",57761:"/22809537726/lehren/lh_fo",41463:"/22809537726/punjabijagran/pj_flyout",38225:"/22809537726/krishijagran/kj_flyout",40578:"/22809537726/krishijagran/marathikj_flyout",40795:"/22809537726/krishijagran/malayalamkj_flyout",40798:"/22809537726/krishijagran/tamilkj_flyout",49624:"/22809537726/krishijagran/hindikj_flyout",40913:"/22809537726/odia.krishijagran/okj_flyout",48055:"/22809537726/esakal/es_fo",49454:"/22809537726/sarkarnama/sn_fo",50861:"/22809537726/ahmednagarlive24/al_fo",36419:"/22809537726/haribhoomi/hb_fo"},p);function p(){}t.AdManager=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterDomain=void 0;var c=n(1),l=n(2),p=n(3),d=n(4),u=n(0),f=n(9),g=n(18),n=(y.init=function(){return i(this,void 0,void 0,function(){var t,n,i,o,r,a;return s(this,function(e){switch(e.label){case 0:return(t=p.Storage.getStorage(l.KeyMapper.UUID),3!=c.Config.notification.windowType||window.self==window.top)?[3,4]:(n={token:"",subscribed_on:"",uuid:t},p.Storage.getStorage(l.KeyMapper.MASTER_DOMAIN)?(i=y.getMasterStorage(l.KeyMapper.PUSH_TOKEN),r=y.getMasterStorage(l.KeyMapper.SUBSCRIBED_ON),""!=t||""==i?[3,2]:[4,u.Helper.getUUIDFromEndpoint(i)]):[3,3]);case 1:""!=(o=e.sent())&&(t=o,p.Storage.setStorage(l.KeyMapper.UUID,t)),e.label=2;case 2:n={token:i,subscribed_on:r,uuid:t},e.label=3;case 3:return u.Helper.postMessage("parent",l.KeyMapper.MASTER_TO_CHILD,n),u.Helper.addMsgReciever(d.NotificationHelper.msgReciever),[3,10];case 4:return window.location.origin!=c.Config.notification.masterDomain?[3,9]:""==(i=y.getMasterStorage(l.KeyMapper.PUSH_TOKEN))?[3,7]:""!=t?[3,6]:[4,u.Helper.getUUIDFromEndpoint(i)];case 5:""!=(o=e.sent())&&(t=o,p.Storage.setStorage(l.KeyMapper.UUID,t)),e.label=6;case 6:return(r=y.getMasterStorage(l.KeyMapper.SUBSCRIBED_ON))==c.Config.notification.masterDomain?(g.Main.moduleInitializer(),[2]):(1==d.NotificationHelper.getPermissionStatusFromStorage()?f.Queue.sync():d.NotificationHelper.tokenValidator(function(e){1==e?(d.NotificationHelper.updatePermissionStatus(1),f.Queue.sync()):g.Main.moduleInitializer()}),[3,8]);case 7:g.Main.moduleInitializer(),e.label=8;case 8:return[3,10];case 9:c.Config.store.isMDSyncingRequired&&(u.Helper.addMsgReciever(d.NotificationHelper.msgReciever),a=c.Config.notification.masterDomain+c.Config.notification.masterDomainPath+"?action=izcheckmaster&domain="+window.location.origin,u.Helper.addIFrame(a,l.KeyMapper.MASTER_AS_FRAME)),1==d.NotificationHelper.getPermissionStatusFromStorage()?(d.NotificationHelper.sendEvent(l.KeyMapper.ALREADY_GRANTED,y.getMasterStorage(l.KeyMapper.PUSH_TOKEN)),f.Queue.sync()):c.Config.store.isMDSyncingRequired||(u.Helper.addMsgReciever(d.NotificationHelper.msgReciever),a=c.Config.notification.masterDomain+c.Config.notification.masterDomainPath+"?action=izcheckmaster&domain="+window.location.origin,u.Helper.addIFrame(a,l.KeyMapper.MASTER_AS_FRAME)),e.label=10;case 10:return[2]}})})},y.masterDomainCallback=function(e,t){var n,i,o=!0,r=JSON.stringify(t);""!=c.Config.notification.masterDomain&&(e&&(o=!1,e=""!=(n=y.getMasterStorage(l.KeyMapper.MASTER_DOMAIN))?d.NotificationHelper.getSubscriptionKey(n):"",n=d.NotificationHelper.getSubscriptionKey(t),""!=e&&e==n||(o=!0)),o&&(window.location.origin==c.Config.notification.masterDomain?(i='{"iz_'+c.Config.client+'":{"'+l.KeyMapper.PUSH_TOKEN+'":'+r+',"'+l.KeyMapper.SUBSCRIBED_ON+'":"'+c.Config.notification.masterDomain+'","user_properties":{}}}',p.Storage.setStorage(l.KeyMapper.MASTER_DOMAIN,i)):self==top&&(n={token:r,subscribed_on:window.location.origin,uuid:c.Config.UUID},o=document.getElementById(l.KeyMapper.MASTER_AS_FRAME),u.Helper.postMessage(o,l.KeyMapper.CHILD_TO_MASTER,n),i='{"iz_'+c.Config.client+'":{"'+l.KeyMapper.PUSH_TOKEN+'":'+r+',"'+l.KeyMapper.SUBSCRIBED_ON+'":"'+window.location.origin+'","user_properties":{}}}',p.Storage.setStorage(l.KeyMapper.MASTER_DOMAIN,i)),window._izq=window._izq||[],window._izq.push(["userProfile",{add:{subscribed_on_url:window.location.origin}}])))},y.setMasterStorage=function(e){var t="";e.hasOwnProperty("uuid")&&e.uuid&&(t=e.uuid);var n='{"iz_'+c.Config.client+'":{"'+l.KeyMapper.PUSH_TOKEN+'":'+e.token+',"'+l.KeyMapper.SUBSCRIBED_ON+'":"'+e.subscribed_on+'","user_properties":{}}}';p.Storage.setStorage(l.KeyMapper.MASTER_DOMAIN,n),p.Storage.setStorage(l.KeyMapper.PUSH_TOKEN,encodeURIComponent(e.token)),t&&p.Storage.setStorage(l.KeyMapper.UUID,t)},y.getMasterStorage=function(e){var t="iz_"+c.Config.client,n="",t=(n=u.Helper.parseToJSON(p.Storage.getStorage(l.KeyMapper.MASTER_DOMAIN)))[t];return""!=n&&null!=t&&null!=t[e]?t[e]:""},y.masterConfigReciver=function(e){var t=e.token,n=e.subscribed_on,e=e.uuid,i={token:JSON.stringify(t),subscribed_on:n,uuid:e};""!=t&&e?d.NotificationHelper.tokenValidator(function(e){1==e?(d.NotificationHelper.updatePermissionStatus(l.KeyMapper.PROMPT_ALLOWED),y.setMasterStorage(i),d.NotificationHelper.sendEvent(l.KeyMapper.ALREADY_GRANTED,y.getMasterStorage(l.KeyMapper.PUSH_TOKEN)),f.Queue.sync()):0==e&&(p.Storage.removeConfigLocal(l.KeyMapper.PERMISSION_STATUS),g.Main.moduleInitializer())},e):g.Main.moduleInitializer()},y);function y(){}t.MasterDomain=n},function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},c=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Messenger=void 0;var l=n(1),p=n(0),d=n(4),i=n(3),o=n(5),u=n(2),r=n(7),f=n(6),n=(g.init=function(e){var t,n=this;if("http:"!=l.Config.global.locationProtocol&&0==l.Config.notification.windowType){if(0!=l.Config.messenger.status&&""!=l.Config.messenger.pageId){try{null==(g.messengerPrompt=l.Config.messenger.prompt).title&&(g.messengerPrompt.title="Connect with us for exclusive deals and offers!"),g.messengerPrompt.poweredbysrc=l.Config.notification.promptDesign.poweredbysrc}catch(e){}g.htmlContainer=d.NotificationHelper.loadDesign(g.messengerPrompt,g.getHtmlContainer());var i,o=document.createElement("iframe");o.id="izootoMessengerFrame",o.scrolling="no";var r=document.getElementById(g.anyWhereSelector);if(r){if(g.isAlreadySubscribed())return;g.promptSequencing(u.KeyMapper.MESSENGER_READY),g.htmlContainer=d.NotificationHelper.loadDesign(g.messengerPrompt,g.getHtmlContainer(!1));try{var a=document.createElement("style");a.innerText="#"+g.anyWhereSelector+"{overflow: hidden;text-align: center;} #izootoMessengerFrame{ height: "+g.heightMap[l.Config.messenger.size.toLocaleLowerCase()]+"; border: none; max-width: 256px;width:unset; }",null!=r&&r.appendChild(a),null!=r&&r.appendChild(o),g.isElementFound=!0}catch(e){p.Helper.displayLog("Error in appending child in izooto-messenger-div")}}else{if(1!=e){if(!l.Config.messenger.autoPrompt)return;if(g.isDelayed())return}if(g.triggered)return;g.triggered=!0,g.promptSequencing(u.KeyMapper.MESSENGER_READY);try{o.style="height: 249px; border: none; max-width: unset;width:unset;",(i=document.createElement("div")).id="izMsngrOptinOuterWrapper",i.innerHTML=' <div id="izMsngrIframeWrapper"></div><style>#izMsngrOptinOuterWrapper{display:none;position: fixed; width: 306px; height: 249px; z-index: 99999999999; bottom: 10px; right: 10px;}#izMsngrIframeWrapper{position: relative;}@media screen and (max-width: 600px){#izMsngrOptinOuterWrapper{width: 100%!important; height: 100%!important; position: fixed; left: 0!important; top: 0!important; bottom: unset!important; right: unset!important; z-index: 2147483647; background: #00000070;}#izMsngrIframeWrapper{position: absolute; right: 50%; bottom: 50%; transform: translate(50%, 50%);}}</style>',document.body.appendChild(i),null!==(t=document.getElementById("izMsngrIframeWrapper"))&&void 0!==t&&t.appendChild(o)}catch(e){p.Helper.displayLog("Error in appending child in messenger-div")}}g.frameElement=o,(g.frameContentWindow=o.contentWindow).fbAsyncInit=function(){g.addHtmlContainer(l.Config.messenger.pageId),g.frameContentWindow.FB.init({appId:g.appId,autoLogAppEvents:!0,xfbml:!0,version:"v12.0"}),g.frameContentWindow.FB.Event.subscribe("send_to_messenger",function(e){"rendered"==e.event&&0==e.is_after_optin&&setTimeout(function(){return s(n,void 0,void 0,function(){var t;return c(this,function(e){return g.frameContentWindow.document.querySelector("#izootoFbMessengerMainContainer")&&(g.isElementFound?(t=window.getComputedStyle(g.frameContentWindow.document.querySelector(".fb-send-to-messenger")),256<(t=parseInt(t.width))&&(t+=33,o.style="max-width: "+t+"px;width: "+t+"px;"),g.syncMessengerEvent()):g.promptSequencing(u.KeyMapper.MESSENGER_READY_SHOW)),[2]})})},400),"opt_in"==e.event&&(g.setMultiMessengerStorage(u.KeyMapper.MSNGR_IS_SUBSCRIBED,1),g.sendEvent(u.KeyMapper.MESSENGER_SUBSCRIBED),f.GoogleAnalytics.processMessanger("Send to Messenger"),g.promptSequencing(u.KeyMapper.MESSENGER_SUBSCRIBED),setTimeout(function(){g.htmlContainerClose(!0)},1e3))})};setTimeout(function(){var e=document.createElement("script");e.src="https://connect.facebook.net/en_US/sdk.js",o.contentDocument.body.appendChild(e)},200)}}else p.Helper.displayLog("Messenger is disabled for this device!")},g.syncMessengerEvent=function(){g.sendEvent(u.KeyMapper.MESSENGER_PROMPTED),1==i.Storage.getConfigLocal("messengerRepeated",u.KeyMapper.STATS)?f.GoogleAnalytics.processMessanger("Repeat Impression"):f.GoogleAnalytics.processMessanger("Impression"),i.Storage.setConfigLocal("messengerRepeated",1,u.KeyMapper.STATS),g.promptSequencing(u.KeyMapper.MESSENGER_PROMPTED),g.setRepeatPromptDelay(l.Config.messenger.repeatDelay)},g.showMessenger=function(){document.querySelector("#izMsngrOptinOuterWrapper").style.display="block",g.syncMessengerEvent()},g.htmlContainerClose=function(e){void 0===e&&(e=!1);var t=document.getElementById(g.anyWhereSelector)?g.frameElement:document.querySelector("#izMsngrOptinOuterWrapper");t&&(t.style.display="none"),0==e&&f.GoogleAnalytics.processMessanger("Dismissed"),g.promptSequencing(u.KeyMapper.PROMPT_CLOSED)},g.getHtmlContainer=function(e){return(e=void 0===e||e)?'<style> .fb_iframe_widget { display: -webkit-box; } .izooto-widget-overlay { background: transparent; width: unset; height: unset; position: unset; top: unset; left: unset; z-index: 2147483647; } .izooto-widget-position { position: fixed; right: 10px; bottom: 10px; z-index: 2147483647; } .izooto-fb-widget { background: #fff; box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.01), 0px 1px 18px 0px rgba(0, 0, 0, 0.03); border-radius: 4px; font-family: "sans-serif", Helvetica, Arial, Helvetica Neue; font-size: 15px; letter-spacing: 0.4px; width: 285px; position: relative; } .izooto-fb-close { background: transparent; border: none; font-size: 22px; position: relative; top: 2px; cursor: pointer; color: grey; } #izooto-fb-close-wrapper { display: flex; justify-content: flex-end; background: #dfeeff; padding: 0 5px; margin: 0 -24px;} .izooto-fb-top { padding: 24px; border-radius: 4px 4px 0 0; background: #dfeeff; padding-bottom: 10px; padding-top: 0; margin-top: -4px; } .izooto-fb-title { line-height: 20px; font-weight: 500; color: #000; padding-bottom: 6px; } a.izooto-fb-branding { display: block; padding-top: 6px; font-size: 11px; color: #1f82f7; font-family: "sans-serif", Helvetica, Arial, Helvetica Neue; text-decoration: none; letter-spacing: 0.8px; } a:hover.izooto-fb-branding { display: block; padding-top: 6px; font-size: 11px; color: #1f82f7; font-family: "sans-serif", Helvetica, Arial, Helvetica Neue; text-decoration: none; letter-spacing: 0.8px; } .izooto-fb-bottom { background: white; border-radius: 0 0 4px 4px; padding: 24px; background: #fff; } @media screen and (max-width:600px) { .izmobilemsngr #izooto-fb-close-wrapper { padding: 0; } .izmobilemsngr .izooto-fb-close { background: #195086; border: none; font-size: 22px; position: relative; top: -10px; cursor: pointer; color: white; border-radius: 50px; width: 28px; height: 28px; text-align: center; vertical-align: middle; display: unset; padding: 0 0; line-height: 0; margin: 0 -5px; } }</style><div class="izooto-widget-overlay"> <div class="izooto-widget-position"> <div class="izooto-fb-widget"> <div class="izooto-fb-top" dir="auto"><div id="izooto-fb-close-wrapper"> <button type="button" class="izooto-fb-close" onclick="window.top._izooto.messengerClass.htmlContainerClose();">&times;</button> </div>  <div class="izooto-fb-title">{{--title--}}</div><a target="_blank" href="{{--poweredbysrc--}}" class="izooto-fb-branding izbranding"><span style="color:grey;">Powered by</span> '+l.Config.brandingPartner+'</a></div> <div class="izooto-fb-bottom"> <div id="izFbContainer" style="margin-left:42px;"></div> </div> </div> </div>':'<style>body{ margin:0px;} #izFbContainer{ margin-left: 33px; position: absolute; } </style><div id="izFbContainer"></div>'},g.addHtmlContainer=function(e){var t=g.htmlContainer,n=document.createElement("div");n.setAttribute("id","izootoFbMessengerMainContainer");var i=function(){window.outerWidth<=600?n.setAttribute("class","izmobilemsngr"):n.setAttribute("class","")};i(),window.addEventListener("resize",i),n.innerHTML=t,(g.frameContentWindow.document.body||g.frameContentWindow.document.head).appendChild(n);var i=l.Config.UUID,t=l.Config.client+"=/="+i+"=/="+l.Config.global.os+"=/="+l.Config.global.browserVer+"=/="+l.Config.global.deviceType+"=/="+l.Config.global.browserType,i=document.createElement("div");i.setAttribute("class","fb-send-to-messenger"),i.setAttribute("messenger_app_id",g.appId),i.setAttribute("page_id",e),i.setAttribute("color",g.isElementFound?l.Config.messenger.color:"blue"),i.setAttribute("size",g.isElementFound?l.Config.messenger.size:"large"),i.setAttribute("data-ref",t),l.Config.messenger.buttonTextType&&g.isElementFound&&i.setAttribute("cta_text",this.ctaText[l.Config.messenger.buttonTextType]),null!==(t=g.frameContentWindow.document.querySelector("#izFbContainer"))&&void 0!==t&&t.appendChild(i),p.Helper.izootoBrandingHandler(g.frameContentWindow)},g.isDelayed=function(){return 1==g.getMultiMessengerStorage(u.KeyMapper.MSNGR_IS_SUBSCRIBED)||g.getMultiMessengerStorage(u.KeyMapper.MSNGR_REPEAT_PROMPT_DELAY)>Date.now()},g.isAlreadySubscribed=function(){return 1==g.getMultiMessengerStorage(u.KeyMapper.MSNGR_IS_SUBSCRIBED)},g.syncEvent=function(e){var t="",t=e==u.KeyMapper.MESSENGER_SUBSCRIBED?p.Helper.getEndpoint("syncMessenger"):p.Helper.getEndpoint(e),e=g.getParameterToSync(e);o.HttpRequest.postForm(t,e,!0).then(function(){}).catch(function(e){})},g.setRepeatPromptDelay=function(e){var t;0!==e&&(t=(t=new Date).setTime(t.getTime()+60*e*1e3),g.setMultiMessengerStorage(u.KeyMapper.MSNGR_REPEAT_PROMPT_DELAY,t))},g.setMultiMessengerStorage=function(e,t){var n=i.Storage.getConfigLocal(l.Config.messenger.pageId,u.KeyMapper.MESSENGER);(n=n?p.Helper.parseToJSON(n):{})[e]=t;n=JSON.stringify(n);i.Storage.setConfigLocal(l.Config.messenger.pageId,n,u.KeyMapper.MESSENGER)},g.getMultiMessengerStorage=function(e){var t=i.Storage.getConfigLocal(l.Config.messenger.pageId,u.KeyMapper.MESSENGER);return t&&null!=(t=p.Helper.parseToJSON(t))[e]?t[e]:""},g.promptSequencing=function(e){-1<[u.KeyMapper.MESSENGER_PROMPTED,u.KeyMapper.MESSENGER_SUBSCRIBED,u.KeyMapper.PROMPT_CLOSED,u.KeyMapper.MESSENGER_READY_SHOW,u.KeyMapper.MESSENGER_READY].indexOf(e)&&!g.isElementFound&&r.ChannelEventHandler.event("messenger",e)},g.sendEvent=function(e){var t=[u.KeyMapper.MESSENGER_SUBSCRIBED];l.Config.messenger.syncPrompt&&t.push(u.KeyMapper.MESSENGER_PROMPTED),-1!=t.indexOf(e)&&g.syncEvent(e)},g.getParameterToSync=function(e){var t={pid:l.Config.client,btype:l.Config.global.browserType,dtype:l.Config.global.deviceType,os:l.Config.global.os,page_id:l.Config.messenger.pageId,bKey:l.Config.UUID};switch(e){case u.KeyMapper.MESSENGER_SUBSCRIBED:t.ms=1;break;case u.KeyMapper.MESSENGER_PROMPTED:t.msp=1;break;default:t[e]=1}return t},g.anyWhereSelector="izooto-messenger-subscription-button",g.isElementFound=!1,g.frameElement=void 0,g.triggered=!1,g.appId="1061905150807841",g.ctaText=[,"GET_THIS_IN_MESSENGER","RECEIVE_THIS_IN_MESSENGER","SEND_THIS_TO_ME","GET_CUSTOMER_ASSISTANCE","GET_CUSTOMER_SERVICE","GET_SUPPORT","LET_US_CHAT","SEND_ME_MESSAGES","ALERT_ME_IN_MESSENGER","SEND_ME_UPDATES","MESSAGE_ME","LET_ME_KNOW","KEEP_ME_UPDATED","TELL_ME_MORE","SUBSCRIBE_IN_MESSENGER","SUBSCRIBE_TO_UPDATES","GET_MESSAGES","SUBSCRIBE","GET_STARTED_IN_MESSENGER","LEARN_MORE_IN_MESSENGER","GET_STARTED"],g.heightMap={standard:"44px",large:"58px",xlarge:"71px"},g);function g(){}t.Messenger=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Session=void 0;var i=n(1),o=n(0),r=n(3),a=n(2),n=(s.init=function(){i.Config.global.isSessionHandled||(s.sessionHandler(),i.Config.global.isSessionHandled=!0)},s.sessionHandler=function(){var e;s.isSessionExpired()&&(t=r.Storage.getConfigLocal(a.KeyMapper.SESSION_COUNT,a.KeyMapper.SESSION),e=r.Storage.getConfigLocal(a.KeyMapper.FIRST_SESSION,a.KeyMapper.SYNC),t&&e&&o.Helper.getDateDiffrenceFromPresent(e)<=s.visitWithinDays?r.Storage.setConfigLocal(a.KeyMapper.SESSION_COUNT,t+1,a.KeyMapper.SESSION):(r.Storage.setConfigLocal(a.KeyMapper.SESSION_COUNT,1,a.KeyMapper.SESSION),r.Storage.updateLastSync(a.KeyMapper.FIRST_SESSION)));var t=(t=new Date).setTime(t.getTime()+60*s.sessionExpiryMinute*1e3);new Date(t),r.Storage.setConfigLocal(a.KeyMapper.SESSION_EXPIRY,t,a.KeyMapper.SESSION)},s.isSessionExpired=function(){var e=r.Storage.getConfigLocal(a.KeyMapper.SESSION_EXPIRY,a.KeyMapper.SESSION),t=new Date;return!(""!=e&&e>t.getTime())&&(s.isNew=!0)},s.getSessionCount=function(){return r.Storage.getConfigLocal(a.KeyMapper.SESSION_COUNT,a.KeyMapper.SESSION)||0},s.isNew=!1,s.sessionExpiryMinute=30,s.visitWithinDays=7,s);function s(){}t.Session=n},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},r=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ExitIntent=void 0;var a=n(1),d=n(0),s=n(3),c=n(2),l=n(5),p=n(13),u=n(7),n=(f.init=function(){f.startTime=(new Date).getTime(),1==a.Config.exitIntent.status||1==a.Config.stickyBar.status?f.getValidFeed().then(function(e){f.notificationFeedData=e,f.rfid=null!==(e=e[0].fi)&&void 0!==e?e:null,f.initializeOnsite(a.Config.exitIntent),f.initializeOnsite(a.Config.stickyBar)}).catch(function(e){d.Helper.displayLog("Exit intent unable to load final data ",e)}):d.Helper.displayLog("Onsite is Disabled for this site")},f.loadFeed=function(){return o(this,void 0,void 0,function(){var i,o;return r(this,function(e){return i={},o=[51120],[2,new Promise(function(t,n){var e="https://rec.izooto.com/rec/"+a.Config.hashFileName+"/0.json";a.Config.exitIntent.feedHash&&(e="https://rec.izooto.com/rec/v2/"+a.Config.exitIntent.feedHash+"/0.json"),-1<o.indexOf(a.Config.client)?f.loadClientSideFeed().then(t).catch(n):l.HttpRequest.get(e).then(function(e){try{(i=d.Helper.parseToJSON(e))&&t(i)}catch(e){n(i),d.Helper.displayLog("Error to loadfeed:",e)}}).catch(function(){n(i)})})]})})},f.loadClientSideFeed=function(){return new Promise(function(e,t){var n=null===(n=d.Helper.getDomElement('link[type="application/rss+xml"]'))||void 0===n?void 0:n.href;n||t("Feed url not found on this page!"),l.HttpRequest.get(n).then(f.parseFieldsFromXml).then(e).catch(t)})},f.parseFieldsFromXml=function(e){var o=[];try{var r=new DOMParser;r.parseFromString(e,"text/xml").querySelectorAll("item").forEach(function(e){var t=null===(i=null===(t=e.querySelector("title"))||void 0===t?void 0:t.textContent)||void 0===i?void 0:i.trim(),n=null===(i=null===(i=e.querySelector("link"))||void 0===i?void 0:i.textContent)||void 0===i?void 0:i.trim(),e=r.parseFromString((null===(i=e.querySelector("description"))||void 0===i?void 0:i.textContent)||"","text/html"),i=((null===(i=null==e?void 0:e.body)||void 0===i?void 0:i.innerText)||"").trim(),e=((null===(e=e.querySelector("img"))||void 0===e?void 0:e.src)||"").trim();-1==o.findIndex(function(e){return e.itemLink==n})&&t&&e&&n&&o.push({t:t,l:n,m:i,mi:e,i:"",pt:""})});var t=o.splice(0,5);return t}catch(e){}},f.getValidFeed=function(){return o(this,void 0,void 0,function(){return r(this,function(e){return[2,new Promise(function(i,o){f.loadFeed().then(function(e){var t=[];if(0!=e.length){for(var n in e){n=e[n];""==n.t||""==n.i&&""==n.mi||t.push(n)}i(t)}else o("Feed is not valid")}).catch(function(e){o(e)})})]})})},f.onSiteVerifiedFeed=function(e){if(f.notificationFeedData.length>=e){var t=void 0;return(t=f.exitIntent.maxAllowedPost==e?f.getExitIntentSortedFeed(f.notificationFeedData):f.notificationFeedData).sort(function(e,t){return.5-Math.random()}),t.splice(0,e)}},f.getExitIntentSortedFeed=function(e){if(""==e[0].m)for(var t=1;t<e.length;t++)if(""!=e[t].m){var n=e[0];e[0]=e[t],e[t]=n;break}return e},f.getParsedFeed=function(t){return o(this,void 0,void 0,function(){var n,i;return r(this,function(e){return n=(1==t?f.exitIntent:f.stickyBar).maxAllowedPost,i=1==t?"Exit_Intent_Recommendations":"sticky_bar_recommendations",[2,new Promise(function(e,t){try{e((f.onSiteVerifiedFeed(n)||[]).map(function(e){return{title:e.t,message:e.m,image:e.i||e.mi,url:f.addUTMOnUrl(e.l,i),publishTime:e.pt}}))}catch(e){d.Helper.displayLog("Exit intent unable to load final data ",e),t(e)}})]})})},f.initializeOnsite=function(e){0==e.status||a.Config.global.isFrame?d.Helper.displayLog("Onsite is disabled for this site:"):!e.mobileAllowed&&1!=a.Config.global.deviceType||!e.desktopAllowed&&1==a.Config.global.deviceType?d.Helper.displayLog("Onsite "+e.type+" is disabled for this device"):e.autoPopup?0!=e.rid&&0!=e.cid&&(f.isRepeatDelayed(1==e.type?c.KeyMapper.EXITINTENT_DELAY:c.KeyMapper.STICKYBAR_DELAY)||(1==e.type?f.exitIntentRegisterEvent():f.registerSinglePageScroll())):e.type},f.exitIntentRegisterEvent=function(){a.Config.exitIntent.onExit&&f.onExitHandler(function(){f.exitIntentInitializeDialog(1)}),0<a.Config.exitIntent.onDelay&&setTimeout(function(){f.exitIntentInitializeDialog(2)},1e3*a.Config.exitIntent.onDelay),0<a.Config.exitIntent.onScrollPercent&&f.exitIntentScollHandler(function(){f.exitIntentInitializeDialog(3)}),a.Config.exitIntent.onBack&&f.backButtonIntentHandler()},f.onExitHandler=function(n){1==a.Config.global.deviceType&&document.addEventListener("mouseout",function(e){var t;(!(t=(null!=e!=e?e:window.event).relatedTarget||e.toElement)||"HTML"===t.nodeName)&&e.clientY<100&&n()}),1<a.Config.global.deviceType&&document.addEventListener("visibilitychange",function(){document.hidden&&n()})},f.exitIntentScollHandler=function(t){var n;d.Helper.isScreenScrollable()&&(n=0,document.addEventListener("scroll",function(){var e=window.pageYOffset||document.documentElement.scrollTop;n<e&&f.initializeExitIntentOnScrollPercent(t),n=e<=0?0:e},!1))},f.initializeExitIntentOnScrollPercent=function(e){var t=document.documentElement,n=document.body,i="scrollTop",o="scrollHeight",t=(t[i]||n[i])/((t[o]||n[o])-t.clientHeight)*100;Math.round(t)>=a.Config.exitIntent.onScrollPercent&&e()},f.backButtonIntentHandler=function(){var e=s.Storage.getSessionStorage("izootoOSNDisplayed");""==location.hash&&!e&&f.isSupportedBackIntent()&&(f.isFirstPage()?(f.onBackButtonTriggerHandler(!0),f.onUrlChangeHandler(),window.addEventListener("beforeunload",f.setHistoryStateIntoStorage),f.setHistoryStateIntoStorage()):f.isNavigatedBackToFirstPage()&&f.attachPopstateListener())},f.registerSinglePageScroll=function(){var e=!1;document.addEventListener("scroll",function(){return e?void(f.stickyBar.isDialogInitialize&&f.toggleWidgetOnscroll()):(f.getScrollDirection()==c.KeyMapper.SCROLL_DOWN&&window.scrollY>=window.innerHeight&&(e=!0,f.stickyBarInitializeDialog()),!1)},!1)},f.stickyBarInitializeDialog=function(){try{var e=void 0;a.Config.stickyBar.ads&&(e=d.Helper.addExternalJS(p.AdManager.GPTScriptSrc,"izootoGPT")),Promise.all([e,f.showStickyBarDialog()]).then(function(){a.Config.stickyBar.ads&&f.stickyBarAdsHandler()}).catch(function(e){d.Helper.displayLog(" Stickybar initializeDialog error",e)})}catch(e){}},f.exitIntentInitializeDialog=function(e){try{if(f.exitIntent.isDialogInitialize)return!1;f.exitIntent.isDialogInitialize=!0;var t=void 0;!0===p.AdManager.isThirdPartyAds()?t=p.AdManager.getJSONAd():a.Config.exitIntent.ads&&(t=d.Helper.addExternalJS(p.AdManager.GPTScriptSrc,"izootoGPT")),Promise.all([t,f.showexitIntentDialog(e)]).then(function(e){e=e[0];e.hasOwnProperty("isAd")?f.exitIntentAdsHandler(e):f.exitIntentAdsHandler()}).catch(function(e){d.Helper.displayLog("Exit intent initializeDialog error",e)})}catch(e){}},f.setExitIntentFeed=function(e){if(e.length==f.exitIntent.maxAllowedPost&&"object"==typeof e)return f.exitIntent.largePostData=e[0],e.shift(),f.exitIntent.smallPostData=e,!0},f.showexitIntentDialog=function(i){return o(this,void 0,void 0,function(){return r(this,function(e){try{return[2,new Promise(function(t,n){f.exitIntent.triggerOnEventType=i,f.getParsedFeed(a.Config.exitIntent.type).then(function(e){f.setExitIntentFeed(e)&&f.getHTML(f.exitIntent.htmlSrc).then(function(e){d.Helper.addHTML("div",e,f.exitIntent.dialogBoxID),f.getExitIntentDialogToDisplay(e).then(function(e){u.ChannelEventHandler.event("exitIntent",c.KeyMapper.EXITINTENT_SHOWN),e.style.display="block",f.syncOnsiteView(a.Config.exitIntent.type),f.setRepeatPromptDelay(a.Config.exitIntent.repeatDelay,c.KeyMapper.EXITINTENT_DELAY),t(!0)})})}).catch(function(e){n(!1),d.Helper.displayLog("showDialog error",e)})})]}catch(e){}return[2]})})},f.exitIntentTrackingObj=function(){return i({pid:a.Config.client,bkey:a.Config.UUID,cid:a.Config.exitIntent.cid,rid:a.Config.exitIntent.rid,ed:f.getEventTime(),tt:f.exitIntent.triggerOnEventType,ot:a.Config.exitIntent.type},f.rfid?{fi:f.rfid}:{})},f.getExitIntentDialogToDisplay=function(e){return o(this,void 0,void 0,function(){return r(this,function(e){return[2,new Promise(function(e,t){try{f.setExitIntentPostsArticle(),f.exitIntentApplyConfigStyle(),e(f.getTypedDomElement(".iz_osn",a.Config.exitIntent.type))}catch(e){t()}})]})})},f.geStickyBarDialogToDisplay=function(e){return o(this,void 0,void 0,function(){return r(this,function(e){return[2,new Promise(function(e,t){try{f.setStickyBarArticle(),f.stickyBarApplyConfigStyle(),e(f.getTypedDomElement(".iz_osn",a.Config.stickyBar.type))}catch(e){t()}})]})})},f.setLargePostArticle=function(){var e=f.getTypedDomElement("."+f.osnPrefix+"left",a.Config.exitIntent.type);f.setOsnDataIntoElement(e,f.exitIntent.largePostData,0,a.Config.exitIntent.type)},f.setExitIntentPostsArticle=function(){try{f.setLargePostArticle();var e=f.getTypedDomElement("."+f.osnPrefix+"right",a.Config.exitIntent.type),t=f.getTypedDomElement("."+f.osnPrefix+"smContainer",a.Config.exitIntent.type);f.exitIntent.singlePostHTML=t;var n=document.querySelector("."+f.osnPrefix+"smContainer_1>div"),i=window.getComputedStyle(n).getPropertyValue("background-image");f.defaultImage=i.match(/\((.*?)\)/)[1].replace(/('|")/g,""),t.remove(),1!=a.Config.global.deviceType&&(!0===p.AdManager.isThirdPartyAds()?f.exitIntent.smallPostAllowed=3:f.exitIntent.smallPostAllowed=a.Config.exitIntent.ads?3:2);for(var o=0;o<f.exitIntent.smallPostAllowed;o++){var r=f.exitIntent.singlePostHTML.cloneNode(!0);r.id="iz-osn-exitIntent-article-"+o,e.appendChild(r),f.setSmallPosts(o,f.exitIntent.smallPostData[o],a.Config.exitIntent.type)}}catch(e){}},f.setStickyBarArticle=function(){var e=f.getTypedDomElement("."+f.osnPrefix+"carousel",a.Config.stickyBar.type),t=f.getTypedDomElement("."+f.osnPrefix+"notification",a.Config.stickyBar.type);f.stickyBar.singlePostHTML=t,f.defaultImage=t.querySelector("img").src,t.remove();for(var n=0;n<f.stickyBar.maxAllowedPost;n++){var i=f.stickyBar.singlePostHTML.cloneNode(!0);i.id="iz-osn-sticky-article-"+n,e.appendChild(i),f.setSmallPosts(n,f.stickyBar.postData[n],a.Config.stickyBar.type)}},f.stickyBarAdsHandler=function(e){try{var n=d.Helper.getDomElement("#iz-osn-sticky-article-1");n.innerHTML="";var t=document.createElement("div");t.id="iz-stickybar-ads",t.setAttribute("style","margin: 0 auto;"),n.appendChild(t),p.AdManager.loadOnsiteAd(t.id,a.Config.stickyBar.adUnit).then(function(e){f.stickyBar.adNotificationNo=1;var t=document.querySelector("#iz-stickybar-ads>div");300<t.clientWidth&&(n.style.minWidth=t.clientWidth+20+"px")}).catch(function(e){f.stickyBarAdFaliure(1)})}catch(e){}},f.getRandomInt=function(e){return Math.floor(Math.random()*e)},f.exitIntentAdsHandler=function(e){try{var t,n=this.getRandomInt(f.exitIntent.smallPostAllowed),i=d.Helper.getDomElement("#iz-osn-exitIntent-article-"+n);e?f.setSmallPosts(n,e,a.Config.exitIntent.type):a.Config.exitIntent.ads&&(i.classList.remove("iz_osn_article_1"),i.innerHTML="",(t=document.createElement("div")).id="iz-exitintent-ads",t.setAttribute("style","margin: 0 auto;"),i.appendChild(t),p.AdManager.loadOnsiteAd(t.id,a.Config.exitIntent.adUnit).then(function(e){f.exitIntent.adNotificationNo=n,i.classList.add("iz_osn_article_1")}).catch(function(e){1!=a.Config.global.deviceType?i.style.display="none":(i.classList.add("iz_osn_article_1"),f.exitIntentAdFaliure(n))}))}catch(e){}},f.exitIntentAdFaliure=function(e){var t=f.exitIntent.singlePostHTML.cloneNode(!0);d.Helper.getDomElement("#iz-osn-exitIntent-article-"+e).innerHTML=t.innerHTML,f.setSmallPosts(e,f.exitIntent.smallPostData[e],a.Config.exitIntent.type)},f.stickyBarAdFaliure=function(e){var t=f.stickyBar.singlePostHTML.cloneNode(!0);d.Helper.getDomElement("#iz-osn-sticky-article-"+e).innerHTML=t.innerHTML,f.setSmallPosts(e,f.stickyBar.postData[e],a.Config.stickyBar.type)},f.setSmallPosts=function(e,t,n){var i=d.Helper.getDomElement("#iz-osn-"+(1==n?"exitIntent":"sticky")+"-article-"+e);f.setOsnDataIntoElement(i,t,e+1,n)},f.setOsnDataIntoElement=function(e,t,n,i){try{var o,r=1==i?d.Helper.getDomElement(".iz_osn_icon_1",e):d.Helper.getDomElement("img",e),a=f.getTypedDomElement("."+f.osnPrefix+"title",i,e),s=f.getTypedDomElement("."+f.osnPrefix+"timestamp",i,e),c=f.getTypedDomElement("."+f.osnPrefix+"message",i,e),l=1==i?f.exitIntentTrackingObj():f.stickyBarTrackingObj();c&&(150<=t.message.length&&(t.message+="..."),c.innerHTML=t.message,""==t.message&&c.classList.remove(f.osnPrefix+"message_"+i)),a.innerHTML=t.title,1==i?((o=new Image).src=t.image,o.onload=function(e){e.target.onload=void 0,r.style.backgroundImage="url("+o.src+")"},o.onerror=function(e){e.target.src!=f.defaultImage&&(e.target.onload=void 0,r.style.backgroundImage="url("+o.src+")")}):(r.src=t.image,r.onload=function(e){e.target.onload=void 0,e.target.src=t.image},r.onerror=function(e){e.target.src!=f.defaultImage&&(e.target.onload=void 0,e.target.src=f.defaultImage)});var p=t.publishTime;""==p?s.style.display="none":t.isAd?(s.innerHTML="Sponsored",s.style.display="block"):s.innerHTML=d.Helper.getTimeAgoStringByTimestamp(1e3*p),e.onclick=function(){window.open(t.url),t.isAd&&(l.cid="ads",l.rid="ads"),f.syncOnsiteClick(i,t.url,n)},f.loaderClose(e,i)}catch(e){d.Helper.displayLog("Error to set RightContainer article",e)}},f.getTypedDomElement=function(e,t,n){return d.Helper.getDomElement(e+"_"+t,n)},f.loaderClose=function(e,t){try{for(var n=e.querySelectorAll("."+f.osnPrefix+"animated_"+t),i=0;i<n.length;i++)n[i].classList.remove(f.osnPrefix+"animated_"+t)}catch(e){d.Helper.displayLog("Error to close loader on article")}},f.showStickyBarDialog=function(){return o(this,void 0,void 0,function(){return r(this,function(e){try{return[2,new Promise(function(n,t){f.getParsedFeed(a.Config.stickyBar.type).then(function(e){e.length==f.stickyBar.maxAllowedPost&&"object"==typeof e&&(f.stickyBar.postData=e,f.getHTML(f.stickyBar.htmlSrc).then(function(e){d.Helper.addHTML("div",e,f.stickyBar.dialogBoxID),f.geStickyBarDialogToDisplay(e).then(function(e){u.ChannelEventHandler.event("stickyBar",c.KeyMapper.STICKYBAR_READY_SHOW);var t=setInterval(function(){f.stickyBar.readyToShow&&(clearInterval(t),n(!0))},50)})}))}).catch(function(e){t(!1),d.Helper.displayLog("showDialog error",e)})})]}catch(e){}return[2]})})},f.stickybarReadyToShow=function(){f.showStickyBar(),f.stickyBar.readyToShow=!0,u.ChannelEventHandler.event("stickyBar",c.KeyMapper.STICKYBAR_SHOWN),f.syncOnsiteView(a.Config.stickyBar.type),f.setRepeatPromptDelay(a.Config.stickyBar.repeatDelay,c.KeyMapper.STICKYBAR_DELAY),setTimeout(function(){f.stickyBar.isDialogInitialize=!0},3e3),f.stickyBarContentScroll()},f.stickyBarTrackingObj=function(){return{pid:a.Config.client,bkey:a.Config.UUID,cid:a.Config.stickyBar.cid,rid:a.Config.stickyBar.rid,ot:a.Config.stickyBar.type}},f.getHTML=function(i){return o(this,void 0,void 0,function(){return r(this,function(e){return[2,new Promise(function(t,n){l.HttpRequest.get(i).then(function(e){e||n(),t(e)}).catch(function(e){n(e)})})]})})},f.isSupportedBackIntent=function(){return a.Config.global.deviceType==c.KeyMapper.DEVICE_TYPE_MOBILE&&(a.Config.global.browserName==c.KeyMapper.BROWSER_CHROME||a.Config.global.browserName==c.KeyMapper.BROWSER_FIREFOX||a.Config.global.browserName==c.KeyMapper.BROWSER_SAFARI)},f.onUrlChangeHandler=function(){var t=location.href;new MutationObserver(function(e){location.href!==t&&(t=location.href,f.isNavigatedBackToFirstPage()?f.attachPopstateListener():f.removePopstateListener())}).observe(document,{subtree:!0,childList:!0})},f.onBackButtonTriggerHandler=function(e){(e=void 0===e?!1:e)&&window.history.pushState(f.exitIntent.firstPageStateID,""),d.Helper.displayLog("onBackButtonHandler listener added"),f.attachPopstateListener()},f.attachPopstateListener=function(){window.addEventListener("popstate",f.popstateListener,{once:!0})},f.removePopstateListener=function(){window.removeEventListener("popstate",f.popstateListener)},f.popstateListener=function(e){""==location.hash&&(f.exitIntentInitializeDialog(4),s.Storage.setSessionStorage("izootoOSNDisplayed",1))},f.setHistoryStateIntoStorage=function(){var e=window.history.state;f.setTabID(e)},f.isNavigatedBackToFirstPage=function(){return history.state==f.getTabID()},f.isFirstPage=function(){return!f.getTabID()},f.getTabID=function(){return s.Storage.getSessionStorage("izootoFirstPageStateID")},f.setTabID=function(e){s.Storage.setSessionStorage("izootoFirstPageStateID",e)},f.stickyBarApplyConfigStyle=function(){var e,t=d.Helper.getDomElement("."+f.osnPrefix+"heading_"+a.Config.stickyBar.type);t.style.color=a.Config.stickyBar.titleColor,""!=a.Config.stickyBar.title&&(e=(e=a.Config.stickyBar.title.trim()).slice(0,50),t.innerHTML=e),f.setCSSProperty("--iz-header-bg-color",a.Config.exitIntent.bgColor),f.closeHandler(function(){f.closeStickyDialog()},a.Config.stickyBar.type)},f.exitIntentApplyConfigStyle=function(){try{var e=f.osnPrefix+"heading_1",t=f.osnPrefix+"card_1";d.Helper.getDomElement("."+t).style.borderTopColor=a.Config.exitIntent.bgColor;var n=d.Helper.getDomElement("."+e);n.style.color=a.Config.exitIntent.titleColor,n.innerHTML=a.Config.exitIntent.title,d.Helper.izootoBrandingHandler(),f.brandLogoHandler(),f.closeHandler(function(){f.hideExitIntent()},a.Config.exitIntent.type),d.Helper.setHref(".iz-osn-branding-text-1","https://www.izooto.com/campaign/getting-started-with-izooto?utm_source=referral&utm_medium=on_site_notification")}catch(e){d.Helper.displayLog("Error on show OSN dialogbox",e)}},f.brandLogoHandler=function(){try{var e,t=a.Config.exitIntent.logoURL.trim();t.startsWith("http")&&((e=d.Helper.getDomElement(".iz_osn_branding_logo")).src=t,e.style.display="block")}catch(e){d.Helper.displayLog("OSN : Cannot find logo element",e)}},f.addUTMOnUrl=function(e,t){e=d.Helper.replaceQueryParam(e,"utm_source","izooto"),e=d.Helper.replaceQueryParam(e,"utm_medium","on_site_interactions");return e=d.Helper.replaceQueryParam(e,"utm_campaign",t)},f.setCSSProperty=function(e,t){document.body.style.setProperty(e,t)},f.closeHandler=function(n,i){(1==i?document.querySelectorAll("."+f.osnPrefix+"overlay_1,."+f.osnPrefix+"close_1"):document.querySelectorAll("."+f.osnPrefix+"close_2")).forEach(function(t){t.addEventListener("click",function(e){e.stopPropagation(),1==i&&e.target!==t||n()})})},f.hideExitIntent=function(){try{d.Helper.getDomElement("#"+f.exitIntent.dialogBoxID).style.display="none",f.syncOnsiteDismissed(a.Config.exitIntent.type),f.setRepeatPromptDelay(a.Config.exitIntent.closeDelay,c.KeyMapper.EXITINTENT_DELAY),u.ChannelEventHandler.event("exitIntent",c.KeyMapper.EXITINTENT_CLOSED)}catch(e){}},f.getEventTime=function(){var e=new Date,t=new Date(f.startTime),t=e.getTime()-t.getTime();return parseInt(t/1e3)},f.setRepeatPromptDelay=function(e,t){var n;0!==e&&(n=(n=new Date).setTime(n.getTime()+60*e*1e3),s.Storage.setConfigLocal(t,n))},f.isRepeatDelayed=function(e){var t=!1,n=new Date,e=s.Storage.getConfigLocal(e);return""!=e&&e>n.getTime()&&(t=!0,d.Helper.displayLog("Wait until onsite repeat delay expire!")),t},f.syncOnsiteView=function(e){var t=1==(e=void 0===e?1:e)?f.exitIntentTrackingObj():f.stickyBarTrackingObj();t.tt&&3==t.tt&&(t.tp=a.Config.exitIntent.onScrollPercent);e=(1==e?f.exitIntent:f.stickyBar).adNotificationNo;e&&(t.adp=e);e=d.Helper.getEndpoint("syncOnsiteView");l.HttpRequest.postForm(e,t,!0).then(function(){a.Config.brandingPartner}).catch(function(e){})},f.syncOnsiteDismissed=function(e){var t=1==e?f.exitIntentTrackingObj():f.stickyBarTrackingObj();t.tt&&3==t.tt&&(t.tp=a.Config.exitIntent.onScrollPercent);e=(1==e?f.exitIntent:f.stickyBar).adNotificationNo;e&&(t.adp=e);e=d.Helper.getEndpoint("syncOnsiteDismissed");l.HttpRequest.postForm(e,t,!0).catch(function(e){})},f.syncOnsiteClick=function(e,t,n){e=1==e?f.exitIntentTrackingObj():f.stickyBarTrackingObj(),t=encodeURIComponent(t);e.link=t,e.nc=n,"ads"==e.rid&&(e.adp=n),e.tt&&3==e.tt&&(e.tp=a.Config.exitIntent.onScrollPercent);n=d.Helper.getEndpoint("syncOnsiteClick");l.HttpRequest.postForm(n,e,!0).then(function(){a.Config.brandingPartner}).catch(function(e){})},f.toggleWidgetOnscroll=function(){f.stickyBar.isClosed||f.stickybarHide||(f.getScrollDirection()==c.KeyMapper.SCROLL_DOWN?f.hideStickyBar():f.showStickyBar())},f.showStickyBar=function(){var e=d.Helper.getDomElement(".iz_osn_slide_down");e&&e.classList.replace("iz_osn_slide_down","iz_osn_slide_up"),d.Helper.showElement("#iz_osn_container_stickyBar",!1)},f.hideStickyBar=function(){d.Helper.getDomElement("#iz_osn_container_stickyBar").classList.replace("iz_osn_slide_up","iz_osn_slide_down")},f.closeStickyDialog=function(){d.Helper.getDomElement("#iz_osn_container_stickyBar").classList.replace("iz_osn_slide_up","iz_osn_slide_down"),f.stickyBar.isClosed=!0,f.syncOnsiteDismissed(a.Config.stickyBar.type),u.ChannelEventHandler.event("stickyBar",c.KeyMapper.STICKYBAR_CLOSED),f.setRepeatPromptDelay(a.Config.stickyBar.closeDelay,c.KeyMapper.STICKYBAR_DELAY)},f.stickyBarContentScroll=function(){var t=this,e=f.getTypedDomElement(".iz_osn_right_arrow",2),n=f.getTypedDomElement(".iz_osn_left_arrow",2);3==a.Config.global.deviceType&&f.mobScrollObserver(),e.addEventListener("click",function(e){t.setScroll("right")}),n.addEventListener("click",function(e){t.setScroll("left")})},f.setScroll=function(e){var t;3==a.Config.global.deviceType?(t="right"==e?f.stickyBar.currentIndex+1:f.stickyBar.currentIndex-1,null!=(t=document.querySelector("#iz-osn-sticky-article-"+t))&&t.scrollIntoView({behavior:"smooth",inline:"start"})):(t=document.querySelector(".iz_osn_carousel_2"),e="right"==e?t.scrollWidth:0,t.scrollTo({left:e,behavior:"smooth"}))},f.mobScrollObserver=function(){for(var e=document.querySelector(".iz_osn_carousel_2"),t=document.querySelectorAll(".iz_osn_carousel_2 > *"),n={},i=new IntersectionObserver(function(e,t){e=e.reduce(function(e,t){return t.intersectionRatio>e.intersectionRatio?t:e});0<e.intersectionRatio&&(f.stickyBar.currentIndex=n[e.target.getAttribute("id")],f.stickyBar.currentIndex)},{root:e,threshold:.9}),o=0;o<t.length;o++)n[t[o].getAttribute("id")]=o,i.observe(t[o])},f.getScrollDirection=function(){if(d.Helper.isScreenScrollable()){var e=!1,t=window.pageYOffset||document.documentElement.scrollTop;return f.lastScrollTop<t?e=c.KeyMapper.SCROLL_DOWN:t<f.lastScrollTop&&(e=c.KeyMapper.SCROLL_UP),f.lastScrollTop=t,e}},f.lastScrollTop=0,f.osnPrefix="iz_osn_",f.defaultImage="",f.rfid=null,f.stickybarHide=!1,f.exitIntent={isDialogInitialize:!1,maxAllowedPost:5,smallPostAllowed:4,adNotificationNo:void 0,dialogBoxID:"iz-osn-exitIntent",triggerOnEventType:void 0,firstPageStateID:"osn_"+Date.now(),largePostData:void 0,smallPostData:void 0,singlePostHTML:void 0,htmlSrc:"https://cdn.izooto.com/osn/exitintentv3.html"},f.stickyBar={readyToShow:!1,currentIndex:0,isClosed:!1,isDialogInitialize:!1,maxAllowedPost:6,adNotificationNo:void 0,dialogBoxID:"iz-osn-stickyBar",singlePostHTML:void 0,htmlSrc:"https://cdn.izooto.com/osn/stickybar.html",postData:void 0},f);function f(){}t.ExitIntent=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},c=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Main=void 0;var l=n(0),p=n(1),o=n(24),r=n(22),d=n(4),a=n(9),u=n(3),s=n(11),f=n(10),g=n(25),y=n(27),m=n(23),h=n(2),b=n(15),S=n(14),v=n(16),w=n(28),C=n(29),E=n(30),P=n(5),_=n(12),T=n(7),M=n(17),O=n(6),H=n(21),D=n(8),N=n(13),I=n(26),A=n(20),n=(k.init=function(){if(void 0!==window._izooto)throw new Error("Duplicate Pixel Found !!");window._izooto={},1!=p.Config.izootoStatus?l.Helper.displayLog(p.Config.brandingPartner+" has been disabled for this site!"):(f.IndexedDB.setup(),"undefined"==typeof Promise?(window.Promise=function(){},k.initIzooto()):d.NotificationHelper.getIzCidPromise().then(function(){k.initIzooto()}))},k.initIzooto=function(){return i(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return k.referenceHolder(),k.izootoFallbackHandler(),[4,p.Config.init()];case 1:return e.sent(),v.Session.init(),window._izooto.client=p.Config.client,u.Storage.legacyStorageMigration(),a.Queue.init(),P.HttpRequest.init(),""!=p.Config.notification.masterDomain&&p.Config.notification.isSupported?S.MasterDomain.init():k.moduleInitializer(),[2]}})})},k.referenceHolder=function(){window._izooto=p.Config,window._izooto.helperClass=l.Helper,window._izooto.gdprClass=o.GDPR,window._izooto.queueClass=a.Queue,window._izooto.notificationClass=r.Notification,window._izooto.notificationHelperClass=d.NotificationHelper,window._izooto.storageClass=u.Storage,window._izooto.debuggerClass=s.Debugger,window._izooto.indexedDBClass=f.IndexedDB,window._izooto.videoDropOffClass=y.VideoDropOff,window._izooto.tabAbandonmentClass=g.TabAbandonments,window._izooto.shopifyClass=m.Shopify,window._izooto.masterDomainClass=S.MasterDomain,window._izooto.messengerClass=b.Messenger,window._izooto.sessionClass=v.Session,window._izooto.crpsPlaybookClass=w.CRPSPlaybook,window._izooto.recommendArticleClass=C.RecommendArticle,window._izooto.autoSegmentClass=E.AutoSegment,window._izooto.newsHubClass=_.NewsHub,window._izooto.channelEventHandlerClass=T.ChannelEventHandler,window._izooto.exitIntentClass=M.ExitIntent,window._izooto.gaClass=O.GoogleAnalytics,window._izooto.notificationFeedClass=H.NotificationFeed,window._izooto.cookieClass=D.CookieStorage,window._izooto.httpRequestClass=P.HttpRequest,window._izooto.adManagerClass=N.AdManager,window._izooto.adNetworkClass=I.AdNetwork,window._izooto.articleShareClass=A.ArticleShare},k.moduleInitializer=function(){return i(this,void 0,void 0,function(){return c(this,function(e){switch(e.label){case 0:return[4,k.UUIDHandler()];case 1:return e.sent(),a.Queue.sync(!1),r.Notification.init(),M.ExitIntent.init(),A.ArticleShare.init(),b.Messenger.init(),p.Config.newsHub.allVisitors&&_.NewsHub.init(),[2]}})})},k.UUIDHandler=function(){return i(this,void 0,void 0,function(){var t,n,i,o,r,a,s;return c(this,function(e){switch(e.label){case 0:return t=u.Storage.getStorage(h.KeyMapper.PUSH_TOKEN),n=d.NotificationHelper.getSubscriptionKey(t),[4,l.Helper.isUUID()];case 1:return e.sent()?(i=p.Config,[4,l.Helper.getUUID()]):[3,3];case 2:return i.UUID=e.sent(),[3,12];case 3:return n?[4,l.Helper.getUUIDFromEndpoint(t)]:[3,5];case 4:return r=e.sent(),p.Config.UUID=""==r?n:r,[3,12];case 5:return[4,d.NotificationHelper.isHttpsSitePermissionAlreadyGranted()];case 6:return e.sent()?(o="",1!=p.Config.notification.httpsNoRoot?[3,8]:(l.Helper.displayLog("No root flow..."),[4,d.NotificationHelper.httpsNoRootGetOldSubscription()])):[3,12];case 7:return o=e.sent(),[3,10];case 8:return[4,d.NotificationHelper.httpsGetOldSubscription()];case 9:o=e.sent(),e.label=10;case 10:return o?[4,l.Helper.getUUIDFromEndpoint(o)]:[3,12];case 11:""==(r=e.sent())?(a=d.NotificationHelper.getSubscriptionKey(o),p.Config.UUID=a):p.Config.UUID=r,e.label=12;case 12:return p.Config.UUID?[3,14]:(s=p.Config,[4,l.Helper.getUUID()]);case 13:s.UUID=e.sent(),e.label=14;case 14:return[4,l.Helper.setUUID()];case 15:return e.sent(),[2]}})})},k.izootoFallbackHandler=function(){window._izooto.optinCallback=function(e){r.Notification.optinCallback(e)},window._izooto.gdprCallback=function(e){o.GDPR.gdprCallback(e)},window._izooto.closeDialog=function(e){r.Notification.closeDialog(e)},window._izooto.openPopup=function(e){r.Notification.openPopup(!0)},window._izooto.closeHttpsBranding=function(){d.NotificationHelper.closeHttpsOverlay()},window._izooto.gdprAllow=function(){o.GDPR.gdprAllow()},window._izooto.gdprDisallow=function(){o.GDPR.gdprDisallow()},window._izooto.syncHookInDb=function(){return d.NotificationHelper.syncHookInDb("syncNotificationView")},window._izooto.syncHookInDb=function(){return d.NotificationHelper.syncHookInDb("syncNotificationClick")},window._izooto.getStorage=function(e){return"iztoken"==e?e=h.KeyMapper.PUSH_TOKEN:"uid"==e&&(e=h.KeyMapper.UUID),u.Storage.getStorage(e)},window._izooto.getBrowserKeyFromToken=function(e){return d.NotificationHelper.getSubscriptionKey(e)}},k);function k(){}(t.Main=n).init()},function(e,t,n){"use strict";var a=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.FeedHelper=void 0;var P=n(1),_=n(0),o=n(5),i=n(10),T=n(2),M=n(3),n=(r.prototype.setup=function(){return a(this,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return[4,this.readLastClickVisitFromDb()];case 1:return e.sent(),[4,(t=this).getAllNotificationsFromDb()];case 2:return t.notificationTempQ=e.sent(),[2,Promise.resolve(!0)]}})})},r.prototype.loadNotifications=function(i){return void 0===i&&(i=this.currentJsonFileIndex),a(this,void 0,void 0,function(){var n;return s(this,function(e){return n=this,[2,new Promise(function(t,e){n.isNewsLoading?t({data:[],status:n.status.ALREADY_IN_PROGRESS}):4<i?t({data:[],status:n.status.FAILED}):(n.isNewsLoading=!0,o.HttpRequest.get(n.cdnCampaignsSrc(i)).then(function(e){++n.currentJsonFileIndex,n.isNewsLoading=!1;e=_.Helper.parseToJSON(e);t({data:e,status:n.status.SUCCESS})}).catch(function(){t({data:[],status:n.status.FAILED})}))})]})})},r.prototype.loadSortedNotifications=function(){return a(this,void 0,void 0,function(){var i;return s(this,function(e){return i=this,[2,new Promise(function(n,e){i.loadNotifications().then(function(e){var t=e.data,e=e.status;e==i.status.SUCCESS?(i.storeSegmentIntoIdb(t),t=parseInt(t[t.length-1].p.ct),i.sortNotificationsFromIdb(t)):e==i.status.FAILED&&i.sortNotificationsFromIdb(0),n(e)})})]})})},r.prototype.getNotifications=function(r){return void 0===r&&(r=this.minimumNotificationToShow),a(this,void 0,void 0,function(){var i,o,t=this;return s(this,function(e){return i=this,o=[],[2,new Promise(function(n,e){return a(t,void 0,void 0,function(){var t;return s(this,function(e){switch(e.label){case 0:return i.canLoadMore?i.notificationShowList.length<r?[4,i.loadSortedNotifications()]:[3,2]:[3,2];case 1:if((t=e.sent())==i.status.ALREADY_IN_PROGRESS)return[2,n({data:[],status:t})];i.canLoadMore=t==i.status.SUCCESS,e.label=2;case 2:return this.notificationShowList.length<r&&i.canLoadMore?[2,n(this.getNotifications())]:(o=this.notificationShowList.splice(0,r),t=i.status.SUCCESS,t=i.ridsList.length?o.length?i.status.SUCCESS:i.status.NO_MORE_NOTIFICATIONS:i.status.NULL_NOTIFICATION_SENT,n({data:o,status:t}),[2])}})})})]})})},r.prototype.cdnCampaignsSrc=function(e){return P.Config.hashFileName?"https://nh.iz.do/nh/"+P.Config.hashFileName+"/"+e+".json":""},r.prototype.getAllNotificationsFromDb=function(){return a(this,void 0,void 0,function(){var o,r=this;return s(this,function(e){switch(e.label){case 0:return o=[],[4,i.IndexedDB.getIndexDBData("notificationLog","all").then(function(e){if(e){e.sort(function(e,t){return t.payload.ct-e.payload.ct}),e.forEach(function(e){e.key.toString().length<=15&&-1==r.cidsList.indexOf(e.payload.id)&&(o.push(e),r.ridsList.push(e.key),r.cidsList.push(e.payload.id))});for(var t=0,n=o;t<n.length;t++){var i=n[t];if(!i.payload.hasOwnProperty("vr")){r.dbLatestTimeStamp=parseInt(i.payload.ct);break}}return o}_.Helper.displayLog("Notication Log : data not found in db!")}).catch(function(e){_.Helper.displayLog(e)})];case 1:return[2,e.sent()]}})})},r.prototype.segmentParser=function(e){var t,n=["px","dev","lci","lvi"];for(t in e){if(!(-1<n.indexOf(t)))return!1;if("dev"==t){if(-1==e.dev[0].indexOf(P.Config.global.deviceType))return _.Helper.displayLog("Device segment validation failed"),!1}else{if("px"==t&&!this.isUserPropertySegmentValidated(e))return _.Helper.displayLog("User property segment validation failed"),!1;if(("lci"==t||"lvi"==t)&&!this.isDateTimeSegmentValidated(e,t))return _.Helper.displayLog("Last click segment validation failed"),!1}}return!0},r.prototype.isUserPropertySegmentValidated=function(a){var e,s={yes:!0,no:!1},c=a.px,l=this;for(e in c){var t=function(t){for(var e=c[t],n=0,i=e.values;n<i.length;n++){var o=i[n],r=o.v;if(1==e.multi)switch(o.op){case"contains":case"equals":if(r.every(function(e){return-1==M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY).indexOf(e)}))return{value:!1};break;case"does not contain":case"not contains":case"not equals":if(r.every(function(e){return-1<M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY).indexOf(e)}))return{value:!1}}else{if("datetime"==e.type)return{value:l.isDateTimeSegmentValidated(a,"px",t)};switch(r="boolean"==e.type?s[r]:r,o.op){case"equals":if(M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY)!=r)return{value:!1};break;case"not equals":if(M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY)==r)return{value:!1};break;case"greater than":if(M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY)<=r)return{value:!1};break;case"less than":if(M.Storage.getConfigLocal(t,T.KeyMapper.USER_PROPERTY)>=r)return{value:!1}}}}}(e);if("object"==typeof t)return t.value}return!0},r.prototype.isDateTimeSegmentValidated=function(e,t,n){var i,e=e[t],o="lci"==t?P.Config.store.lastClick:P.Config.store.lastView;if("px"==t)try{var r=M.Storage.getConfigLocal(n,T.KeyMapper.USER_PROPERTY);if(!r)return!1;for(var o=new Date(r).getTime(),a=[],s=null===(i=e[n])||void 0===i?void 0:i.values,c=0,l=s;c<l.length;c++){var p=l[c];a.push(p.v)}e=a}catch(e){}if(!o)return _.Helper.displayLog("Last click or visit key not found in db"),!1;for(var d=0,u=e;d<u.length;d++){var f,g=!!(f=u[d]).d1&&new Date(f.d1),y=!!f.d2&&new Date(f.d2),m=f.days||!1,h=f["min-days"]||!1,b=f["max-days"]||!1,S=(S=new Date(o)).toLocaleDateString(),v=new Date,w=new Date;switch(_.Helper.displayLog("Last Click Visit Operation: ",f.op),f.op){case"before":if(o>g.getTime())return!1;break;case"after":if(o<g.getTime())return!1;break;case"on":if(S!=g.toLocaleDateString())return!1;break;case"between":if(g.getTime()>o&&o<y.getTime())return!1;break;case"in the past":if(w.setDate(v.getDate()-m),o<w.getTime())return!1;break;case"was exactly":if(w.setDate(v.getDate()-m),S!=w.toLocaleDateString())return!1;break;case"today":if(S!=v.toLocaleDateString())return!1;break;case"relative between":var C=w.setDate(v.getDate()-h),E=w.setDate(v.getDate()-b);if(o<C&&o<E)return!1;break;default:return!1}}return!0},r.prototype.readLastClickVisitFromDb=function(){return a(this,void 0,void 0,function(){return s(this,function(e){return[2,new Promise(function(t,e){i.IndexedDB.getIndexDBData("swEvents","click").then(function(e){e?(_.Helper.displayLog("Last click found from db: ",e),P.Config.store.lastClick=1e3*e.timestamp):_.Helper.displayLog("Last click  not found ")}).catch(function(e){_.Helper.displayLog(e)}).finally(function(){i.IndexedDB.getIndexDBData("swEvents","view").then(function(e){e?(P.Config.store.lastView=1e3*e.timestamp,t(P.Config.store.lastView)):(_.Helper.displayLog("Last view not found"),t(!1))}).catch(function(e){_.Helper.displayLog(e),t(!1)})})})]})})},r.prototype.sortNotifications=function(e){var t={payload:e};if(-1<this.cidsList.indexOf(e.id))return e.r,void e.id;if(t&&e.hasOwnProperty("r")){if(16<=e.r.length)return void _.Helper.displayLog("Excluding plalybook & subid notifications");t.key=parseInt(e.r),t.clickedAt=!1,t.receivedAt=Date.now()}return-1<this.ridsList.indexOf(parseInt(e.r))?void 0:(this.ridsList.push(parseInt(e.r)),this.cidsList.push(e.id),this.notificationShowList.push(t),this.notificationShowList.sort(function(e,t){return t.payload.ct-e.payload.ct}),t)},r.prototype.setDataIntoDB=function(e){e.fetched=1,i.IndexedDB.addUpdateToTable("notificationLog",e).then(function(e){_.Helper.displayLog(e)}).catch(function(e){_.Helper.displayLog(e)})},r.prototype.setPayloadData=function(e,n){(e="number"==typeof e?[e]:e).forEach(function(t){i.IndexedDB.getIndexDBData("notificationLog",t).then(function(e){e.hasOwnProperty("clickedAt")&&!e.clickedAt&&n.hasOwnProperty("clickedAt")?(e.clickedAt=n.clickedAt,i.IndexedDB.addUpdateToTable("notificationLog",e).then(function(e){}).catch(function(e){_.Helper.displayLog("Mark as read Error "+t,e)})):_.Helper.displayLog("Notication Log : data not found in db!")}).catch(function(e){_.Helper.displayLog(e)})})},r.prototype.sortNotificationsFromIdb=function(n){var i=this;this.notificationTempQ.forEach(function(e,t){-1==i.notificationShowKeyList.indexOf(e.key)&&e.payload.ct>=n&&(i.notificationShowKeyList.push(e.key),i.notificationShowList.push(e))}),this.notificationShowList.sort(function(e,t){return t.payload.ct-e.payload.ct})},r.prototype.storeSegmentIntoIdb=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t],o=!1;1!=(o=!i.a||this.segmentParser(_.Helper.parseToJSON(i.a))?!0:o)||(i=this.sortNotifications(i.p))&&this.setDataIntoDB(i)}},r);function r(e){this.minimumNotificationToShow=e,this.status={NO_MORE_NOTIFICATIONS:"No more notifications available",ALREADY_IN_PROGRESS:"Older request already in progress",NULL_NOTIFICATION_SENT:"Null: No notifications sent",SUCCESS:"success",FAILED:"failed"},this.isNoNotification=!0,this.ridsList=[],this.cidsList=[],this.canLoadMore=!0,this.isNewsLoading=!1,this.dbLatestTimeStamp=0,this.notificationTempQ=[],this.notificationShowKeyList=[],this.currentJsonFileIndex=0,this.notificationShowList=[]}t.FeedHelper=n},function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},r=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ArticleShare=void 0;var i=n(1),a=n(0),s=n(17),c=n(2),l=n(13),p=n(7),d=n(5),n=(u.init=function(){0==i.Config.articleShare.status||i.Config.global.isFrame||3!=i.Config.global.deviceType||"/"==window.location.pathname?a.Helper.displayLog("ArticleShare is disabled for this site:"):0!=i.Config.articleShare.rid&&0!=i.Config.articleShare.cid&&(s.ExitIntent.isRepeatDelayed(c.KeyMapper.SHAREARTICLE_DELAY)||null!=navigator.share&&(u.getPageHeight(),u.registerEvent()))},u.registerEvent=function(){1<=i.Config.global.deviceType&&u.articleShareScollHandler(function(){u.initializeTemplate()})},u.articleShareScollHandler=function(t){var n;a.Helper.isScreenScrollable()&&(n=0,document.addEventListener("scroll",function(){u.onUrlChangeHandler(t);var e=window.pageYOffset||document.documentElement.scrollTop;n<e&&(""!=u.articleUrl?t():u.matchScrollPercent(t)),n=e<=0?0:e},!1))},u.getPageHeight=function(){var e=document.body,t=document.documentElement,t=Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight);u.pageHeight=t},u.matchScrollPercent=function(e){var t=document.documentElement.scrollTop,n=90*document.documentElement.clientHeight/100,t=90*(u.pageHeight-t)/100;t<=n&&e()},u.initializeOnScrollPercent=function(e){var t=document.documentElement,n=document.body,i="scrollTop",o="scrollHeight",t=(t[i]||n[i])/((t[o]||n[o])-t.clientHeight)*100;90<=Math.round(t)&&e()},u.initializeTemplate=function(){u.isDialogInitialize||(u.isDialogInitialize=!0,s.ExitIntent.getHTML(u.htmlSrc).then(function(e){a.Helper.addHTML("div",e,"iz-osn-article-share"),p.ChannelEventHandler.event("articleShare",c.KeyMapper.ARTICLESHARE_READY_SHOW)}))},u.clickHandler=function(){var e=this,t=document.querySelector(".iz_osn_share_button_3");""==u.articleUrl&&(u.articleUrl=window.location.href);var n,i={url:n=-1<u.articleUrl.indexOf("utm_source=izooto&utm_medium=onsite_interactions&utm_campaign=article_share")?u.articleUrl:u.articleUrl+"?utm_source=izooto&utm_medium=onsite_interactions&utm_campaign=article_share",title:document.title||""};t.addEventListener("click",function(){return o(e,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,navigator.share(i)];case 1:return e.sent(),u.syncArticleShareClick(n),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}})})})},u.closeHandler=function(){try{var e=document.querySelector(".iz_osn_close_3");e.addEventListener("click",function(e){a.Helper.hideElement("#iz-osn-article-share"),u.syncArticleShareDismissed(),p.ChannelEventHandler.event("articleShare",c.KeyMapper.ARTICLESHARE_CLOSED),s.ExitIntent.setRepeatPromptDelay(i.Config.articleShare.closeDelay,c.KeyMapper.SHAREARTICLE_DELAY)})}catch(e){}},u.hideArticleShareDialog=function(){a.Helper.hideElement("#iz-osn-article-share")},u.onUrlChangeHandler=function(e){try{var t=window.location.href,n=new MutationObserver(function(e){window.location.href!==t&&(u.articleUrl=t)});n.observe(document,{subtree:!0,childList:!0})}catch(e){a.Helper.displayLog("The page url is not changed")}},u.showArticleShareDialogEventHandling=function(){u.showArticleShareDialog(),p.ChannelEventHandler.event("articleShare",c.KeyMapper.ARTICLESHARE_SHOWN),u.syncArticleShareView(),s.ExitIntent.setRepeatPromptDelay(i.Config.articleShare.repeatDelay,c.KeyMapper.SHAREARTICLE_DELAY),u.clickHandler(),u.closeHandler()},u.showArticleShareDialog=function(){document.querySelector("#iz-osn-article-share").style.display="block"},u.adsHandler=function(){1!=u.adLoaded&&(u.adLoaded=!0,l.AdManager.loadShareArticleAd())},u.trackingObj=function(){return{pid:i.Config.client,bkey:i.Config.UUID,cid:i.Config.articleShare.cid,rid:i.Config.articleShare.rid,tt:3,ot:i.Config.articleShare.type}},u.syncArticleShareView=function(){var e=u.trackingObj(),t=a.Helper.getEndpoint("syncOnsiteView");d.HttpRequest.postForm(t,e,!0).then(function(){i.Config.brandingPartner}).catch(function(e){})},u.syncArticleShareClick=function(e){var t=u.trackingObj(),e=encodeURIComponent(e);t.link=e;e=a.Helper.getEndpoint("syncOnsiteClick");d.HttpRequest.postForm(e,t,!0).then(function(){i.Config.brandingPartner}).catch(function(e){})},u.syncArticleShareDismissed=function(){var e=u.trackingObj(),t=a.Helper.getEndpoint("syncOnsiteDismissed");d.HttpRequest.postForm(t,e,!0).catch(function(e){})},u.isDialogInitialize=!1,u.readyToShow=!1,u.articleUrl="",u.adLoaded=!1,u.htmlSrc="https://cdn.izooto.com/osn/articleshare/widget.html",u.pageHeight="",u);function u(){}t.ArticleShare=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationFeed=void 0;var r=n(1),a=n(19),s=n(0),n=(c.init=function(t){return i(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return r.Config.newsHub.allowFeed?(c.feedCallback=t,c.isInititated?[3,2]:(c.isInititated=!0,this.apiFeed=new a.FeedHelper(c.minimumNotifications),[4,this.apiFeed.setup()])):[2];case 1:e.sent(),e.label=2;case 2:return c.handler(),[2]}})})},c.handler=function(){return i(this,void 0,void 0,function(){var t,n,i;return o(this,function(e){switch(e.label){case 0:return[4,this.apiFeed.getNotifications()];case 1:switch(t=e.sent(),i=t.data,t=t.status){case this.apiFeed.status.NO_MORE_NOTIFICATIONS:n=1;break;case this.apiFeed.status.NULL_NOTIFICATION_SENT:n=2;break;case this.apiFeed.status.ALREADY_IN_PROGRESS:n=3}return i=this.dataParser(i),this.respondToCallback(t==this.apiFeed.status.SUCCESS,i,t,n),[2]}})})},c.respondToCallback=function(e,t,n,i){void 0===t&&(t=[]),"function"==typeof this.feedCallback&&c.feedCallback(this.getResponseFormate(e,t,n,i)),this.feedCallback=void 0},c.getResponseFormate=function(e,t,n,i){n={success:e=void 0===e?!1:e,data:t=void 0===t?[]:t,response:n};return i&&(n.errorCode=i),n},c.dataParser=function(e){var i=[];return e.forEach(function(e){var t=e.payload,n=e.receivedAt,e=s.Helper.replaceQueryParam(t.ln,"utm_source","izooto"),e=s.Helper.replaceQueryParam(e,"utm_medium","notification_feed"),n={title:t.t,message:t.m,bannerImage:t.bi||"",icon:t.i,landingUrl:e,createdAt:t.ct||n};i.push(n)}),i},c.statusText={EMPTY:"No more notifications available",SUCCESS:"Notification feed fetched successfully",FAIL:"Null: No notifications sent"},c.minimumNotifications=10,c.isInititated=!1,c);function c(){}t.NotificationFeed=n},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(n,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function o(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,o)}r((c=c.apply(e,a||[])).next())})},o=this&&this.__generator||function(n,i){var o,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,(t=a?[2&t[0],a.value]:t)[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(n,s)}catch(e){t=[6,e],r=0}finally{o=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Notification=void 0;var s=n(4),c=n(0),l=n(1),r=n(11),a=n(3),p=n(9),d=n(2),u=n(6),n=(f.init=function(){return i(this,void 0,void 0,function(){var t,n;return o(this,function(e){switch(e.label){case 0:return(l.Config.notification.eventsToSync=l.Config.notification.eventsToSync.map(function(e){return s.NotificationHelper.syncableEvents[e]}),t=l.Config.notification.windowType,0!=l.Config.izootoStatus&&l.Config.notification.isSupported)?[3,1]:(l.Config.notification.isSupported?s.NotificationHelper.sendEvent(d.KeyMapper.NOTIFICATION_DISABLED):s.NotificationHelper.sendEvent(d.KeyMapper.BROWSER_UNSUPPORTED),c.Helper.displayLog(l.Config.brandingPartner+" notification disabled!"),[2]);case 1:return[4,s.NotificationHelper.setSubscriberIdFromDb()];case 2:if(e.sent(),6==t){if(window.top!=window.self)return s.NotificationHelper.noRootHandler(),[2]}else{if(5==t)return r.Debugger.verifyIzootoIntegration(),[2];if(4==t&&self!=top)return s.NotificationHelper.sendPermissionStatusFromFrame(),[2];if(2==t&&self!=top)return s.NotificationHelper.removeSubscriptionInFrame(),[2];if(1==t)return s.NotificationHelper.nativeHandler(),[2]}if(!t){if(window.self!=window.top)return p.Queue.sync(),[2];if(""!=l.Config.notification.allowedDomain&&(n=l.Config.global.locationProtocol+"//"+document.location.hostname,l.Config.notification.allowedDomain.indexOf(n)<0&&!t))return[2];u.GoogleAnalytics.initUsingConfig()}if(l.Config.store.isNotificationDisabledManually)return c.Helper.displayLog("Notfication prompt handled by site developer!"),[2];if(3==s.NotificationHelper.getPermissionStatusFromStorage())return s.NotificationHelper.sendEvent(d.KeyMapper.ALREADY_UNSUBSCRIBED),[2];s.NotificationHelper.promptHandler(),e.label=3;case 3:return[2]}})})},f.optinCallback=function(e){try{"function"==typeof e&&(l.Config.notification.optinModule=new e,null!=l.Config.notification.optinModule.data&&(window.izOptinDesign=l.Config.notification.optinModule.data),s.NotificationHelper.showOptin())}catch(e){}},f.closeDialog=function(e){var t;try{a.Storage.removeStorage(d.KeyMapper.ACTIVE_PROMPT),e=1===e?d.KeyMapper.OPTIN_ALLOWED:d.KeyMapper.OPTIN_CLOSED,s.NotificationHelper.sendEvent(e),null!==(t=document.getElementById("izmiddle-box"))&&void 0!==t&&t.remove()}catch(e){c.Helper.displayLog("Error removing div : ",e)}},f.openPopup=function(e){var t,n,i,o,r,a;(e=void 0===e?!1:e)&&this.closeDialog(1),3!=l.Config.notification.subscriptionType?l.Config.notification.isSdkHttps&&"https:"==l.Config.global.locationProtocol?s.NotificationHelper.nativeHandler():(c.Helper.addMsgReciever(s.NotificationHelper.msgReciever),r=null!=window.screenLeft?window.screenLeft:screen.left,a=null!=window.screenTop?window.screenTop:screen.top,t=window.innerWidth||document.documentElement.clientWidth||screen.width,n=window.innerHeight||document.documentElement.clientHeight||screen.height,o=i=200,e=l.Config.notification.promptType,1!==l.Config.notification.promptType&&2!=l.Config.notification.promptType||(e=1,o=i=500),r=t/2-i/2+r,a=n/2-o/2+a,l.Config.notification.hidePopup&&0===l.Config.notification.promptType&&(o=i=100,r=a=1e4),e=l.Config.notification.sourceOrigin+"?action=prompt&izpt="+e,1!=l.Config.notification.fullPopUp||0==l.Config.notification.promptType?(window.open(e,l.Config.brandingPartner+" Subscription","scrollbars=yes, width="+i+", height="+o+", top="+a+", left="+r),s.NotificationHelper.sendEvent(d.KeyMapper.POPUP_OPEN)):window.open(e,l.Config.brandingPartner+" Subscription")):s.NotificationHelper.requestSafariPermission()},f);function f(){}t.Notification=n},function(e,t,n){"use strict";var l=this&&this.__assign||function(){return(l=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Shopify=void 0;var p=n(1),d=n(0),u=n(3),f=n(5),g=n(4),a=n(8),y=n(2),n=(m.init=function(e){window._izooto[m._izLastVariantCookieName]="";var t,n=null!=e?e:!1;if(2==p.Config.notification.isShopify)return m.shopifyCart(),void d.Helper.displayLog("Old Shopify");1==p.Config.notification.isShopify&&(d.Helper.displayLog("New Shopify"),e=5*Math.random(),(t=new XMLHttpRequest).addEventListener("load",function(e){m.shopifyCartTracker(t,n)}),t.open("GET","/cart.js?"+e),t.send()),m.resetProductCookie(),m.checkAndSendShopifyEvents(!0)},m.shopifyCartTracker=function(e,t){var n="iz_sh_cart_v2";d.Helper.displayLog(e),d.Helper.displayLog("Purge :"+t),i=d.Helper.parseToJSON(e.responseText),d.Helper.displayLog(i);i.items;var i,o=i.token,r=u.Storage.getStorage(n);null!=o&&""!=o&&((e=new Date).setTime(e.getTime()+864e5),e.toUTCString(),o==r&&!t||(i=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN),e=0,i=d.Helper.parseToJSON(i),1<Object.keys(i).length&&(e=1),d.Helper.displayLog("[Mapper hit]"),r=d.Helper.getEndpoint("ShopifyMapper"),t=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN),t=d.Helper.parseToJSON(t),t={bkey:p.Config.UUID,btype:d.Helper.getBrowserType(),dtype:d.Helper.getDeviceType(),pid:p.Config.client,shopify_token:o,pte:p.Config.notification.subscriptionType,custom_topic:"custom-js-mapper"},1==e&&(t.auth=i.keys.auth,t.pk=i.keys.p256dh),p.Config.global.browserName!=y.KeyMapper.BROWSER_SAFARI&&(t=l(l({},t),d.Helper.endPointParamExtract(u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN)))),f.HttpRequest.postForm(r,t).catch(function(e){}),a.CookieStorage.setCookie(n,o,1)))},m.shopifyFix=function(){try{var e=document.createElement("img");e.style.width="0px",e.style.height="0px",e.src=document.location.protocol+"//"+document.location.hostname+p.Config.notification.manifest}catch(e){}},m.shopifyCart=function(){var e=u.Storage.getStorage("cart");void 0!==e&&""!==e&&(e=-1!=e.indexOf("=")?e.split("=")[1]:e)!==u.Storage.getStorage("iz_sh_cart")&&"ckout="!=e&&(a.CookieStorage.setCookie("iz_sh_cart",e),window._izq.push(["event","add_to_cart",{cart_id:e}]))},m.resetProductCookie=function(){window._izooto[m._izLastVariantCookieName]="",a.CookieStorage.setCookie(m._izLastVariantCookieName,"")},m.checkIfVariantChanged=function(){var e=""==window._izooto[m._izLastVariantCookieName]?a.CookieStorage.getCookie(m._izLastVariantCookieName):window._izooto[m._izLastVariantCookieName],t=window.ShopifyAnalytics.meta.selectedVariantId;return 1!=m.sentShopifyProduct&&(void 0===t?(m.sentShopifyProduct=1,!0):t!=e&&(window._izooto[m._izLastVariantCookieName]=t,a.CookieStorage.setCookie(m._izLastVariantCookieName,t),!0))},m.listenToProductVariant=function(e){m.checkIfVariantChanged()&&e(),setTimeout(function(){m.listenToProductVariant(e)},m._izProductVariantModifiedCheckInterval)},m.getShopifyModule=function(){try{if(n=window.ShopifyAnalytics.meta.page.pageType)return n}catch(e){p.Config.debug&&console.warn("ShopifyAnalytics not available, parsing URL")}var e=location.hostname,t=location.pathname.split("/"),n=t[1],t=t[2];if(""===n)return m._izShopifyModules.storeSections.home;if(n===m._izShopifyModules.storeRoots.cart)return m._izShopifyModules.storeRoots.cart;if(n===m._izShopifyModules.storeRoots.account&&t===m._izShopifyModules.storeRoots.orders)return m._izShopifyModules.storeRoots.orders;if("account"===n&&!n)return m._izShopifyModules.storeSections.orders;if("checkout.shopify.com"===e||"checkouts"===t)return m._izShopifyModules.storeSections.checkout;if(void 0!==window.__st&&window.__st.s){t=window.__st.partZero.split("-")[0];return"collections"===t?m._izShopifyModules.storeSections.collection:"products"===t?m._izShopifyModules.storeSections.product:void 0}},m.sendShopifyProductViewEvent=function(){var e=location.pathname,s=window.ShopifyAnalytics.meta.selectedVariantId,e=e.split("/"),c=e[e.length-1],e=m._izAjaxApi.products+c;f.HttpRequest.get(e+="?izreq=product",void 0,{Accept:"application/json"}).then(function(e){try{var t=JSON.parse(e)}catch(e){d.Helper.displayLog("Could not fetch data from product API")}if("object"==typeof t&&""!=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN)){var n,i=t.product,o=i.variants,e=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN),t=d.Helper.getEndpoint("shopifyAPI")+"?p=p",r={pid:p.Config.client,btype:d.Helper.getBrowserType(),pte:p.Config.notification.subscriptionType,custom_topic:m._izShopifyTopics.productView,product_id:i.id.toString(),product_title:encodeURIComponent(i.title),product_handle:encodeURIComponent(c),product_page:encodeURIComponent(window.location.href),product_type:i.product_type},r=l(l({},r),g.NotificationHelper.getSubscriptionParameters(e));for(n in d.Helper.displayLog(i),null!=i.image&&null!=i.image.src&&(r.product_image=i.image.src),o){var a=o[n];if(a.id==s){r.product_price=a.price;break}}f.HttpRequest.postForm(t,r).catch(function(e){})}})},m.sendShopifyCollectionViewEvent=function(){var o,e=m._izShopifyModules.storeSections.collection+"s",t=location.pathname.split("/"),e=t.indexOf(e);-1==e?d.Helper.displayLog("Unable to identify collection"):(o=t[e+1],m._izEventNames.collectionAll!=o?(e=m._izAjaxApi.collections+o,f.HttpRequest.get(e+="?izreq=collections",void 0,{Accept:"application/json"}).then(function(e){var t,n,i;try{i=JSON.parse(e)}catch(e){d.Helper.displayLog("Could not fetch data from collection API")}"object"==typeof i&&""!=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN)&&(t=i.collection,n=d.Helper.getEndpoint("shopifyAPI")+"?p=p",e=u.Storage.getStorage(y.KeyMapper.PUSH_TOKEN),i={pid:p.Config.client,btype:d.Helper.getBrowserType(),pte:p.Config.notification.subscriptionType,custom_topic:m._izShopifyTopics.collectionView,collection_id:t.id.toString(),collection_handle:encodeURIComponent(o),collection_title:encodeURIComponent(t.title),collection_page:encodeURIComponent(window.location.href)},i=l(l({},i),g.NotificationHelper.getSubscriptionParameters(e)),null!=t.image&&null!=t.image.src&&(i["collection_image="]=t.image.src),f.HttpRequest.postForm(n,i).catch(function(e){}))})):d.Helper.displayLog("Ignoring collection view event for:"+m._izEventNames.collectionAll))},m.checkAndSendShopifyEvents=function(e){var t=m.getShopifyModule();switch(d.Helper.displayLog("Detected shopify module : ",t),t){case m._izShopifyModules.storeSections.collection:m.sendShopifyCollectionViewEvent();break;case m._izShopifyModules.storeSections.product:null!=e&&e?m.listenToProductVariant(m.sendShopifyProductViewEvent):m.sendShopifyProductViewEvent()}},m._izShopifyModules={storeSections:{home:"home",collection:"collection",product:"product",cart:"cart",checkout:"checkout",order:"order",orders:"orders"},storeRoots:{cart:"cart",account:"account",orders:"orders"}},m._izEventNames={productView:"product_viewed",collectionView:"collection_viewed",collectionAll:"all"},m._izAjaxApi={products:"/products/",collections:"/collections/"},m._izShopifyTopics={productView:"product/view",collectionView:"collection/view"},m._izLastVariantCookieName="iz_last_sh_variant",m._izProductVariantModifiedCheckInterval=5e3,m.sentShopifyProduct=0,m);function m(){}t.Shopify=n},function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.GDPR=void 0;var o=n(1),r=n(0),a=n(4),s=n(5),c=n(3),l=n(9),p=n(2),n=(d.init=function(){try{null!=o.Config.notification.gdprPrompt&&self==top&&(o.Config.notification.gdprPrompt.title=null!=o.Config.notification.gdprPrompt.title&&""!=o.Config.notification.gdprPrompt.title?o.Config.notification.gdprPrompt.title:"In order to send relevant and personalized notifications to you, we would like to capture your location and website activity.",o.Config.notification.gdprPrompt.btn2Txt=null!=o.Config.notification.gdprPrompt.btn2Txt&&""!=o.Config.notification.gdprPrompt.btn2Txt?o.Config.notification.gdprPrompt.btn2Txt:"Agree",o.Config.notification.gdprPrompt.btn1Txt=null!=o.Config.notification.gdprPrompt.btn1Txt&&""!=o.Config.notification.gdprPrompt.btn1Txt?o.Config.notification.gdprPrompt.btn1Txt:"Not Now")}catch(e){}var e=c.Storage.getConfigLocal(p.KeyMapper.GDPR_CONSENT);1!=e&&3!=e?2!=e?1==o.Config.notification.gdprPromptStatus&&d.getGdprLocation():o.Config.notification.isGdprAllowed=0:o.Config.notification.isGdprAllowed=1},d.closeGdprDialog=function(e){var t;try{null!==(t=document.getElementById("izgdpr-box"))&&void 0!==t&&t.remove()}catch(e){}},d.gdprAllow=function(){d.closeGdprDialog(),c.Storage.setConfigLocal(p.KeyMapper.GDPR_CONSENT,1),o.Config.notification.isGdprAllowed=1,l.Queue.sync(),d.sendGdprStatus(1)},d.sendGdprStatus=function(t){try{var n=r.Helper.getEndpoint("gdprStatusUrl");r.Helper.getFlagBasedParameter({subscriptionMeta:!0,subcription:!0}).then(function(e){e=i({gs:t},e);s.HttpRequest.postForm(n,e,!0).then(function(){}).catch(function(e){})})}catch(e){}},d.getGdprLocation=function(){s.HttpRequest.get(r.Helper.getEndpoint("gdprLocationUrl")).then(function(e){1==(e=r.Helper.parseToJSON(e)).status?d.loadGdprOptin():c.Storage.setConfigLocal(p.KeyMapper.GDPR_CONSENT,3)}).catch(function(){})},d.loadGdprOptin=function(){var e=o.Config.notification.gdprPromptType,e=o.Config.notification.optInSrc+"gdpr/"+e+".js";r.Helper.addExternalJS(e)},d.gdprCallback=function(e){try{"function"==typeof e&&(o.Config.notification.gdprModule=new e,null!=o.Config.notification.gdprModule.data&&(window.izGdprDesign=o.Config.notification.gdprModule.data),d.show())}catch(e){}},d.show=function(){null!=window.izGdprDesign&&(o.Config.notification.gdprDialogDesign=window.izGdprDesign),o.Config.notification.gdprDialogDesign=a.NotificationHelper.loadDesign(o.Config.notification.gdprPrompt,o.Config.notification.gdprDialogDesign),r.Helper.addHTML("div",o.Config.notification.gdprDialogDesign,"izgdpr-box")},d.gdprDisallow=function(){d.closeGdprDialog(),c.Storage.setConfigLocal(p.KeyMapper.GDPR_CONSENT,2),d.sendGdprStatus(2)},d);function d(){}t.GDPR=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TabAbandonments=void 0;var o=n(4),a=n(0),r=n(1),s=n(3),c=n(2),n=(l.init=function(){l.timerInstance=0,l.focused=!0,1==r.Config.tabAbandonment.status&&(l.interval=setInterval(function(){document.hasFocus()?l.focused||l.onFocus():l.focused&&l.onBlur()},1e3))},l.run=function(){l.reset(),a.Helper.displayLog("Tab Abandonment : Initialized");var e={url:window.location.href};s.Storage.setConfigLocal(c.KeyMapper.TAB_ABANDONMENT,JSON.stringify(e))},l.onBlur=function(){l.focused=!1,l.run(),l.timerInstance=setInterval(function(){var t=s.Storage.getConfigLocal(c.KeyMapper.TAB_ABANDONMENT);r.Config.tabAbandonment.counter++;try{t=JSON.parse(t)}catch(e){t={}}a.Helper.displayLog("TabAbandonment counter : ",r.Config.tabAbandonment.counter),t.url!=window.location.href?l.reset():r.Config.tabAbandonment.counter==r.Config.tabAbandonment.timeout&&(l.pushNotification(),l.reset())},1e3),a.Helper.displayLog("Ta : blurred")},l.onFocus=function(){l.focused=!0,l.reset(),a.Helper.displayLog("Ta : focused")},l.reset=function(){a.Helper.displayLog("Tab Abandonment : timer reset"),r.Config.tabAbandonment.counter=0,clearInterval(l.timerInstance)},l.pushNotification=function(){var e,t,n=r.Config.tabAbandonment.pushTimeout,i=l.getPayload();""!=i.id&&""!=i.rid&&(e=s.Storage.getConfigLocal(c.KeyMapper.TAB_ABANDONMENT_PUSH,c.KeyMapper.SYNC),t=a.Helper.getTimeDiff(e,!0),""!=e&&t<n?l.reset():(1==r.Config.notification.httpsNoRoot?(n=document.getElementById("izSubFrame"),a.Helper.postMessage(n,"sendLocalNotification",i)):o.NotificationHelper.sendLocalNotification(i),s.Storage.updateLastSync(c.KeyMapper.TAB_ABANDONMENT_PUSH),o.NotificationHelper.syncNotificationView(i),o.NotificationHelper.syncNotificationSent(i)))},l.getPayload=function(){var e={};e.key=r.Config.client,e.title="You were reading <~[@article_title]~>",e.message="Pick up where you left off",e.icon="https://cdnimg.izooto.com/icons/4/JD-12-128.png",e.banner="<~[@featured_image]~>",e.link="<~[@last_visited_url]~>",e.tag="tabAbandonment",e.reqInt=!0,e.id="",e.rid="",e.viewFlag=1,e.clickFlag=1,e.sysEvents=0,e.domainNum=0;var t=window.location.href;t.indexOf("utm_campaign=")<0&&(e.link+=t.includes("?")?"&":"?",e.link+="utm_source=izooto&utm_medium=push_notifications&utm_campaign=recover_abandoned_tab&utm_term=notification1");var n,i=r.Config.tabAbandonment.data;for(n in e)i.hasOwnProperty(n)||(i[n]=e[n]);return i=l.getFilterData(i)},l.urlUtmHandler=function(e,t){var n,i,o=t.split("&"),r={};for(n in o){var a=o[n].split("=");r[a[0]]=a[1]}for(i in e=new URL(e),r)e.searchParams.set(i,r[i]);return e.href},l.getFilterData=function(e){var t,n,i,o={},r=window.location.href;for(t in o.article_title=""!=a.Helper.getMetaValue("og:title")?a.Helper.getMetaValue("og:title"):a.Helper.getMetaValue("title"),o.featured_image=a.Helper.getMetaValue("og:image"),o.last_visited_url=r,e)"string"==typeof e[t]&&0<=e[t].indexOf("<~[@")&&(n=e[t].indexOf("<~[@"),i=e[t].indexOf("]~>"),"last_visited_url"==(n=e[t].substring(n+4,i))&&0<e[t].indexOf("utm_campaign")?(i=e[t].split("?"),e[t]=i[0],i=i[1],e[t]=e[t].replace("<~[@"+n+"]~>",o[n]),e[t]=l.urlUtmHandler(r,i)):e[t]=e[t].replace("<~[@"+n+"]~>",o[n]));return e},l);function l(){}t.TabAbandonments=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdNetwork=void 0;var p=n(3),d=n(1),u=n(0),n=(f.getAdNetworkParam=function(e){void 0===e&&(e=!1),f.forceSyncAdNetwork=0;var t="",n=p.Storage.getStorage("_ga"),i=p.Storage.getStorage("taboola global:user-id"),o=p.Storage.getStorage("OB-USER-TOKEN"),r=p.Storage.getStorage("mgMuidn"),a=p.Storage.getConfigLocal("gac"),s=p.Storage.getConfigLocal("tbc"),c=p.Storage.getConfigLocal("obc"),l=p.Storage.getConfigLocal("mgc");return i&&(f.adNetworkObj.tbc=i),o&&(f.adNetworkObj.obc=o),r&&(f.adNetworkObj.mgc=r),n&&1==d.Config.ga.syncCid&&(f.adNetworkObj.gac=n),(f.adNetworkObj.gac&&a!=n||i&&s!=i||o&&c!=o||r&&l!=r)&&(f.forceSyncAdNetwork=1),e?f.adNetworkObj:(0<Object.keys(f.adNetworkObj).length&&(t+="&"+u.Helper.objToParam(f.adNetworkObj)),t)},f.forceSyncAdNetwork=0,f.adNetworkObj={},f);function f(){}t.AdNetwork=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VideoDropOff=void 0;var i=n(1),o=n(0),n=(r.init=function(){i.Config.videoDropoff.status&&r.isCurrentUrlMatchingWith(i.Config.videoDropoff.allowedUrls)&&r.detectPlayer()},r.syncTrigger=function(e,t){window._izq.push(["trigger",e,t])},r.sendToApi=function(e){var t=0,n=r.playerState;if(0==n.length)n.push(e);else{for(var i=0;i<n.length;i++)if(n[i].playerId==e.playerId){if(n[i].status==e.status)return;n[i]=e,t=1;break}t||n.push(e)}var o={player_id:e.playerId,title:e.title,url:e.url,player:e.player_type,duration:e.duration.toString()};e.hasOwnProperty("thumbnail")&&(o.thumbnail=e.thumbnail);try{"started"==e.status?r.syncTrigger("video_started",o):"ended"==e.status&&r.syncTrigger("video_completed",{playerid:e.playerId})}catch(e){}},r.html5Payload=function(e,t){var n=[];n.status=e=void 0===e?"started":e,n.playerId=t.id,n.title=document.title,n.url=location.href,n.player_type="html5",n.duration=t.duration,r.sendToApi(n)},r.html5Handler=function(){var e=document.querySelectorAll("video");e&&e.forEach(function(e){var t;e.id||(t=r.generateRandomString("iz-video-",7),e.setAttribute("id",t)),e.addEventListener("playing",function(){r.html5Payload("started",e)}),e.addEventListener("ended",function(){r.html5Payload("ended",e)})})},r.ytPayload=function(e,t){var n=[];n.status=e=void 0===e?"started":e,n.playerId=t.getIframe().id,n.title=t.playerInfo.videoData.title||document.title;e="https://img.youtube.com/vi/"+t.playerInfo.videoData.video_id+"/0.jpg";n.thumbnail=e,n.url=location.href,n.player_type="youtube",n.duration=t.playerInfo.duration,r.sendToApi(n)},r.isValidYtUrl=function(e){return new RegExp("^https://(?:www.)?youtube.com/embed/[A-z0-9]+").test(e)},r.initYtPlayer=function(e){if(window.YT,0,window.YT.get(e)){var t=window.YT.get(e);return t.addEventListener("onStateChange",r.onYtPlayerStateChange),t}return new window.YT.Player(e,{events:{onStateChange:r.onYtPlayerStateChange}})},r.onYtPlayerStateChange=function(e){switch(e.data){case window.YT.PlayerState.PLAYING:var t="started";r.ytPayload(t,e.target);break;case window.YT.PlayerState.ENDED:t="ended";r.ytPayload(t,e.target)}},r.fixPlayerReference=function(i){setInterval(function(){for(var e=0;e<i.length;e++){var t=i[e].getIframe(),n=r.getClosureKeyName(i[e]);i[e][n]!==window.YT.get(t.id)[n]&&(i[e]=window.YT.get(t.id),i[e].addEventListener("onStateChange",r.onYtPlayerStateChange))}},1e3)},r.fixYtEnableJsApi=function(e){var t=new URL(e.src);""==o.Helper.getParamFromUrl(e.src,"enablejsapi")?(t.searchParams.set("enablejsapi","1"),e.setAttribute("src",t)):null==o.Helper.getParamFromUrl(e.src,"enablejsapi")&&(t.searchParams.append("enablejsapi","1"),e.setAttribute("src",t))},r.fixYtOrigin=function(e){var t=new URL(e.src);""==o.Helper.getParamFromUrl(e.src,"origin")?(t.searchParams.set("origin",window.location.origin),e.setAttribute("src",t)):null==o.Helper.getParamFromUrl(e.src,"origin")&&(t.searchParams.append("origin",window.location.origin),e.setAttribute("src",t))},r.isJsApiEnabled=function(e){return null!=o.Helper.getParamFromUrl(e,"enablejsapi")},r.addYTApiScirptPromise=function(){return new Promise(function(e,t){var n,i,o=setInterval(function(){"object"==typeof window.YT&&"function"==typeof window.YT.get&&(clearInterval(o),e(!0))},1e3);void 0!==window.YT?e(!0):((n=document.createElement("script")).src="//www.youtube.com/player_api",(i=document.getElementsByTagName("script")[0]).parentNode.insertBefore(n,i))}).catch(function(e){})},r.ytHandler=function(){setInterval(function(){for(var e,t,i=document.querySelectorAll("iframe[src*='https://www.youtube.com/embed/']"),n=0;n<i.length;n++)r.isValidYtUrl(i[n].src)&&(i[n].hasAttribute("izplayer")||(i[n].setAttribute("izplayer","1"),i[n].id||(e=r.generateRandomString("iz-video-",7),i[n].setAttribute("id",e)),r.fixYtOrigin(i[n]),r.isJsApiEnabled(i[n].src)?function(t){var n=setInterval(function(){try{var e=window.YT.get(i[t].id);e&&(clearInterval(n),e.addEventListener("onStateChange",r.onYtPlayerStateChange),r.ytPlayerReference.push(e))}catch(e){}},1e3)}(n):(t=i[n],r.fixYtEnableJsApi(t),r.addYTApiScirptPromise().then(function(){var e=r.initYtPlayer(t.id);r.ytPlayerReference.push(e)}))));r.fixPlayerReference(r.ytPlayerReference)},1e3)},r.detectPlayer=function(){"complete"==document.readyState?r.html5Handler():window.addEventListener("load",function(){r.html5Handler()}),r.ytHandler()},r.isCurrentUrlMatchingWith=function(e){if(0==e.length)return 1;for(var t=0;t<e.length;t++)if(-1!=document.location.href.search(e[t]))return e[t],1;return 0},r.ytPlayerReference=[],r.playerState=[],r.generateRandomString=function(e,t){return void 0===t&&(t=7),(e=void 0===e?"":e)+Math.random().toString(36).substring(t)},r.getClosureKeyName=function(e){try{for(var t in e)if(-1!=t.search("closure_"))return t.toString()}catch(e){throw new Error("Please update keyName of player")}},r);function r(){}t.VideoDropOff=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CRPSPlaybook=void 0;var i=n(1),o=n(0),r=n(16),a=n(3),s=n(2),c=n(4),n=(l.init=function(){i.Config.CRPSPlaybook.isPaidSubscriber,i.Config.CRPSPlaybook.status&&l.isSyncAllowed()&&l.sendNotification()},l.isSyncAllowed=function(){if(3<r.Session.getSessionCount()&&!i.Config.notification.windowType&&!i.Config.CRPSPlaybook.isPaidSubscriber){var e=a.Storage.getConfigLocal(s.KeyMapper.CRPS_PLAYBOOK,s.KeyMapper.SYNC);return e&&o.Helper.getDateDiffrenceFromPresent(e)<=l.reSendNotificationDays?(o.Helper.displayLog("Abort! Reader to paid subscriber last sync not expired!"),!1):!0}return!1},l.sendNotification=function(){var e=i.Config.CRPSPlaybook.data;e.viewFlag=1,e.clickFlag=1,e.sysEvents=0,e.domainNum=0,e.title&&e.message&&e.link&&e.rid&&e.key&&e.id?c.NotificationHelper.sendLocalNotification(e).then(function(){a.Storage.updateLastSync(s.KeyMapper.CRPS_PLAYBOOK),c.NotificationHelper.syncNotificationView(e),c.NotificationHelper.syncNotificationSent(e)}):o.Helper.displayLog("CRPS Playbook : "+s.KeyMapper.INVALID_PAYLOAD)},l.reSendNotificationDays=30,l);function l(){}t.CRPSPlaybook=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RecommendArticle=void 0;var i=n(3),o=n(2),r=n(1),a=n(0),n=(s.init=function(){r.Config.recommendArticle.status&&"/"!=s.currentArticlePath&&s.isSyncAllowed()&&s.sync()},s.isSyncAllowed=function(){var e=new Date,t=i.Storage.getConfigLocal(o.KeyMapper.LAST_SYNC_OF_RECOMMEND_ARTICLE,o.KeyMapper.SYNC);if(!t)return!0;var n=new Date(t);if(e.getDate()!=n.getDate())return i.Storage.removeConfigLocal(o.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,o.KeyMapper.RECOMMEND_ARTICLE),!0;if(e.getTime()<e.setTime(t+1e3*s.recommendArticleExpire))return!1;t=i.Storage.getConfigLocal(o.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,o.KeyMapper.RECOMMEND_ARTICLE);return(t=a.Helper.parseToJSON(t)||[]).length<s.dailyArticleSyncLimit&&-1==t.indexOf(s.currentArticlePath)},s.sync=function(){var n=i.Storage.getConfigLocal(o.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,o.KeyMapper.RECOMMEND_ARTICLE);(n=a.Helper.parseToJSON(n)||[]).push(s.currentArticlePath);var e=[window.location.protocol,"//",window.location.host,window.location.pathname].join("");window._izq.push(["trigger",s.triggerName,{article_url:e},function(e,t){200==t&&(i.Storage.setConfigLocal(o.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,JSON.stringify(n),o.KeyMapper.RECOMMEND_ARTICLE),i.Storage.updateLastSync(o.KeyMapper.LAST_SYNC_OF_RECOMMEND_ARTICLE))}])},s.currentArticlePath=window.document.location.pathname,s.dailyArticleSyncLimit=2,s.triggerName="_article_read",s.recommendArticleExpire=7200,s);function s(){}t.RecommendArticle=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AutoSegment=void 0;var i=n(1),o=n(0),n=(r.init=function(){1==i.Config.autoSegmentStatus&&r.addCustomModuleConfig()},r.addCustomModuleConfig=function(){var e=i.Config.hashFileName;e?o.Helper.addExternalJS("https://cdn.izooto.com/scripts/custom/"+e+".js","izCustomModule",!0).then(r.customModuleHandler).catch(function(e){o.Helper.displayLog("Failed to add custom module script")}):o.Helper.displayLog(i.Config.brandingPartner+" hash file name not found!")},r.customModuleHandler=function(){try{var e=window._izootoCustomeModuleConfig||void 0;if(e){if(e.hasOwnProperty("autoSegmentMethod")&&1==i.Config.autoSegmentStatus)try{window._izootoCustomeModuleConfig.autoSegmentMethod=o.Helper.getParsedMethod(e.autoSegmentMethod),r.autoSegmentHandler(e.autoSegmentMethod)}catch(e){}}else o.Helper.displayLog("No any custom module found!")}catch(e){}},r.autoSegmentHandler=function(e){var t,n;"function"==typeof e&&(t=[],"string"==typeof(e=e())&&""!=e?t.push(e):t=e,Array.isArray(t)&&t.length?(n={},t.forEach(function(e){n[e]=!0}),window._izq.push(["userProfile",{add:n}])):o.Helper.displayLog("No segment found to sync!"))},r);function r(){}t.AutoSegment=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorage=void 0;var i=(o.isLocalStorageSupport=function(){return"localStorage"in window&&null!==window.localStorage},o.setLocalStorage=function(e,t){localStorage.setItem(e,t)},o.getLocalStorage=function(e){return localStorage.getItem(e)},o.removeLocalStorage=function(e){e&&localStorage.removeItem(e)},o);function o(){}t.LocalStorage=i}]);